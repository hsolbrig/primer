<!DOCTYPE html>
<html>
  <head>
    <title>Shape Expressions (ShEx) Primer</title>
    <meta charset='utf-8'></meta>
    <!-- <script src='https://www.w3.org/Tools/respec/respec-w3c-common' -->
    <!--         async="async" class='remove'></script> -->
    <script src='respec-w3c-common.js' async class='remove'></script>
    <link rel="stylesheet" href="local.css"/>

    <script class='remove'>
      var respecConfig = {
      specStatus: "base",
      shortName:  "shex-primer",
      edDraftURI: "https://w3c.github.io/data-shapes/primer/",
      editors: [
      {   name:       "Eric Prud′hommeaux",
      url:        "http://www.w3.org/People/Eric/",
      company:    "W3C/MIT",
      companyURL: "http://www.w3.org/" }
      ],
      // wg:           "Shape Expressions ",
      // wgURI:        "https://shex.io/",
      // wgPublicList: "public-shex-dev",
      // wgPatentURI:  "http://www.w3.org/2004/01/pp-impl/424242/status",
      };
    </script>
    <script src="jquery.min.js" type= "text/javascript"></script>
    <script type="text/javascript"><!--
function prepareHighlight (highlightables, onClass, offClass, slide) {
  if (slide === undefined)
    slide = $("body .namespace").last();
  $.each( highlightables, function( index, value ){
    var elts = slide.find( "."+value );
    elts
    .mouseenter(function() {
        elts.removeClass(offClass).addClass(onClass);
    })
    .mouseleave(function() {
        elts.removeClass(onClass).addClass(offClass);
    })
    .addClass(offClass);
  })
}
--> </script>
  </head>
  <body>

    <section id="abstract">
      <p>
        The Shape Expressions (ShEx) language describes RDF graph structures.
        A <code>shape</code> describes the triples touching nodes in RDF graphs.
        These descriptions identify predicates and their associated cardinalities and datatypes.
        ShEx shapes can be used to communicate data structures associated with some process or interface, generate or validate data, or drive user interfaces.
      </p>
      <p>
        This document introduces ShEx to people familiar with basic concepts of RDF and SPARQL.
        This primer develops examples from an issue tracking application to introduce all major features of ShEx, including the construction of shapes and their correspondence with RDF graphs.
        This primer is a companion to the <a href="../spec/">language specification</a> that serves as a language reference and full specification.
      </p>    
    </section>
    
    <section id="quickStart">
      <h2>Quick Start</h2>
      <p>
        This chapter provides a quick introduction to Shape Expressions.
        It can be viewed as a separate document or included in a primer which introduces ShEx features in more depth: <button id="standalone" disabled="disabled">view Quick Start as separate document</button>.
      </p>
      <script type="text/javascript">
        var text_standAlone = "view Quick Start as separate document";
        var text_integrated = "view Quick Start integrated into the primer";
        var standingAlone = false;
        $("#standalone").removeAttr("disabled").on("click", standAlone).text(text_standAlone);
        function standAlone (evt) {
          if (standingAlone) {
            $(evt.target).closest("section").nextAll().show();
            $("#standalone").text(text_standAlone);
            standingAlone = false;
          } else {
            $(evt.target).closest("section").nextAll().hide();
            $("#standalone").text(text_integrated);
            standingAlone = true;
          }
        }
      </script>
      <div class="namespace">
        <p>
          ShEx is a language for declaring schemas where a schema describes a set of acceptable data.
          (Note that this is different from RDFS Schemas[[!rdf-schema]] as RDFS Schemas are used to infer relationships between RDF resources.)
          While the data may exist in many forms, an RDF file, a database accessible by some graph API, a SPARQL endpoint, or the possible input and output of some service.
          In the interest of simplicity, will we focus on the process of validating some actual "instance data".
          We use the word "constraint" to refer to the rules in the schema which allow one to test if some instance data is acceptable.
        </p>
        <p>
          ShEx schemas are composed of <code>NodeConstraints</code> which constrains individual RDF nodes:
        </p>
        <div class="example wrapper">
          <pre class="schema shexc"><span class="shape-name">ex:ShoeSize</span> xsd:integer MinValue 3 MaxValue 20</pre>
        </div>
        <p>
          and <code>TripleConstraints</code> which constrain the triples that have a given node as a subject or object:
        </p>
        <div class="example wrapper">
          <pre class="schema shexc" id="BioParent2Dot">
<span class="keyword">PREFIX</span> <span class="type">ex:</span> <span class="function-name">&lt;http://ex.example/#&gt;</span>

<span class="shape-name">ex:Human</span> {
  <span class="predicate">ex:hasBiologicalParent</span> <span class="keyword">.</span> {2}
}</pre>
        </div>
        <p>
          The above TripleConstraint specifies that, in order for a node to match <code>ex:Human</code>, it must have exactly two <span class="predicate">ex:hasBiologicalParent</span> properties.
          The "<span class="keyword">.</span>" indicates that the value of these properties is not constrained.
          For example, both <span class="function-name">inst:User1</span> and <span class="function-name">inst:User2</span> in the following data would be accepted:
        </p>
        <div id="quickstart-example-1" class="example wrapper">

          <!-- JSON example -->
          <div style="float:left;">
          <pre class="instance turtle"><span class="comment"># passing data — <a class="tryit" href="#BioParent2Dot" data-shape-map="inst:User1@ex:Human,inst:User2@ex:Human,inst:User3@ex:Human">try it</a></span>
<span class="keyword">PREFIX</span> <span class="type">ex:</span> <span class="function-name">&lt;http://ex.example/#&gt;</span>
<span class="keyword">PREFIX</span> <span class="type">inst:</span> <span class="function-name">&lt;http://example.com/users/&gt;</span>

<span class="function-name">inst:User1</span> <span class="type">ex:</span><span class="constant">hasBiologicalParent</span> [ <span class="type">ex:</span><span class="constant">name</span> <span class="string">"Alice"</span> ],  <span class="function-name">inst:Person3</span> .
<span class="function-name">inst:Person3</span> <span class="type">ex:</span><span class="constant">name</span> <span class="string">"Bob"</span> .
<span class="function-name">inst:User2</span> <span class="type">ex:</span><span class="constant">hasBiologicalParent</span> <span class="string">7</span>, <span class="string">"Bob"</span> .
<span class="function-name">inst:User3</span> <span class="type">ex:</span><span class="constant">hasBiologicalParent</span> [], [] .</pre>
          </div>
          <div style="clear:both;"></div>
          <p>
            While this shape is quite lax about the object of the <span class="type">ex:</span><span class="constant">hasBiologicalParent</span> arc, it does require that there be exactly two:
          </p>
          <pre class="instance turtle fail"><span class="comment"># failing data — <a class="tryit" href="#BioParent2Dot" data-shape-map="inst:User4@ex:Human,inst:User5@ex:Human,inst:User6@ex:Human">try it</a></span>
<span class="keyword">PREFIX</span> <span class="type">ex:</span> <span class="function-name">&lt;http://ex.example/#&gt;</span>
<span class="keyword">PREFIX</span> <span class="type">inst:</span> <span class="function-name">&lt;http://example.com/users/&gt;</span>

<span class="function-name">inst:User4</span> <span class="type">ex:</span><span class="constant">hasBiologicalParent</span> <span class="function-name">inst:Person3</span>,  <span class="function-name">inst:Person3</span> .
<span class="function-name">inst:Person3</span> <span class="type">ex:</span><span class="constant">name</span> <span class="string">"Bob"</span> .
<span class="function-name">inst:User5</span> <span class="type">ex:</span><span class="constant">hasBiologicalParent</span> [].
<span class="function-name">inst:User6</span> <span class="type">ex:</span><span class="constant">hasAdministrativeParent</span> [], [] .</pre>
        </div>

        <div id="quickstart-example-1" class="example wrapper">
          <p>
            Frequently, TripleConstraints do constrain the value of a property, as in this shape which says that a human must also have a hasShoeSize property with a sensible value for shoeSize:
          </p>
        <div id="simple-expressions-example-1" class="example wrapper">
          <!-- ShExC example -->
          <pre class="schema shexc" id="ShoeSize1" style="float:left;"><span class="comment"># schema (ShExC)</span>
PREFIX ex: &lt;http://ex.example/#&gt;
PREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;

ex:Human {
  ex:hasShoeSize @ex:ShoeSize
}

ex:ShoeSize xsd:integer MinInclusive 3 MaxInclusive 13</pre>
          <div class="verticalDivider"><!-- acts as a divider --></div>
          <div style="float:left;">
            <pre class="instance turtle"><span class="comment"># passing data — <a class="tryit" href="#ShoeSize1" data-shape-map="inst:Alice@ex:Human,inst:Bob@ex:Human">try it</a></span>
PREFIX ex: &lt;http://ex.example/#&gt;
PREFIX inst: &lt;http://example.com/users/&gt;

inst:Alice ex:hasShoeSize 8 .
inst:Bob ex:hasShoeSize 13 .
</pre>
            <pre class="instance turtle fail"><span class="comment"># failing data — <a class="tryit" href="#ShoeSize1" data-shape-map="inst:Claire@ex:Human,inst:Don@ex:Human">try it</a></span>
PREFIX ex: &lt;http://ex.example/#&gt;
PREFIX inst: &lt;http://example.com/users/&gt;

inst:Claire ex:shoeSize 9 .
inst:Don ex:hasShoeSize 14 .
</pre>
          </div>
          <div style="clear:both;"></div>
          </div>
        </div>
      </div>
    </section>
    <script type="text/javascript">
      <!--
        setTimeout(tryitURLs, 2000);
        function tryitURLs () {
          $(".tryit").map((idx, elt) => {
            var e = $(elt);
            e.attr("href", "http://rawgit.com/shexSpec/shex.js/master/doc/shex-simple.html?" + [
              "interface=simple",
              "schema=" + encodeURIComponent($(e.attr("href")).text().replace(/^#.*?\n/, "")),
              "data=" + encodeURIComponent($(elt).parent().parent().text().replace(/^#.*?\n/, "")),
              "shape-map=" + encodeURIComponent(e.attr("data-shape-map"))
            ].join("&"));console.log("X");
          })
        }
      -->
    </script>

      <section id="validation-results">
        <h2>Validation Results</h2>
        <p>
          While ShEx implementations may provide further information, the minimum validation result includes the results of validating any node/shape pair.
          In the <a href="#simple-expressions-example-1">previous example</a>, we validate four nodes <span class="function-name">inst:Alice</span>, <span class="function-name">inst:Bob</span>, <span class="function-name">inst:Claire</span> and <span class="function-name">inst:Don</span> against a single <a href="#BioParent2Dot" class="shape-name">ex:Human</a> shape:

        </p>
        <table class="example results">
          <tbody><tr><th class="schema">shape</th><th class="data">node</th><th>result</th><th>reason</th></tr>
          <tr class="pass"><td>&lt;ex:Human&gt;</td><td>&lt;Alice&gt;</td><td>pass</td><td class="noreason"></td></tr>
          <tr class="pass"><td>&lt;ex:Human&gt;</td><td>&lt;Bob&gt;</td><td>pass</td><td class="noreason"></td></tr>
          <tr class="fail"><td>&lt;ex:Human&gt;</td><td>&lt;Claire&gt;</td><td>fail</td><td class="fail">No <code>ex:hasShoeSize</code> supplied.</td></tr>
          <tr class="fail"><td>&lt;ex:Human&gt;</td><td>&lt;Don&gt;</td><td>fail</td><td class="fail"><code>ex:hasShoeSize</code> 14 greater than 13.</td></tr>
        </tbody></table>
      </section>

      <section id="vocabulary">
        <h2>Glossary of Validation Terms</h2>

        <p>
          The <a href="#quickstart">Quick Start</a> gave us an idea of what Shape Expressions look like.
          Now we introduce some terms to identify the pieces of ShEx and the process of validating a document.
        </p>

        <p>
          In the examples in the <a href="#simple-expressions-example-1">last example</a>, we tested the nodes <span class="function-name">inst:Alice</span>, <span class="function-name">inst:Bob</span>, <span class="function-name">inst:Claire</span> and <span class="function-name">inst:Don</span> against a simple <a href="#BioParent2Dot" class="shape-name">ex:Human</a> shape.
          We treated each one in turn as the <code>focus node</code> and tested the triples involving that node against the <code>triple constraint</code> in the shape.
          This triple constraint had a single <code>node constraint</code>; a <code>literal datatype</code> constraint asserting that the object of a matching triple was of type <code class="string">xsd:string</code>.
        </p>
        <p>
          When a node constraint is used to in a triple constraint, it as called a <code>value constraint</code> as it constrains the allowable values for triples matching the triple constraint.
          Node constraints can also be tested directly against the focus node:
        </p>
        <pre class="schema shexc">&lt;TelephoneNumer&gt; /\+[0-9]{1,3}\.[0-9]+[.0-9]*/</pre>
        <p>
          or used in conjunction with a shape:
        </p>
        <pre class="schema shexc">&lt;UserShape&gt; /^http:/ { foaf:name LITERAL }</pre>
        <p>
          Node constraints can include combinations of the following constraints:
        </p>
        <ul class="compact">
          <li id="vocab-literal-datatype"><code>literal datatype</code>: identifies the datatype of an RDF literal, e.g.
          <pre class="schema shexc shh">my:UserShape {
  foaf:name <span class="value-constraint new">xsd:string</span>
}</pre>
          <pre class="schema json shh">{ "my:UserShape": { "type": "Shape",
  "expression": {
    "type": "TripleConstraint", "predicate": "foaf:name",
    "value": { "type": "NodeConstraint", <span class="value-constraint new">"datatype": "xsd:string"</span> } } } }</pre>

          </li>
          <li id="vocab-literal-facetsw"><code>literal facets</code>: applies <a href="http://www.w3.org/TR/xmlschema-2/#rf-facets">XML Schema constraining facets</a>, e.g.
          <pre class="schema shexc shh">my:UserShape {
  ex:shoeSize xsd:float <span class="value-constraint new">MinInclusive 5.5 maxInclusive 12.5</span>
}</pre>
          <pre class="schema json shh">{ "my:UserShape": { "type": "Shape",
  "expression": { "type": "TripleConstraint", "predicate": "ex:shoeSize",
    "value": { "type": "NodeConstraint", "datatype": "http://www.w3.org/2001/XMLSchema#float",
               <span class="value-constraint new">"mininclusive": 5.5, "maxinclusive": 12.5</span> } } } }</pre>

          <p>
            These <code>numeric facets</code> apply only to numeric RDF literals: <code class="value-constraint">MinInclusive</code>, <code class="value-constraint">MinExclusive</code>, <code class="value-constraint">MaxInclusive</code>, <code class="value-constraint">MaxExclusive</code>, <code class="value-constraint">TotalDigits</code>, <code class="value-constraint">FractionDigits</code>.
            These <code>string facets</code> apply only to all RDF literals: <code class="value-constraint">Length</code>, <code class="value-constraint">MinLength</code>, <code class="value-constraint">MaxLength</code>, <code class="value-constraint">Pattern</code>.
            Facets names are not case-sensitive in ShExC.
          </p>
          </li>
          <li id="vocab-node-kind"><code>node kind</code>: identifies the kind of RDF node (IRI, RDF literal, or Blank Node), e.g.
          <pre class="schema shexc shh">my:UserShape {
  foaf:mbox <span class="value-constraint new">IRI</span>
}</pre>
          <pre class="schema json shh">{ "my:UserShape": { "type": "Shape",
  "expression": {
    "type": "TripleConstraint", "predicate": "foaf:mbox",
    "value": { "type": "NodeConstraint", <span class="value-constraint new">"nodeKind": "IRI"</span> } } } }</pre>
          <p>
            The following node kinds correspond to RDF node types: <code class="value-constraint">Literal</code>, <code class="value-constraint">IRI</code>, <code class="value-constraint">BNode</code>.
            The node kind <code class="value-constraint">NonLiteral</code> identifies the union of <code class="value-constraint">IRI</code>s and <code class="value-constraint">BNode</code>s.
            Node kinds are not case-sensitive in ShExC.
          </p>
          </li>
          <li id="vocab-value-set"><code>value set</code>: enumerates specific expected values, e.g.
          <pre class="schema shexc shh">my:IssueShape {
  ex:state <span class="value-constraint new">[ex:unassigned ex:assigned]</span>
}</pre>
          <pre class="schema json shh">
{ "my:IssueShape": { "type": "Shape",
  "expression": { "type": "TripleConstraint", "predicate": "ex:status",
    "value": { "type": "NodeConstraint", "values": <span class="value-constraint new">[ "ex:unassigned", "ex:assigned" ]</span> } } } }</pre>
          <p>
            See the <a href="#value-sets">Value Sets description below</a> for details.
          </p>
          </li>
          <li id="vocab-value-Shape"><code id="value-shape">value shape</code>: asserts that the object is described by another shape, e.g.
          <pre class="schema shexc shh">my:IssueShape {
  ex:reportedBy <span class="value-constraint new">@my:UserShape</span>
}</pre>
          <pre class="schema json">{ "my:IssueShape": { "type": "Shape",
  "expression": { "type": "TripleConstraint", "predicate": "ex:reportedBy",
      "value": { "type": "ShapeRef", <span class="value-constraint new">"reference": "my:PersonShape"</span> } } } }</pre>
          </li>
        </ul>
      </section>

      <section id="validation">
          <h2>RDF Validation</h2>
          <p>
            Most applications that share data do so using prescribed data structures.
            While RDFS and OWL enable one to make assertions about the objects in some domain, ShEx describes data structures.
            ShEx "schemas" provide:
          </p>
          <ul>
            <li>An intuitive, domain-specific language for describing graph structure</li>
            <li>A portable JSON structure which expresses the same description.</li>
            <li>Constraints on the number and object type of arcs with a specified predicate.</li>
            <li>Value sets and simple set operations on lists of IRIs and IRI stems.</li>
            <li>XML Schema facet constraints on the objects of constrained predicates.</li>
            <li>Logical algebraic combinations of constraints on triples.</li>
            <li>Semantic actions for additional validation expressivity or other purposes.</li>
          </ul>
          <p>
            The example snippets in this document use ShExC and JSON [[json-ld]] notation.
            The reader should be familiar with basic RDF concepts [[rdf11-concepts]] such as triples and JSON [[json]].
          </p>
          <p>
            This document uses a running example illustrated by the following graph in which an Issue which is submitted by some person and potentially assigned to the same person or someone else.
            These issues can have a status of <code>unassigned</code> or <code>assigned</code>.
          </p>
<svg
   preserveAspectRatio="xMinYMin meet"
   viewBox="0 0 466 151"
   width="866"
   height="251"
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   fill-opacity="0"
   color-rendering="auto"
   color-interpolation="auto"
   stroke="rgb(0,0,0)"
   text-rendering="auto"
   stroke-linecap="square"
   stroke-miterlimit="10"
   stroke-opacity="0"
   shape-rendering="auto"
   fill="rgb(0,0,0)"
   stroke-dasharray="none"
   font-weight="normal"
   stroke-width="1"
   font-family="'Dialog'"
   font-style="normal"
   stroke-linejoin="miter"
   font-size="12"
   stroke-dashoffset="0"
   image-rendering="auto"
   id="svg3351"
   version="1.1"
   inkscape:version="0.48.4 r9939"
   sodipodi:docname="ex1.svg">
  <metadata
     id="metadata3536">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <sodipodi:namedview
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1"
     objecttolerance="10"
     gridtolerance="10"
     guidetolerance="10"
     inkscape:pageopacity="0"
     inkscape:pageshadow="2"
     inkscape:window-width="1920"
     inkscape:window-height="1058"
     id="namedview3534"
     showgrid="false"
     inkscape:zoom="2.0879376"
     inkscape:cx="260.34707"
     inkscape:cy="41.69783"
     inkscape:window-x="0"
     inkscape:window-y="0"
     inkscape:window-maximized="1"
     inkscape:current-layer="layer2" />
  <!--Generated by the Batik Graphics2D SVG Generator-->
  <defs
     id="genericDefs">
    <marker
       inkscape:stockid="Arrow2Mend"
       orient="auto"
       refY="0.0"
       refX="0.0"
       id="Arrow2Mend"
       style="overflow:visible;">
      <path
         id="path4575"
         style="fill-rule:evenodd;stroke-width:0.62500000;stroke-linejoin:round;"
         d="M 8.7185878,4.0337352 L -2.2072895,0.016013256 L 8.7185884,-4.0017078 C 6.9730900,-1.6296469 6.9831476,1.6157441 8.7185878,4.0337352 z "
         transform="scale(0.6) rotate(180) translate(0,0)" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Send"
       orient="auto"
       refY="0.0"
       refX="0.0"
       id="Arrow1Send"
       style="overflow:visible;">
      <path
         id="path4563"
         d="M 0.0,0.0 L 5.0,-5.0 L -12.5,0.0 L 5.0,5.0 L 0.0,0.0 z "
         style="fill-rule:evenodd;stroke:#000000;stroke-width:1.0pt;"
         transform="scale(0.2) rotate(180) translate(6,0)" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Lend"
       orient="auto"
       refY="0.0"
       refX="0.0"
       id="Arrow1Lend"
       style="overflow:visible;">
      <path
         id="path4551"
         d="M 0.0,0.0 L 5.0,-5.0 L -12.5,0.0 L 5.0,5.0 L 0.0,0.0 z "
         style="fill-rule:evenodd;stroke:#000000;stroke-width:1.0pt;"
         transform="scale(0.8) rotate(180) translate(12.5,0)" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Mend"
       orient="auto"
       refY="0.0"
       refX="0.0"
       id="Arrow1Mend"
       style="overflow:visible;">
      <path
         id="path4557"
         d="M 0.0,0.0 L 5.0,-5.0 L -12.5,0.0 L 5.0,5.0 L 0.0,0.0 z "
         style="fill-rule:evenodd;stroke:#000000;stroke-width:1.0pt;"
         transform="scale(0.4) rotate(180) translate(10,0)" />
    </marker>
    <marker
       inkscape:stockid="Arrow2Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="Arrow2Mend-7"
       style="overflow:visible">
      <path
         inkscape:connector-curvature="0"
         id="path4575-8"
         style="fill-rule:evenodd;stroke-width:0.625;stroke-linejoin:round"
         d="M 8.7185878,4.0337352 -2.2072895,0.01601326 8.7185884,-4.0017078 c -1.7454984,2.3720609 -1.7354408,5.6174519 -6e-7,8.035443 z"
         transform="scale(-0.6,-0.6)" />
    </marker>
    <marker
       inkscape:stockid="Arrow2Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="marker7228"
       style="overflow:visible">
      <path
         inkscape:connector-curvature="0"
         id="path7230"
         style="fill-rule:evenodd;stroke-width:0.625;stroke-linejoin:round"
         d="M 8.7185878,4.0337352 -2.2072895,0.01601326 8.7185884,-4.0017078 c -1.7454984,2.3720609 -1.7354408,5.6174519 -6e-7,8.035443 z"
         transform="scale(-0.6,-0.6)" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Lend"
       orient="auto"
       refY="0"
       refX="0"
       id="Arrow1Lend-9"
       style="overflow:visible">
      <path
         inkscape:connector-curvature="0"
         id="path4551-4"
         d="M 0,0 5,-5 -12.5,0 5,5 0,0 z"
         style="fill-rule:evenodd;stroke:#000000;stroke-width:1pt"
         transform="matrix(-0.8,0,0,-0.8,-10,0)" />
    </marker>
    <marker
       inkscape:stockid="Arrow2Mend"
       orient="auto"
       refY="0"
       refX="0"
       id="Arrow2Mend-0"
       style="overflow:visible">
      <path
         inkscape:connector-curvature="0"
         id="path4575-2"
         style="fill-rule:evenodd;stroke-width:0.625;stroke-linejoin:round"
         d="M 8.7185878,4.0337352 -2.2072895,0.01601326 8.7185884,-4.0017078 c -1.7454984,2.3720609 -1.7354408,5.6174519 -6e-7,8.035443 z"
         transform="scale(-0.6,-0.6)" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Lend"
       orient="auto"
       refY="0"
       refX="0"
       id="Arrow1Lend-7"
       style="overflow:visible">
      <path
         inkscape:connector-curvature="0"
         id="path4551-8"
         d="M 0,0 5,-5 -12.5,0 5,5 0,0 z"
         style="fill-rule:evenodd;stroke:#000000;stroke-width:1pt"
         transform="matrix(-0.8,0,0,-0.8,-10,0)" />
    </marker>
    <marker
       inkscape:stockid="Arrow1Lend"
       orient="auto"
       refY="0"
       refX="0"
       id="Arrow1Lend-91"
       style="overflow:visible">
      <path
         inkscape:connector-curvature="0"
         id="path4551-41"
         d="M 0,0 5,-5 -12.5,0 5,5 0,0 z"
         style="fill-rule:evenodd;stroke:#000000;stroke-width:1pt"
         transform="matrix(-0.8,0,0,-0.8,-10,0)" />
    </marker>
  </defs>
  <g
     id="g3354">
    <defs
       id="defs1">
      <linearGradient
         x1="65"
         gradientUnits="userSpaceOnUse"
         x2="65"
         y1="100"
         y2="0"
         id="linearGradient1"
         spreadMethod="reflect">
        <stop
           stop-opacity="1"
           stop-color="rgb(118,148,200)"
           offset="0%"
           id="stop3358" />
        <stop
           stop-opacity="1"
           stop-color="rgb(238,243,251)"
           offset="100%"
           id="stop3360" />
      </linearGradient>
      <linearGradient
         x1="85"
         gradientUnits="userSpaceOnUse"
         x2="85"
         y1="100"
         y2="0"
         id="linearGradient2"
         spreadMethod="reflect">
        <stop
           stop-opacity="1"
           stop-color="rgb(118,148,200)"
           offset="0%"
           id="stop3363" />
        <stop
           stop-opacity="1"
           stop-color="rgb(238,243,251)"
           offset="100%"
           id="stop3365" />
      </linearGradient>
      <clipPath
         clipPathUnits="userSpaceOnUse"
         id="clipPath1">
        <path
           d="M-7 -7 L141 -7 L141 111 L-7 111 L-7 -7 Z"
           id="path3368" />
      </clipPath>
      <clipPath
         clipPathUnits="userSpaceOnUse"
         id="clipPath2">
        <path
           d="M0 0 L0 85 L130 85 L130 0 Z"
           id="path3371" />
      </clipPath>
      <clipPath
         clipPathUnits="userSpaceOnUse"
         id="clipPath3">
        <path
           d="M0 0 L130 0 L130 15 L0 15 L0 0 Z"
           id="path3374" />
      </clipPath>
      <clipPath
         clipPathUnits="userSpaceOnUse"
         id="clipPath4">
        <path
           d="M-7 -7 L181 -7 L181 111 L-7 111 L-7 -7 Z"
           id="path3377" />
      </clipPath>
      <clipPath
         clipPathUnits="userSpaceOnUse"
         id="clipPath5">
        <path
           d="M0 0 L0 85 L170 85 L170 0 Z"
           id="path3380" />
      </clipPath>
      <clipPath
         clipPathUnits="userSpaceOnUse"
         id="clipPath6">
        <path
           d="M0 0 L170 0 L170 15 L0 15 L0 0 Z"
           id="path3383" />
      </clipPath>
      <clipPath
         clipPathUnits="userSpaceOnUse"
         id="clipPath7">
        <path
           d="M-7 -7 L48 -7 L48 26 L-7 26 L-7 -7 Z"
           id="path3386" />
      </clipPath>
      <clipPath
         clipPathUnits="userSpaceOnUse"
         id="clipPath8">
        <path
           d="M0 0 L37 0 L37 15 L0 15 L0 0 Z"
           id="path3389" />
      </clipPath>
      <clipPath
         clipPathUnits="userSpaceOnUse"
         id="clipPath9">
        <path
           d="M-7 -7 L50 -7 L50 26 L-7 26 L-7 -7 Z"
           id="path3392" />
      </clipPath>
      <clipPath
         clipPathUnits="userSpaceOnUse"
         id="clipPath10">
        <path
           d="M0 0 L39 0 L39 15 L0 15 L0 0 Z"
           id="path3395" />
      </clipPath>
      <clipPath
         clipPathUnits="userSpaceOnUse"
         id="clipPath11">
        <path
           d="M-7 -7 L37 -7 L37 27 L-7 27 L-7 -7 Z"
           id="path3398" />
      </clipPath>
      <clipPath
         clipPathUnits="userSpaceOnUse"
         id="clipPath12">
        <path
           d="M0 0 L26 0 L26 16 L0 16 L0 0 Z"
           id="path3401" />
      </clipPath>
      <clipPath
         clipPathUnits="userSpaceOnUse"
         id="clipPath13">
        <path
           d="M-7 -7 L47 -7 L47 26 L-7 26 L-7 -7 Z"
           id="path3404" />
      </clipPath>
      <clipPath
         clipPathUnits="userSpaceOnUse"
         id="clipPath14">
        <path
           d="M0 0 L36 0 L36 15 L0 15 L0 0 Z"
           id="path3407" />
      </clipPath>
      <clipPath
         clipPathUnits="userSpaceOnUse"
         id="clipPath15">
        <path
           d="M-7 -7 L49 -7 L49 26 L-7 26 L-7 -7 Z"
           id="path3410" />
      </clipPath>
      <clipPath
         clipPathUnits="userSpaceOnUse"
         id="clipPath16">
        <path
           d="M0 0 L38 0 L38 15 L0 15 L0 0 Z"
           id="path3413" />
      </clipPath>
      <clipPath
         clipPathUnits="userSpaceOnUse"
         id="clipPath17">
        <path
           d="M0 0 L171 0 L171 52 L0 52 L0 0 Z"
           id="path3416" />
      </clipPath>
      <clipPath
         clipPathUnits="userSpaceOnUse"
         id="clipPath18">
        <path
           d="M0 0 L162 0 L162 112 L0 112 L0 0 Z"
           id="path3419" />
      </clipPath>
      <clipPath
         clipPathUnits="userSpaceOnUse"
         id="clipPath19">
        <path
           d="M-77 -15 L154 -15 L154 30 L-77 30 L-77 -15 Z"
           id="path3422" />
      </clipPath>
      <clipPath
         clipPathUnits="userSpaceOnUse"
         id="clipPath20">
        <path
           d="M-92 -15 L184 -15 L184 30 L-92 30 L-92 -15 Z"
           id="path3425" />
      </clipPath>
      <clipPath
         clipPathUnits="userSpaceOnUse"
         id="clipPath21">
        <path
           d="M-57 -15 L114 -15 L114 30 L-57 30 L-57 -15 Z"
           id="path3428" />
      </clipPath>
    </defs>
  </g>
  <g
     inkscape:groupmode="layer"
     id="layer1"
     inkscape:label="UML"
     style="display:none">
    <g
       text-rendering="geometricPrecision"
       id="g3430"
       style="fill:#ffffff;fill-opacity:1;stroke:#ffffff;stroke-opacity:1">
      <rect
         x="0"
         width="466"
         height="151"
         y="0"
         id="rect3432"
         style="stroke:none" />
    </g>
    <g
       font-size="11"
       transform="translate(332,2)"
       text-rendering="geometricPrecision"
       font-weight="bold"
       id="g3434"
       style="font-size:11px;font-weight:bold;fill:url(#linearGradient1);fill-opacity:1;stroke:url(#linearGradient1);stroke-opacity:1;font-family:sans-serif">
      <rect
         x="0"
         width="130"
         height="100"
         y="0"
         clip-path="url(#clipPath1)"
         id="rect3436"
         style="stroke:none" />
    </g>
    <g
       font-size="11"
       transform="translate(332,2)"
       text-rendering="geometricPrecision"
       font-weight="bold"
       stroke-miterlimit="0"
       id="g3438"
       style="font-size:11px;font-weight:bold;fill:#000000;fill-opacity:1;stroke:#000000;stroke-linecap:butt;stroke-linejoin:round;stroke-miterlimit:0;stroke-opacity:1;font-family:sans-serif">
      <rect
         x="0"
         width="130"
         height="100"
         y="0"
         clip-path="url(#clipPath1)"
         id="rect3440"
         style="fill:none" />
      <line
         y2="15"
         x1="0"
         clip-path="url(#clipPath1)"
         x2="130"
         y1="15"
         id="line3442"
         style="fill:none" />
    </g>
    <g
       font-size="11"
       transform="translate(332,17)"
       text-rendering="geometricPrecision"
       id="g3444"
       style="font-size:11px;fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1;font-family:sans-serif">
      <text
         x="2"
         xml:space="preserve"
         y="14"
         clip-path="url(#clipPath2)"
         id="text3446"
         style="stroke:none"> :name : xsd:string</text>
    </g>
    <g
       font-size="11"
       transform="translate(332,17)"
       text-rendering="geometricPrecision"
       id="g3448"
       style="font-size:11px;fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1;font-family:sans-serif">
      <!--
<text x="2" xml:space="preserve" y="29" clip-path="url(#clipPath2)" stroke="none"
      > :givenName : xsd:string</text
      ><text x="2" xml:space="preserve" y="44" clip-path="url(#clipPath2)" stroke="none"
      > :familyName : xsd:string</text
      >
-->
      <text
         x="2"
         xml:space="preserve"
         y="59"
         clip-path="url(#clipPath2)"
         id="text3450"
         style="stroke:none"> :mbox : AnyURI</text>
    </g>
    <g
       font-size="11"
       transform="translate(332,2)"
       text-rendering="geometricPrecision"
       font-weight="bold"
       id="g3452"
       style="font-size:11px;font-weight:bold;fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1;font-family:sans-serif">
      <text
         x="50"
         xml:space="preserve"
         y="12"
         clip-path="url(#clipPath3)"
         id="text3454"
         style="stroke:none">:User</text>
    </g>
    <g
       font-size="11"
       transform="translate(42,2)"
       text-rendering="geometricPrecision"
       font-weight="bold"
       id="g3456"
       style="font-size:11px;font-weight:bold;fill:url(#linearGradient2);fill-opacity:1;stroke:url(#linearGradient2);stroke-opacity:1;font-family:sans-serif">
      <rect
         x="0"
         width="170"
         height="100"
         y="0"
         clip-path="url(#clipPath4)"
         id="rect3458"
         style="stroke:none" />
    </g>
    <g
       font-size="11"
       transform="translate(42,2)"
       text-rendering="geometricPrecision"
       font-weight="bold"
       stroke-miterlimit="0"
       id="g3460"
       style="font-size:11px;font-weight:bold;fill:#000000;fill-opacity:1;stroke:#000000;stroke-linecap:butt;stroke-linejoin:round;stroke-miterlimit:0;stroke-opacity:1;font-family:sans-serif">
      <rect
         x="0"
         width="170"
         height="100"
         y="0"
         clip-path="url(#clipPath4)"
         id="rect3462"
         style="fill:none" />
      <line
         y2="15"
         x1="0"
         clip-path="url(#clipPath4)"
         x2="170"
         y1="15"
         id="line3464"
         style="fill:none" />
    </g>
    <g
       font-size="11"
       transform="translate(42,17)"
       text-rendering="geometricPrecision"
       id="g3466"
       style="font-size:11px;fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1;font-family:sans-serif">
      <text
         x="2"
         xml:space="preserve"
         y="14"
         clip-path="url(#clipPath5)"
         id="text3468"
         style="stroke:none"> :status = Assigned|Unassigned</text>
    </g>
    <g
       font-size="11"
       transform="translate(42,17)"
       text-rendering="geometricPrecision"
       id="g3470"
       style="font-size:11px;fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1;font-family:sans-serif">
      <text
         x="2"
         xml:space="preserve"
         y="29"
         clip-path="url(#clipPath5)"
         id="text3472"
         style="stroke:none"> :reportedOn : xsd:dateTime</text>
      <!-- 
<text x="2" xml:space="preserve" y="44" clip-path="url(#clipPath5)" stroke="none"
      > :assignedOn : xsd:dateTime?</text
    >
-->
    </g>
    <g
       font-size="11"
       transform="translate(42,2)"
       text-rendering="geometricPrecision"
       font-weight="bold"
       id="g3474"
       style="font-size:11px;font-weight:bold;fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1;font-family:sans-serif">
      <text
         x="69"
         xml:space="preserve"
         y="12"
         clip-path="url(#clipPath6)"
         id="text3476"
         style="stroke:none">:Issue</text>
    </g>
    <g
       font-size="11"
       transform="translate(212,62)"
       text-rendering="geometricPrecision"
       id="g3478"
       style="font-size:11px;fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1;font-family:sans-serif">
      <text
         x="10"
         xml:space="preserve"
         y="12"
         clip-path="url(#clipPath8)"
         id="text3480"
         style="stroke:none">0..*</text>
    </g>
    <g
       font-size="11"
       transform="translate(302,62)"
       text-rendering="geometricPrecision"
       id="g3482"
       style="font-size:11px;fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1;font-family:sans-serif">
      <text
         x="10"
         xml:space="preserve"
         y="12"
         clip-path="url(#clipPath10)"
         id="text3484"
         style="stroke:none">0..1</text>
    </g>
    <g
       font-size="11"
       transform="translate(312,22)"
       text-rendering="geometricPrecision"
       id="g3486"
       style="font-size:11px;fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1;font-family:sans-serif">
      <text
         x="10"
         xml:space="preserve"
         y="12"
         clip-path="url(#clipPath12)"
         id="text3488"
         style="stroke:none">1</text>
    </g>
    <g
       font-size="11"
       transform="translate(212,22)"
       text-rendering="geometricPrecision"
       id="g3490"
       style="font-size:11px;fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1;font-family:sans-serif">
      <text
         x="10"
         xml:space="preserve"
         y="12"
         clip-path="url(#clipPath8)"
         id="text3492"
         style="stroke:none">0..*</text>
    </g>
    <g
       font-size="11"
       transform="translate(122,102)"
       text-rendering="geometricPrecision"
       id="g3494"
       style="font-size:11px;fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1;font-family:sans-serif">
      <text
         x="9"
         xml:space="preserve"
         y="12"
         clip-path="url(#clipPath14)"
         id="text3496"
         style="stroke:none">0..*</text>
    </g>
    <g
       font-size="11"
       transform="translate(2,52)"
       text-rendering="geometricPrecision"
       id="g3498"
       style="font-size:11px;fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1;font-family:sans-serif">
      <text
         x="10"
         xml:space="preserve"
         y="12"
         clip-path="url(#clipPath16)"
         id="text3500"
         style="stroke:none">0..1</text>
    </g>
    <g
       font-size="11"
       transform="translate(188,18)"
       text-rendering="geometricPrecision"
       id="g3502"
       style="font-size:11px;fill:#000000;fill-opacity:1;stroke:#000000;stroke-linecap:butt;stroke-linejoin:round;stroke-opacity:1;font-family:sans-serif">
      <line
         y2="24"
         x1="143"
         clip-path="url(#clipPath17)"
         x2="24"
         y1="24"
         id="line3504"
         style="fill:none" />
    </g>
    <g
       font-size="11"
       transform="translate(189,58)"
       text-rendering="geometricPrecision"
       id="g3506"
       style="font-size:11px;fill:#000000;fill-opacity:1;stroke:#000000;stroke-linecap:butt;stroke-linejoin:round;stroke-opacity:1;font-family:sans-serif">
      <line
         y2="24"
         x1="24"
         clip-path="url(#clipPath17)"
         x2="143"
         y1="24"
         id="line3508"
         style="fill:none" />
    </g>
    <g
       font-size="11"
       transform="translate(-12,48)"
       text-rendering="geometricPrecision"
       id="g3510"
       style="font-size:11px;fill:#000000;fill-opacity:1;stroke:#000000;stroke-linecap:butt;stroke-linejoin:round;stroke-opacity:1;font-family:sans-serif">
      <line
         y2="84"
         x1="134"
         clip-path="url(#clipPath18)"
         x2="134"
         y1="55"
         id="line3512"
         style="fill:none" />
      <line
         y2="84"
         x1="134"
         clip-path="url(#clipPath18)"
         x2="24"
         y1="84"
         id="line3514"
         style="fill:none" />
      <line
         y2="24"
         x1="24"
         clip-path="url(#clipPath18)"
         x2="24"
         y1="84"
         id="line3516"
         style="fill:none" />
      <line
         y2="24"
         x1="24"
         clip-path="url(#clipPath18)"
         x2="53"
         y1="24"
         id="line3518"
         style="fill:none" />
    </g>
    <g
       font-size="11"
       transform="translate(232,42)"
       text-rendering="geometricPrecision"
       id="g3520"
       style="font-size:11px;fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1;font-family:sans-serif">
      <text
         x="10"
         xml:space="preserve"
         y="12"
         clip-path="url(#clipPath19)"
         id="text3522"
         style="stroke:none">:reportedBy</text>
    </g>
    <g
       font-size="11"
       transform="translate(222,82)"
       text-rendering="geometricPrecision"
       id="g3524"
       style="font-size:11px;fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1;font-family:sans-serif">
      <text
         x="10"
         xml:space="preserve"
         y="12"
         clip-path="url(#clipPath20)"
         id="text3526"
         style="stroke:none">:reproducedBy</text>
    </g>
    <g
       font-size="11"
       transform="translate(22,132)"
       text-rendering="geometricPrecision"
       id="g3528"
       style="font-size:11px;fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1;font-family:sans-serif">
      <text
         x="10"
         xml:space="preserve"
         y="12"
         clip-path="url(#clipPath21)"
         id="text3530"
         style="stroke:none">:related</text>
    </g>
    <g
       text-rendering="geometricPrecision"
       font-size="10"
       id="g3532"
       style="font-size:10px;fill:#787878;fill-opacity:1;stroke:#787878;stroke-opacity:1" />
  </g>
  <g
     inkscape:groupmode="layer"
     id="layer2"
     inkscape:label="Example"
     style="display:inline">
    <g
       font-size="11"
       transform="translate(-56.889536,21.96221)"
       text-rendering="geometricPrecision"
       font-weight="bold"
       id="g4526"
       style="font-size:11px;font-weight:bold;fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1;font-family:sans-serif">
      <text
         x="69"
         xml:space="preserve"
         y="12"
         id="text4528"
         style="stroke:none">some:Issue</text>
    </g>
    <path
       sodipodi:type="arc"
       style="fill:none;stroke:#000000;stroke-opacity:1"
       id="ex1_Issue"
       sodipodi:cx="114.80669"
       sodipodi:cy="29.75872"
       sodipodi:rx="94.486916"
       sodipodi:ry="34.543606"
       d="m 209.2936,29.75872 a 94.486916,34.543606 0 1 1 -188.973829,0 94.486916,34.543606 0 1 1 188.973829,0 z"
       transform="matrix(0.48286072,0,0,0.54625635,-7.3455226,14.838586)" />
    <path
       transform="matrix(0.44712027,0,0,0.54653493,213.37109,14.830296)"
       d="m 209.2936,29.75872 a 94.486916,34.543606 0 1 1 -188.973829,0 94.486916,34.543606 0 1 1 188.973829,0 z"
       sodipodi:ry="34.543606"
       sodipodi:rx="94.486916"
       sodipodi:cy="29.75872"
       sodipodi:cx="114.80669"
       id="ex1_User"
       style="fill:none;stroke:#000000;stroke-opacity:1"
       sodipodi:type="arc" />
    <g
       style="font-size:11px;font-weight:bold;fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1;font-family:sans-serif"
       id="g4532"
       font-weight="bold"
       text-rendering="geometricPrecision"
       transform="translate(163.11046,21.96221)"
       font-size="11">
      <text
         style="stroke:none"
         id="text4534"
         y="12"
         xml:space="preserve"
         x="69">some:User</text>
    </g>
    <path
       transform="matrix(0.62228098,0,0,0.54525881,170.58275,69.120974)"
       d="m 209.2936,29.75872 a 94.486916,34.543606 0 1 1 -188.973829,0 94.486916,34.543606 0 1 1 188.973829,0 z"
       sodipodi:ry="34.543606"
       sodipodi:rx="94.486916"
       sodipodi:cy="29.75872"
       sodipodi:cx="114.80669"
       id="ex1_Employee"
       style="fill:none;stroke:#000000;stroke-opacity:1"
       sodipodi:type="arc" />
    <g
       style="font-size:11px;font-weight:bold;fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1;font-family:sans-serif"
       id="g4538"
       font-weight="bold"
       text-rendering="geometricPrecision"
       transform="translate(123.83726,76.214912)"
       font-size="11">
      <text
         style="stroke:none"
         id="text4540"
         y="12"
         xml:space="preserve"
         x="69">some:Employee</text>
    </g>
    <path
       style="fill:#000000;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:0;stroke-opacity:1;stroke-dasharray:none;marker-end:url(#Arrow1Lend)"
       d="M 88.052326,21.630814 142.9157,14.180232"
       id="ex1_state_p"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <text
       xml:space="preserve"
       style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:125%;letter-spacing:0px;word-spacing:0px;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none"
       x="129.22105"
       y="24.197662"
       id="text6638"
       sodipodi:linespacing="125%"
       transform="matrix(0.99525641,-0.09728658,0.09728658,0.99525641,0,0)"><tspan
         sodipodi:role="line"
         id="tspan6640"
         x="129.22105"
         y="24.197662">ex:state</tspan></text>
    <text
       xml:space="preserve"
       style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:125%;letter-spacing:0px;word-spacing:0px;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;font-family:Impact;-inkscape-font-specification:Sans"
       x="151.04359"
       y="12.148256"
       id="text6770"
       sodipodi:linespacing="125%"><tspan
         sodipodi:role="line"
         id="tspan6772"></tspan></text>
    <text
       xml:space="preserve"
       style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;letter-spacing:0px;word-spacing:0px;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;font-family:Impact;-inkscape-font-specification:Sans"
       x="148.3343"
       y="20.953487"
       id="text6774"
       sodipodi:linespacing="125%"><tspan
         sodipodi:role="line"
         id="tspan6776"></tspan></text>
    <text
       xml:space="preserve"
       style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;letter-spacing:0px;word-spacing:0px;text-anchor:start;fill:#C83500;fill-opacity:1;stroke:none;font-family:Impact;-inkscape-font-specification:Sans"
       x="145.625"
       y="14.180232"
       id="text6778"
       sodipodi:linespacing="125%"><tspan
         sodipodi:role="line"
         id="tspan6780"
         x="145.625"
         y="14.180232">ex:assigned</tspan></text>
    <path
       style="fill:none;stroke:#000000;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;marker-end:url(#Arrow2Mend)"
       d="M 93.47093,31.113372 222.12171,29.64251"
       id="path6782"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <text
       xml:space="preserve"
       style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:125%;letter-spacing:0px;word-spacing:0px;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;display:inline"
       x="197.7518"
       y="30.791992"
       id="text6638-2"
       sodipodi:linespacing="125%"
       transform="matrix(0.99964189,-0.02676001,0.02676001,0.99964189,0,0)"
       inkscape:transform-center-x="-12.452479"><tspan
         sodipodi:role="line"
         id="tspan6640-4"
         x="197.7518"
         y="30.791992">ex:submittedBy</tspan></text>
    <path
       style="fill:none;stroke:#000000;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;marker-end:url(#Arrow2Mend)"
       d="M 91.477829,37.251391 192.53449,74.608829"
       id="path7005"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <text
       xml:space="preserve"
       style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:125%;letter-spacing:0px;word-spacing:0px;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;display:inline"
       x="197.05046"
       y="0.80997449"
       id="text6638-2-3"
       sodipodi:linespacing="125%"
       transform="matrix(0.93991687,0.3414034,-0.3414034,0.93991687,0,0)"
       inkscape:transform-center-x="-11.239559"
       inkscape:transform-center-y="6.2266342"><tspan
         sodipodi:role="line"
         id="tspan6640-4-9"
         x="197.05046"
         y="0.80997449">ex:reproducedBy</tspan></text>
    <path
       transform="matrix(0.50272101,0,0,0.54610605,359.65638,22.934707)"
       d="m 209.2936,29.75872 a 94.486916,34.543606 0 1 1 -188.973829,0 94.486916,34.543606 0 1 1 188.973829,0 z"
       sodipodi:ry="34.543606"
       sodipodi:rx="94.486916"
       sodipodi:cy="29.75872"
       sodipodi:cx="114.80669"
       id="ex1_User-2"
       style="fill:none;stroke:#000000;stroke-opacity:1;display:inline"
       sodipodi:type="arc" />
    <g
       style="font-size:11px;font-weight:bold;fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1;display:inline;font-family:sans-serif"
       id="g4532-9"
       font-weight="bold"
       text-rendering="geometricPrecision"
       transform="translate(314.34227,30.053858)"
       font-size="11">
      <text
         style="stroke:none"
         id="text4534-9"
         y="12.478942"
         xml:space="preserve"
         x="58.463287">mailto:bob@...</text>
    </g>
    <path
       style="fill:#000000;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:0;stroke-opacity:1;stroke-dasharray:none;marker-end:url(#Arrow1Lend);display:inline"
       d="m 301.46229,20.875275 54.86338,-7.450582"
       id="ex1_state_p-0"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <text
       xml:space="preserve"
       style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:125%;letter-spacing:0px;word-spacing:0px;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;display:inline"
       x="341.69205"
       y="44.207619"
       id="text6638-1"
       sodipodi:linespacing="125%"
       transform="matrix(0.99525641,-0.09728658,0.09728658,0.99525641,0,0)"><tspan
         sodipodi:role="line"
         id="tspan6640-44"
         x="341.69205"
         y="44.207619">foaf:name</tspan></text>
    <text
       xml:space="preserve"
       style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;letter-spacing:0px;word-spacing:0px;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;display:inline;font-family:Impact;-inkscape-font-specification:Sans"
       x="359.03497"
       y="13.424692"
       id="text6778-6"
       sodipodi:linespacing="125%"><tspan
         sodipodi:role="line"
         id="tspan6780-5"
         x="359.03497"
         y="13.424692">Bob Smith</tspan></text>
    <path
       style="fill:none;stroke:#000000;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;marker-end:url(#Arrow2Mend);display:inline"
       d="m 306.8809,30.357833 61.12002,11.460559"
       id="path6782-3"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <text
       xml:space="preserve"
       style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:125%;letter-spacing:0px;word-spacing:0px;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;display:inline"
       x="368.17676"
       y="-18.619452"
       id="text6638-2-9"
       sodipodi:linespacing="125%"
       transform="matrix(0.98834834,0.15220895,-0.15220895,0.98834834,0,0)"
       inkscape:transform-center-x="-12.122235"
       inkscape:transform-center-y="2.0477642"><tspan
         sodipodi:role="line"
         id="tspan6640-4-1"
         x="368.17676"
         y="-18.619452">foaf:mbox</tspan></text>
    <rect
       style="fill:none;fill-opacity:1;fill-rule:nonzero;stroke:#000000;stroke-width:1;stroke-linejoin:round;stroke-miterlimit:0;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0"
       id="rect7302"
       width="47.415211"
       height="15.80507"
       x="356.81143"
       y="2.0491898" />
    <path
       transform="matrix(0.50272101,0,0,0.54610605,358.07589,113.95686)"
       d="m 209.2936,29.75872 a 94.486916,34.543606 0 1 1 -188.973829,0 94.486916,34.543606 0 1 1 188.973829,0 z"
       sodipodi:ry="34.543606"
       sodipodi:rx="94.486916"
       sodipodi:cy="29.75872"
       sodipodi:cx="114.80669"
       id="ex1_User-2-3"
       style="fill:none;stroke:#000000;stroke-opacity:1;display:inline"
       sodipodi:type="arc" />
    <g
       style="font-size:11px;font-weight:bold;fill:#000000;fill-opacity:1;stroke:#000000;stroke-opacity:1;display:inline;font-family:sans-serif"
       id="g4532-9-1"
       font-weight="bold"
       text-rendering="geometricPrecision"
       transform="translate(312.76178,121.07601)"
       font-size="11">
      <text
         style="stroke:none"
         id="text4534-9-4"
         y="12.478942"
         xml:space="preserve"
         x="58.463287">mailto:joe@...</text>
    </g>
    <path
       style="fill:#000000;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:0;stroke-opacity:1;stroke-dasharray:none;marker-end:url(#Arrow1Lend);display:inline"
       d="m 295.65556,77.160936 120.5981,-8.288729"
       id="ex1_state_p-0-9"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <text
       xml:space="preserve"
       style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:125%;letter-spacing:0px;word-spacing:0px;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;display:inline"
       x="367.66379"
       y="102.81908"
       id="text6638-1-0"
       sodipodi:linespacing="125%"
       transform="matrix(0.99525641,-0.09728658,0.09728658,0.99525641,0,0)"><tspan
         sodipodi:role="line"
         id="tspan6640-44-1"
         x="367.66379"
         y="102.81908">foaf:givenName</tspan></text>
    <text
       xml:space="preserve"
       style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;letter-spacing:0px;word-spacing:0px;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;display:inline;font-family:Impact;-inkscape-font-specification:Sans"
       x="419.22824"
       y="71.71035"
       id="text6778-6-7"
       sodipodi:linespacing="125%"><tspan
         sodipodi:role="line"
         id="tspan6780-5-9"
         x="419.22824"
         y="71.71035">Joe</tspan></text>
    <path
       style="fill:none;stroke:#000000;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;marker-end:url(#Arrow2Mend);display:inline"
       d="M 297.24264,91.432909 367.94149,126.3616"
       id="path6782-3-8"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <text
       xml:space="preserve"
       style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:125%;letter-spacing:0px;word-spacing:0px;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;display:inline"
       x="375.06934"
       y="-50.142578"
       id="text6638-2-9-2"
       sodipodi:linespacing="125%"
       transform="matrix(0.89968487,0.43653997,-0.43653997,0.89968487,0,0)"
       inkscape:transform-center-x="-10.671641"
       inkscape:transform-center-y="5.5748169"><tspan
         sodipodi:role="line"
         id="tspan6640-4-1-8"
         x="375.06934"
         y="-50.142578">foaf:mbox</tspan></text>
    <rect
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linejoin:round;stroke-miterlimit:0;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0;display:inline"
       id="rect7302-7"
       width="19.157673"
       height="15.805073"
       x="417.0047"
       y="60.33485" />
    <path
       style="fill:#000000;fill-opacity:1;stroke:#000000;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:0;stroke-opacity:1;stroke-dasharray:none;marker-end:url(#Arrow1Lend);display:inline"
       d="m 300.92627,86.134992 134.48741,7.396605"
       id="ex1_state_p-0-9-2"
       inkscape:connector-curvature="0"
       sodipodi:nodetypes="cc" />
    <text
       xml:space="preserve"
       style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:end;line-height:125%;letter-spacing:0px;word-spacing:0px;text-anchor:end;fill:#000000;fill-opacity:1;stroke:none;display:inline"
       x="423.10577"
       y="71.987328"
       id="text6638-1-0-0"
       sodipodi:linespacing="125%"
       transform="matrix(0.99914114,0.04143658,-0.04143658,0.99914114,0,0)"
       inkscape:transform-center-x="9.5788302"
       inkscape:transform-center-y="2.8736491"><tspan
         sodipodi:role="line"
         id="tspan6640-44-1-6"
         x="423.10577"
         y="71.987328">foaf:familyName</tspan></text>
    <text
       xml:space="preserve"
       style="font-size:10px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;letter-spacing:0px;word-spacing:0px;text-anchor:start;fill:#000000;fill-opacity:1;stroke:none;display:inline;font-family:Impact;-inkscape-font-specification:Sans"
       x="439.22638"
       y="95.05265"
       id="text6778-6-7-8"
       sodipodi:linespacing="125%"><tspan
         sodipodi:role="line"
         id="tspan6780-5-9-7"
         x="439.22638"
         y="95.05265">Jones</tspan></text>
    <rect
       style="fill:none;stroke:#000000;stroke-width:1;stroke-linejoin:round;stroke-miterlimit:0;stroke-opacity:1;stroke-dasharray:none;stroke-dashoffset:0;display:inline"
       id="rect7302-7-1"
       width="29.454897"
       height="14.248512"
       x="436.1647"
       y="84.15609"
       ry="0" />
  </g>
</svg>

          <p>
            The rest of this document shows shapes which describe the issue data consumable by some application, including the submitter and the person to which the issue is assigned.
            Examples include data, both conforming and not.
            <!-- Some mechanisms by which the instance data may be associated with, or validated against the a shape are descibed later in <a href="#associations">Associating Data with Shapes</a>. -->
          </p>

          <section id="associating-nodes-with-shapes">
            <h3>Associating Nodes with Shapes</h3>
            <p>
              The semantics of ShEx are defined in terms of validating a node in some graph as a shape some schema.
              Here are a few ways one might associate nodes with shapes:
            </p>

            <ul>
              <li>
                <span class="new">API invocation</span> - select pass node/shape pairs to a function for validation. This can be used via:
                <ul>
                  <li>
                    <span class="new">user interface</span> - a user selects nodes and shapes via a graphical, textual or command-line interface
                  </li>
                  <li>
                    <span class="new">programatic interface</span> - databases or agents emitting or recieving data discover nodes from a protocol, SPARQL query, or hard-coded node identifers.
                  </li>
                </ul>
              </li>
              <li>
                <span class="new">Maximal typing</span> - test every node in a graph against every shape in a schema.
              </li>
              <li>
                <span class="new">SHACL target* properties</span> - validation process selects node/shape pairs from data graph based on SHACL target* properties in a separate control graph.
                <ul>
                  <li>
                    <span class="new">sh:targetNode</span> - (S1, sh:targetNode, N1) asserts that node N1 shoule pass shape S1.
                  </li>
                  <li>
                    <span class="new">sh:</span> - (S1, sh:targetClass, T1) asserts that any node with type T1 shoule pass shape S1.
                  </li>
                  <li>
                    <span class="new">sh:targetSubjectsOf</span> - (S1, sh:targetSubjectsOf, P1) asserts that any node with a P1 property shoule pass shape S1.
                  </li>
                  <li>
                    <span class="new">sh:targetObjectsOf</span> - (S1, sh:targetObjectsOf, P1) asserts that any node object of a P1 property shoule pass shape S1.
                  </li>
                </ul>
              </li>
            </ul>
          </section>

      </section>

      <section id="tripleConstraints">
        <h2>Constraining Triples</h2>
        <div class="namespace">
        <p>
          ShEx's facilities for describing the structure of graphs are based on rules that describe triples in a graph.
          These rules are evaluated against particular nodes in the instance data; these are called <code>focus nodes</code>.
          Each rule identifies a predicate and describes the expected triples with the <code>focus node</code> as a subject and the corresponding predicate.
          These descriptions include how many such triples are required/permitted, and what kinds of objects are expected.
        </p>

        <p>
          The rules can be written in ShExC or JSON (recall that you can press 'c' or 'j') as a set of properties on a <code>triple constraint</code>.
          This example consists of a single <code id="shape-declaration">shape declaration</code> for a shape called <span class="shape-name hilight-shapeName lowlight2 top bot">my:UserShape</span>.
          A validation process tests selected nodes in the instance data, <code>focus nodes</code>, against this shape.
          The shape in this example consists of a single <code class="hilight-tripleConstraint lowlight1 top bot">triple constraint</code> on the property <span class="predicate hilight-predicate lowlight2 top bot">foaf:name</span>.
          The only <code>value-constraint</code> in this example is that the object of any <span class="predicate">foaf:name</span> triple must be an RDF literal with a datatype of <span class="value-constraint hilight-valueConstraint lowlight2 top bot">xsd:string</span>.
        </p>

        <div id="my:UserShape-1" class="example wrapper">
          <!-- ShExC example -->
          <pre class="schema shexc"><span class="comment"># schema (ShExC)</span>
<span class="shape-name hilight-shapeName lowlight2 top bot">my:UserShape</span> {
  <span class="hilight-tripleConstraint lowlight1 top bot"><span class="predicate hilight-predicate lowlight2 top bot">foaf:name</span> <span class="value-constraint hilight-valueConstraint lowlight2 top bot">xsd:string</span></span>
}</pre>

          <!-- JSON example -->
          <pre class="schema json"><span class="comment">// schema (JSON)</span>
{
  <span class="shape-name hilight-shapeName lowlight2 top bot">my:UserShape</span>: {
    "type": "Shape",
    "expression": {
     <span class="hilight-tripleConstraint lowlight1 top"> "type": "TripleConstraint",</span>
     <span class="hilight-tripleConstraint lowlight1    "> <span class="predicate hilight-predicate lowlight2 top bot">"predicate": "foaf:name"</span>,  </span>
     <span class="hilight-tripleConstraint lowlight1    "> <span class="value-constraint hilight-valueConstraint lowlight2 top">"value": {                </span> </span>
     <span class="hilight-tripleConstraint lowlight1    "> <span class="value-constraint hilight-valueConstraint lowlight2    ">  "type": "NodeConstraint",   </span> </span>
     <span class="hilight-tripleConstraint lowlight1    "> <span class="value-constraint hilight-valueConstraint lowlight2    ">  "datatype": "xsd:string"</span> </span>
     <span class="hilight-tripleConstraint lowlight1 bot"> <span class="value-constraint hilight-valueConstraint lowlight2 bot">}                         </span> </span>
    }
  }
}</pre>

          <p>
            A conforming node in an RDF graph would have exactly one <span class="type">foaf:</span><span class="constant">name</span> property and we expect to have a datatype of <span class="string">xsd:string</span>.
            Regular expression conventions are used to specify cardinality:
          </p>
          <ul>
            <li>"<span class="new">+</span>" - one or more</li>
            <li>"<span class="new">*</span>" - zero or more</li>
            <li>"<span class="new">?</span>" - zero or one</li>
            <li>"<span class="new">{m}</span>" - exactly m</li>
            <li>"<span class="new">{m,n}</span>" - at least m, no more than n</li>
            <li>"" (none of the above) - exactly one.</li>
          </ul>
          <p>
            We assume you have identified the nodes you wish to validate as some shape.
            The node <span id="inst:User1-1" class="function-name">inst:User1</span> in the following graph conforms to this simple shape:
          </p>

          <pre class="instance turtle"><span class="comment"># passing data</span>
<span id="inst:User1-1" class="function-name">inst:User1</span>
    <span class="name lowlight1 top bot"><span class="type">foaf:</span><span class="constant">name</span>  <span class="string top bot">"Bob Smith"^^xsd:string</span></span> .</pre>

          <p>
            Nodes with the wrong number of <span class="type">foaf:</span><span class="constant">name</span> properties or with <span class="type">foaf:</span><span class="constant">name</span> properties that were not of datatype <span class="string">xsd:string</span> do not match the shape <span class="shape-name hilight-shapeName lowlight2 top bot">my:UserShape</span>:
          </p>

          <pre class="instance turtle fail"><span class="comment"># failing data</span>
<span id="inst:User2-1" class="function-name">inst:User2</span>
    <span class="gname lowlight1 top bot"><span class="type">foaf:</span><span class="constant">name</span>  <span class="string top bot">"Joe Jones"^^xsd:string</span></span> ;
    <span class="errorSite">foaf:name  "Joseph Jones"^^xsd:string</span> .

<span id="inst:User3-1" class="function-name">inst:User3</span>
    <span class="gname lowlight1 top bot"><span class="type">foaf:</span><span class="constant">name</span>  <span class="string top bot">"Bob Smith"^^<span class="errorSite">xsd:anyURI</span></span></span> .</pre>

          <p>Note that in Turtle (and other RDF representations), literals expressed with no datatype are interpreted as being of type <code cass="string">xsd:string</code> so the following is also valid data:</p>
          <pre class="instance turtle"><span class="comment"># passing data</span>
<span class="function-name">inst:User1</span>
    <span class="name lowlight1 top bot"><span class="type">foaf:</span><span class="constant">name</span>  <span class="string top bot">"Bob Smith"</span></span> .</pre>
          </div>

        </div>

        <script type="text/javascript">
        <!--
prepareHighlight(["hilight-shapeName", "hilight-predicate", "hilight-valueConstraint", "hilight-focusNodes"], "highlight2", "lowlight2");
prepareHighlight(["hilight-tripleConstraint"], "highlight1", "lowlight1");
        -->
        </script>
      </section>

      <section id="simple-expressions">
        <h2>Constraining Groups of Triples</h2>
        <div class="namespace">
        <p>
          The above examples include only a single <code>Triple Constraint</code> in each shape.
          Most realistic shape declarations will include multiple constraints.
          In ShExC, triple constraints are separated by a ';'.
        </p>
        <div class="example wrapper">
        <pre class="schema shexc"><span class="shape-name">my:IssueShape</span> {
  <span class="predicate">ex:state</span> <span class="value-constraint">[ex:unassigned ex:assigned]</span>;
  <span class="predicate">ex:reportedBy</span> <span class="value-constraint">@my:UserShape</span>
}</pre>
        </div>
        <p>
          To illustrate this, we can declare a schema for the data described in the <a href="#introduction">introduction</a>.
          (Mousing over the the following list items items will highlight the corresponding elements in the example text.)
          Our first example issue must doesn't include <span class="type">ex:</span><span class="constant">reproducedBy</span> as illustrated in the image above, but it must have:
        </p>

      <ul>
        <li class="state lowlight1 top bot">exactly one <span id="state" class="predicate">ex:state</span> with a value in the <code>value set</code> <span class="stateValue lowlight2 top bot value-constraint">ex:unassigned or ex:assigned</span>,</li>
        <li class="reportedBy lowlight1 top bot">exactly one <span id="mbox" class="predicate">ex:reportedBy</span> which references a user, here expressed as a <code>value shape</code> referencing <span class="user lowlight2 top bot value-constraint">my:UserShape</span>.</li>
      </ul>

      <p>
        The user referenced by the <span class="predicate">ex:reportedBy</span> property must have:
      </p>

      <ul>
        <li class="name lowlight1 top bot">exactly one <span id="name" class="predicate">foaf:name</span> with a <code>literal datatype</code> of <span class="string lowlight2 top bot"><span class="value-constraint">xsd:string</span></span></li>
        <li class="mbox lowlight1 top bot"><span class="oneOrMore lowlight2 top bot" id="oneOrMore">one or more</span> <span id="mbox" class="predicate">foaf:mbox</span>es with a <code>node kind</code> of <span class="IRI lowlight2 top bot value-constraint" id="IRI">IRI</span>.</li>
      </ul>

        <div id="simple-expressions-example-1" class="example wrapper">
          <!-- ShExC example -->
          <pre class="schema shexc" style="float:left;"><span class="comment"># schema (ShExC)</span>
<span class="shape-name hilight-shapeName lowlight2 top bot">my:IssueShape</span> {
  <span class="state      lowlight1 top bot"><span class="predicate">ex:state</span> [<span class="stateValue lowlight2 top bot value-constraint">ex:unassigned ex:assigned</span>]</span>;
  <span class="reportedBy lowlight1 top bot"><span class="predicate">ex:reportedBy</span> <span class="value-constraint">@</span><span class="user lowlight2 top bot shape-name">my:UserShape</span></span>
}

<span class="user lowlight2 top bot shape-name">my:UserShape</span> {
  <span class="name       lowlight1 top bot"><span class="predicate">foaf:name</span> <span class="string lowlight2 top bot value-constraint">xsd:string</span></span>;
  <span class="mbox       lowlight1 top bot"><span class="predicate">foaf:mbox</span> <span class="IRI lowlight2 top bot value-constraint">IRI</span><span class="oneOrMore lowlight2 top bot">+</span></span>
}</pre>

          <!-- JSON example -->
          <pre class="schema json" style="float:left;"><span class="comment">// schema (JSON)</span>
{ "type": "Schema",
  "shapes": {
    <span class="shape-name hilight-shapeName lowlight2 top bot">"my:IssueShape"</span>: { "type": "Shape",
      "expression": { "type": "group",
        "expressions": [
          <span class="state      lowlight1 top">{ "type": "TripleConstraint",                   </span>
          <span class="state      lowlight1    ">  <span class="predicate">"predicate": "ex:state"</span>,                      </span>
          <span class="state      lowlight1    ">  <span class="value-constraint">"value": { "type": "NodeConstraint",              </span></span>
          <span class="state      lowlight1    ">  <span class="value-constraint">  "values": [ <span class="stateValue lowlight2 top bot value-constraint">"ex:unassigned", "ex:assigned"</span> ]</span></span>
          <span class="state      lowlight1    ">  <span class="value-constraint">}                                             </span></span>
          <span class="state      lowlight1 bot">},                                              </span>
          <span class="reportedBy lowlight1 top">{ "type": "TripleConstraint",                   </span>
          <span class="reportedBy lowlight1    ">  <span class="predicate">"predicate": "ex:reportedBy"</span>,                 </span>
          <span class="reportedBy lowlight1    ">  <span class="value-constraint">"value": { "type": "ShapeRef",</span>              </span>
          <span class="reportedBy lowlight1    ">  <span class="value-constraint">  "reference": <span class="user lowlight2 top bot">"my:UserShape"</span></span>                 </span>
          <span class="reportedBy lowlight1    ">  <span class="value-constraint">}              </span>                               </span>
          <span class="reportedBy lowlight1 bot">}                                               </span>
        ]
      }
    },
    <span class="user lowlight2 top bot">"my:UserShape"</span>: { "type": "Shape",
      "expression": { "type": "group",
        "expressions": [
          <span class="name       lowlight1 top">{ "type": "TripleConstraint",                   </span>
          <span class="name       lowlight1    ">  <span class="predicate">"predicate": "foaf:name"</span>,                     </span>
          <span class="name       lowlight1    ">  <span class="value-constraint">"value": {             </span>                       </span>
          <span class="name       lowlight1    ">  <span class="value-constraint">  "type": "NodeConstraint",</span>                       </span>
          <span class="name       lowlight1    ">  <span class="value-constraint">  "datatype": <span class="string lowlight2 top bot">"xsd:string"</span></span>                    </span>
          <span class="name       lowlight1    ">  <span class="value-constraint">}                      </span>                       </span>
          <span class="name       lowlight1 bot">},                                              </span>
          <span class="mbox       lowlight1 top">{ "type": "TripleConstraint",                   </span>
          <span class="mbox       lowlight1    ">  <span class="predicate">"predicate": "foaf:mbox"</span>,                     </span>
          <span class="mbox       lowlight1    ">  <span class="value-constraint">"value": { "type": "NodeConstraint",</span>              </span>
          <span class="mbox       lowlight1    ">  <span class="value-constraint">  "nodeKind": <span class="IRI lowlight2 top bot">"iri"</span>             </span>              </span>
          <span class="mbox       lowlight1    ">  <span class="value-constraint">},                                            </span></span>
          <span class="mbox       lowlight1    ">  <span class="value-constraint oneOrMore lowlight2 top bot">"min": 1, "max": "*"</span>                          </span>
          <span class="mbox       lowlight1 bot">}                                               </span>
        ]
      }
    }
  }
}</pre>
          <div class="verticalDivider"><!-- acts as a divider --></div>
          <div style="float:left;">
          <pre class="instance turtle"><span class="comment"># passing data</span>
<span class="keyword">PREFIX</span> <span class="type">ex:</span> <span class="function-name">http://ex.example/#</span><span class="comment">
</span><span class="keyword">PREFIX</span> <span class="type">foaf:</span> <span class="function-name">http://xmlns.com/foaf/</span>
<span class="keyword">PREFIX</span> <span class="type">xsd:</span> <span class="function-name">http://www.w3.org/2001/XMLSchema#</span><span class="comment">
</span>
<span class="function-name">inst:Issue1</span> <span class="keyword">a</span> <span class="type">ex:</span><span class="constant">Issue</span> ;
    <span class="state lowlight1 top bot"><span class="type">ex:</span><span class="constant">state</span>        <span class="stateValue lowlight2 top bot"><span class="type">ex:</span><span class="constant">unassigned</span></span></span> ;
    <span class="reportedBy lowlight1 top bot"><span class="type">ex:</span><span class="constant">reportedBy</span>   <span class="user lowlight2 top bot"><span class="function-name">inst:User2</span></span></span> .

<span class="user lowlight2 top bot"><span class="function-name">inst:User2</span></span> <span class="keyword">a</span> <span class="type">foaf:</span><span class="constant">Person</span> ;
    <span class="name lowlight1 top bot"><span class="type">foaf:</span><span class="constant">name</span>       <span class="string top bot">"Bob Smith"</span></span> ;
    <span class="mbox lowlight1 top"><span class="oneOrMore lowlight2 top"><span class="type">foaf:</span><span class="constant">mbox</span></span>       <span class="IRI lowlight2 top"><span class="fullURL">&lt;mailto:bob@example.org&gt;</span><span class="keyword"></span></span></span> ;
    <span class="mbox lowlight1 bot"><span class="oneOrMore lowlight2 bot"><span class="type">foaf:</span><span class="constant">mbox</span></span>       <span class="IRI lowlight2 bot"><span class="fullURL">&lt;mailto:rs@example.org&gt;</span> <span class="keyword"></span></span></span>.</pre>
          <pre class="instance turtle fail"><span class="comment"># failing data</span>
<span class="keyword">PREFIX</span> <span class="type">ex:</span> <span class="function-name">http://ex.example/#</span><span class="comment">
</span><span class="keyword">PREFIX</span> <span class="type">foaf:</span> <span class="function-name">http://xmlns.com/foaf/</span>
<span class="keyword">PREFIX</span> <span class="type">xsd:</span> <span class="function-name">http://www.w3.org/2001/XMLSchema#</span><span class="comment">
</span>
<span class="function-name">inst:Issue3</span> <span class="keyword">a</span> <span class="type">ex:</span><span class="constant">Issue</span> ;
    <span class="state lowlight1 top bot"><span class="type">ex:</span><span class="constant">state</span>        <span class="stateValue lowlight2 top bot"><span class="type">ex:</span><span class="constant errorSite">unsinged</span></span></span> ;
    <span class="reportedBy lowlight1 top bot"><span class="type">ex:</span><span class="constant">reportedBy</span>   <span class="user lowlight2 top bot"><span class="function-name">inst:User4</span></span></span> .

<span class="user lowlight2 top bot"><span class="function-name">inst:User4</span></span> <span class="keyword">a</span> <span class="type">foaf:</span><span class="constant">Person</span> ;
    <span class="name lowlight1 top bot"><span class="type">foaf:</span><span class="constant">name</span>       <span class="string top bot">"Bob Smith"</span>, <span class="string top bot errorSite">"Robert Smith"</span></span> ;
    <span class="mbox lowlight1 top"><span class="oneOrMore lowlight2 top"><span class="type">foaf:</span><span class="constant">mbox</span></span>       <span class="IRI lowlight2 top"><span class="fullURL">&lt;mailto:bob@example.org&gt;</span><span class="keyword"></span></span></span> ;
    <span class="mbox lowlight1 bot"><span class="oneOrMore lowlight2 bot"><span class="type">foaf:</span><span class="constant">mbox</span></span>       <span class="IRI lowlight2 bot"><span class="fullURL">&lt;mailto:rs@example.org&gt;</span> <span class="keyword"></span></span></span>.</pre>
  </div>
          <div style="clear:both;"></div>
      </div>
      <script type="text/javascript">
      <!--
prepareHighlight(["oneOrMore", "IRI", "stateValue", "user", "string"], "highlight2", "lowlight2");
prepareHighlight(["state", "reportedBy", "name", "mbox"], "highlight1", "lowlight1");
      -->
      </script>
      </div>
      <p>
        In the top example, <span class="function-name">inst:Issue1</span> conforms to <span class="function-name">my:IssueShape</span> because every predicate identified in <span class="function-name">my:IssueShape</span> corresponds to a triple with a subject of <span class="function-name">inst:Issue1</span>.
      </p>
      <ul>
        <li>The first property restriction in <span class="function-name">my:IssueShape</span> asserts that the object of the <span class="type">ex:</span><span class="constant">state</span> must have one of two values: <span class="type">ex:</span><span class="constant">unassigned</span> or <span class="type">ex:</span><span class="constant">assigned</span>.</li>
        <li>The second property restriction asserts that the object of the <span class="type">ex:</span><span class="constant">reportedBy</span> arc (<span class="function-name">inst:User2</span>) must match the <span class="function-name">my:UserShape</span> shape.</li>
        <li>The first property restriction in <span class="function-name">my:userShape</span> requires the object of the <span class="type">foaf:</span><span class="constant">name</span> to be an <a href="http://www.w3.org/TR/rdf11-concepts/#dfn-language-tagged-string">RDF language-tagged string</a> with a datatype of <span class="type">xsd:</span><span class="constant">string</span>.</li>
        <li>The final property restriction asserts that the object of <span class="type">foaf:</span><span class="constant">mbox</span> be an <a href="http://www.w3.org/TR/rdf11-concepts/#dfn-iri">RDF IRI</a>.</li>
      </ul>

      <p id="empty-shape">
        Because triple expressions can have a minimum cardinality of zero, it's possible to create a shape which matches any node, even if it does not appear in the data:
      </p>
      <pre class="schema shexc">my:IssueShape {
  ex:state [ex:unassigned ex:assigned] <span class="keyword">?</span>;
  ex:reportedBy @my:UserShape <span class="keyword">*</span>
}</pre>
      <p>
        Because the minimum number of triples is zero, any RDF node will match this shape.
      </p>
    </section>

      <section id="combined-constraints">
        <h3>Combining Value Constraints</h3>
        <div class="namespace">
          <p>
            So far, the examples have all included exactly one value constraint.
            In fact, they can be combined in sensible combinations.
            For example, imagine that we want to assert that the issue is identified by an IRI matching a certain pattern, and conforming to a particular shape.
          </p>

          <div class="example wrapper">
            <!-- ShExC example -->
            <pre class="schema shexc" style="float:left;"><span class="comment"># schema (ShExC)</span>
<span class="shape-name">my:IssueShape</span> {
  <span class="predicate">ex:state</span> [<span class="value-constraint">ex:accepted ex:resolved</span>];
  <span class="predicate">ex:reproducedBy</span> <span class="hilight-reproducedBy lowlight2 top bot new"><span class="value-constraint">IRI @<span class="shape-name">my:EmployeeShape</span>
    /<span class="string">^http:\/\/hr.example/id#[0-9]+</span>/</span></span>
}

<span class="hilight-reproducedBy lowlight2 top"><span class="shape-name">my:EmployeeShape</span> {                        </span>
<span class="hilight-reproducedBy lowlight2    ">  <span class="predicate">foaf:name</span> <span class="value-constraint">xsd:string</span>;                   </span>
<span class="hilight-reproducedBy lowlight2    ">  <span class="predicate">ex:department</span> [<span class="value-constraint">ex:ProgrammingDepartment</span>]</span>
<span class="hilight-reproducedBy lowlight2 bot">}                                         </span>
</pre>

            <!-- JSON example -->
            <pre class="schema json" style="float:left;"><span class="comment">// schema (JSON)</span>
{
  "my:IssueShape": { "type": "Shape",
    "expression": { "type": "group",
      "expressions": [
        { "type": "TripleConstraint", <span class="predicate">"predicate": "ex:state"</span>,
          <span class="value-constraint">"value": { "type": "NodeConstraint", "values": [ "ex:accepted", "ex:resolved" ]</span> }
        },
        { "type": "TripleConstraint", <span class="predicate">"predicate": "ex:reproducedBy"</span>,
          <span class="value-constraint">"value": { "type": "ShapeRef", <span class="hilight-reproducedBy lowlight2 top bot">"reference": "my:TesterShape"</span></span> }
        }
      ]
    }
  },
  <span class="hilight-reproducedBy lowlight2 top">"my:EmployeeShape": { "type": "Shape",                                   </span>
  <span class="hilight-reproducedBy lowlight2    ">  "expression": { "type": "group",                                       </span>
  <span class="hilight-reproducedBy lowlight2    ">    "expressions": [                                                     </span>
  <span class="hilight-reproducedBy lowlight2    ">      { "type": "TripleConstraint", <span class="predicate">"predicate": "foaf:name"</span>,            </span>
  <span class="hilight-reproducedBy lowlight2    ">        <span class="value-constraint">"value": { "type": "NodeConstraint", "datatype": "xsd:string" }</span>      </span>
  <span class="hilight-reproducedBy lowlight2    ">      },                                                                 </span>
  <span class="hilight-reproducedBy lowlight2    ">      { "type": "TripleConstraint", <span class="predicate">"predicate": "ex:department"</span>,        </span>
  <span class="hilight-reproducedBy lowlight2    ">        <span class="value-constraint">"value": { "type": "NodeConstraint", "values": [ "ex:Programming" ] }</span></span>
  <span class="hilight-reproducedBy lowlight2    ">      }                                                                  </span>
  <span class="hilight-reproducedBy lowlight2    ">    ]                                                                    </span>
  <span class="hilight-reproducedBy lowlight2    ">  }                                                                      </span>
  <span class="hilight-reproducedBy lowlight2 bot">}                                                                        </span>
}</pre>
            <div class="verticalDivider"><!-- acts as a divider --></div>
            <div style="float:left;">
              <pre class="instance turtle"><span class="comment"># passing data</span>
<span class="type">inst:</span><span class="constant">Issue1</span>
  <span class="type">ex:</span><span class="constant">state</span> <span class="type">ex:</span><span class="constant">accepted</span> ;
  <span class="type">ex:</span><span class="constant">reproducedBy</span> <span class="hilight-reproducedBy lowlight2 top bot"><span class="function-name">http://hr.example/id#123</span></span> .

<span class="hilight-reproducedBy lowlight2 top"><span class="function-name">http://hr.example/id#123</span>                  </span>
<span class="hilight-reproducedBy lowlight2    ">  <span class="type">foaf:</span><span class="constant">name</span> <span class="type">xsd:</span><span class="constant">string</span> ;                  </span>
<span class="hilight-reproducedBy lowlight2 bot">  <span class="type">ex:</span><span class="constant">department</span> <span class="type">ex:</span><span class="constant">ProgrammingDepartment</span> .</span></pre>
              <div></div>
              <pre class="instance turtle fail"><span class="comment"># failing data</span>
<span class="type">inst:</span><span class="constant">Issue1</span>
  <span class="type">ex:</span><span class="constant">state</span> <span class="type">ex:</span><span class="constant">accepted</span> ;
  <span class="type">ex:</span><span class="constant">reproducedBy</span> <span class="hilight-reproducedBy lowlight2 top bot"><span class="function-name">http://hr.example/id#<span class="errorSite">abc</span></span></span> .

<span class="hilight-reproducedBy lowlight2 top"><span class="function-name">http://hr.example/id#abc</span>                  </span>
<span class="hilight-reproducedBy lowlight2    ">  <span class="type">foaf:</span><span class="constant">name</span> <span class="type">xsd:</span><span class="constant">string</span> ;                  </span>
<span class="hilight-reproducedBy lowlight2 bot">  <span class="type">ex:</span><span class="constant">department</span> <span class="type">ex:</span><span class="constant">ProgrammingDepartment</span> .</span></pre>
            </div>

            <script type="text/javascript">
            <!--
prepareHighlight(["hilight-reproducedBy", "hilight-assignedTo"], "highlight2", "lowlight2");
            -->
            </script>
          </div>
        </div>
      </section>

      <section id="nested-shapes">
        <h3>Nesting Shapes</h3>
        <p>
          In the examples so far, every shape has had an IRI or a blank node for a label.
          Every shape in ShEx has some label.
          It is possible to write ShExC without a label, in which case the label is a fresh blank node, different from every other blank node in your schema.
        </p>
        <div class="namespace">
          <p>
            InShExC, the <a href="#simple-expressions-example-1">example in Simple Expressions</a> could be rewritten with the <span class="shape-name IssueShape lowlight2 top bot">my:IssueShape</span> embedded inline in <span class="curlies lowlight2 top bot">"{}"s</span>.
            The JSON representation of ShEx has no corresponding shortcut; it has instead a reference to a shape whose label is a <span class="bnode lowlight2 top bot">blank node allocated by the parser</span>.
          </p>
          <div id="nested-shapes-example-1" class="example wrapper">
            <!-- ShExC example -->
            <pre class="schema shexc"><span class="comment"># schema (ShExC)</span>
<span class="shape-name IssueShape lowlight2 top bot">my:IssueShape</span> {
  <span class="predicate">ex:state</span> [<span class="value-constraint">ex:unassigned ex:assigned</span>];
  <span class="predicate">ex:reportedBy</span> <span class="curlies lowlight2 top bot">{</span>
    <span class="predicate">foaf:name</span> <span class="value-constraint">xsd:string</span>;
    <span class="predicate">foaf:mbox</span> <span class="value-constraint">IRI</span><span class="keyword">+</span>
  <span class="curlies lowlight2 top bot">}</span>
}</pre>

          <!-- JSON example -->
            <pre class="schema json"><span class="comment">// schema (JSON)</span>
{ "type": "Schema",
  "shapes": {
    <span class="shape-name IssueShape lowlight2 top bot">"my:IssueShape"</span>: { "type": "Shape",
      "expression": { "type": "group",
        "expressions": [
          { "type": "TripleConstraint",                   
            <span class="predicate">"predicate": "ex:state"</span>,                      
            <span class="value-constraint">"value": { "type": "NodeConstraint",              </span>
            <span class="value-constraint">  "values": [ <span class="value-constraint">"ex:unassigned", "ex:assigned"</span> ]</span>
            <span class="value-constraint">}                                             </span>
          },                                              
          { "type": "TripleConstraint",                   
            <span class="predicate">"predicate": "ex:reportedBy"</span>,                 
            <span class="value-constraint">"value": { "type": "ShapeRef",</span>              
            <span class="value-constraint">  "reference": <span class="bnode lowlight2 top bot">"_:b1"</span></span>                 
            <span class="value-constraint">}              </span>                               
          }                                               
        ]
      }
    },
    <span class="bnode lowlight2 top bot">"_:b1"</span>: { "type": "Shape",
      "expression": { "type": "group",
        "expressions": [
          { "type": "TripleConstraint",                   
            <span class="predicate">"predicate": "foaf:name"</span>,                     
            <span class="value-constraint">"value": {             </span>                       
            <span class="value-constraint">  "type": "NodeConstraint",</span>                       
            <span class="value-constraint">  "datatype": "xsd:string"</span>                    
            <span class="value-constraint">}                      </span>                       
          },                                              
          { "type": "TripleConstraint",                   
            <span class="predicate">"predicate": "foaf:mbox"</span>,                     
            <span class="value-constraint">"value": { "type": "NodeConstraint",</span>              
            <span class="value-constraint">  "nodeKind": "iri"             </span>              
            <span class="value-constraint">},                                            
            "min": 1, "max": "*"           </span>               
          }                                               
        ]
      }
    }
  }
}</pre>
          </div>
          <script type="text/javascript">
          <!--
    prepareHighlight(["bnode", "curlies", "IssueShape"], "highlight2", "lowlight2");
          -->
          </script>
        </div>
      </section>

    <section id="choices">
      <h2>Expressions with Choices</h2>
      <p>
        Most schema language offer a way to express choices.
        We can extend our first example to include a more flexible user which includes given and family names.
      </p>

<!-- svg fill-opacity="0" xmlns:xlink="http://www.w3.org/1999/xlink" color-rendering="auto" color-interpolation="auto" stroke="rgb(0,0,0)" text-rendering="auto" stroke-linecap="square" width="466" stroke-miterlimit="10" stroke-opacity="0" shape-rendering="auto" fill="rgb(0,0,0)" stroke-dasharray="none" font-weight="normal" stroke-width="1" height="151" xmlns="http://www.w3.org/2000/svg" font-family="&apos;Dialog&apos;" font-style="normal" stroke-linejoin="miter" font-size="12" stroke-dashoffset="0" image-rendering="auto"
><defs id="genericDefs"
  /><g
  ><defs id="defs1"
    ><linearGradient x1="65" gradientUnits="userSpaceOnUse" x2="65" y1="100" y2="0" id="linearGradient1" spreadMethod="reflect"
      ><stop stop-opacity="1" stop-color="rgb(118,148,200)" offset="0%"
        /><stop stop-opacity="1" stop-color="rgb(238,243,251)" offset="100%"
      /></linearGradient
      ><linearGradient x1="85" gradientUnits="userSpaceOnUse" x2="85" y1="100" y2="0" id="linearGradient2" spreadMethod="reflect"
      ><stop stop-opacity="1" stop-color="rgb(118,148,200)" offset="0%"
        /><stop stop-opacity="1" stop-color="rgb(238,243,251)" offset="100%"
      /></linearGradient
      ><clipPath clipPathUnits="userSpaceOnUse" id="clipPath1"
      ><path d="M-7 -7 L141 -7 L141 111 L-7 111 L-7 -7 Z"
      /></clipPath
      ><clipPath clipPathUnits="userSpaceOnUse" id="clipPath2"
      ><path d="M0 0 L0 85 L130 85 L130 0 Z"
      /></clipPath
      ><clipPath clipPathUnits="userSpaceOnUse" id="clipPath3"
      ><path d="M0 0 L130 0 L130 15 L0 15 L0 0 Z"
      /></clipPath
      ><clipPath clipPathUnits="userSpaceOnUse" id="clipPath4"
      ><path d="M-7 -7 L181 -7 L181 111 L-7 111 L-7 -7 Z"
      /></clipPath
      ><clipPath clipPathUnits="userSpaceOnUse" id="clipPath5"
      ><path d="M0 0 L0 85 L170 85 L170 0 Z"
      /></clipPath
      ><clipPath clipPathUnits="userSpaceOnUse" id="clipPath6"
      ><path d="M0 0 L170 0 L170 15 L0 15 L0 0 Z"
      /></clipPath
      ><clipPath clipPathUnits="userSpaceOnUse" id="clipPath7"
      ><path d="M-7 -7 L48 -7 L48 26 L-7 26 L-7 -7 Z"
      /></clipPath
      ><clipPath clipPathUnits="userSpaceOnUse" id="clipPath8"
      ><path d="M0 0 L37 0 L37 15 L0 15 L0 0 Z"
      /></clipPath
      ><clipPath clipPathUnits="userSpaceOnUse" id="clipPath9"
      ><path d="M-7 -7 L50 -7 L50 26 L-7 26 L-7 -7 Z"
      /></clipPath
      ><clipPath clipPathUnits="userSpaceOnUse" id="clipPath10"
      ><path d="M0 0 L39 0 L39 15 L0 15 L0 0 Z"
      /></clipPath
      ><clipPath clipPathUnits="userSpaceOnUse" id="clipPath11"
      ><path d="M-7 -7 L37 -7 L37 27 L-7 27 L-7 -7 Z"
      /></clipPath
      ><clipPath clipPathUnits="userSpaceOnUse" id="clipPath12"
      ><path d="M0 0 L26 0 L26 16 L0 16 L0 0 Z"
      /></clipPath
      ><clipPath clipPathUnits="userSpaceOnUse" id="clipPath13"
      ><path d="M-7 -7 L47 -7 L47 26 L-7 26 L-7 -7 Z"
      /></clipPath
      ><clipPath clipPathUnits="userSpaceOnUse" id="clipPath14"
      ><path d="M0 0 L36 0 L36 15 L0 15 L0 0 Z"
      /></clipPath
      ><clipPath clipPathUnits="userSpaceOnUse" id="clipPath15"
      ><path d="M-7 -7 L49 -7 L49 26 L-7 26 L-7 -7 Z"
      /></clipPath
      ><clipPath clipPathUnits="userSpaceOnUse" id="clipPath16"
      ><path d="M0 0 L38 0 L38 15 L0 15 L0 0 Z"
      /></clipPath
      ><clipPath clipPathUnits="userSpaceOnUse" id="clipPath17"
      ><path d="M0 0 L171 0 L171 52 L0 52 L0 0 Z"
      /></clipPath
      ><clipPath clipPathUnits="userSpaceOnUse" id="clipPath18"
      ><path d="M0 0 L162 0 L162 112 L0 112 L0 0 Z"
      /></clipPath
      ><clipPath clipPathUnits="userSpaceOnUse" id="clipPath19"
      ><path d="M-77 -15 L154 -15 L154 30 L-77 30 L-77 -15 Z"
      /></clipPath
      ><clipPath clipPathUnits="userSpaceOnUse" id="clipPath20"
      ><path d="M-92 -15 L184 -15 L184 30 L-92 30 L-92 -15 Z"
      /></clipPath
      ><clipPath clipPathUnits="userSpaceOnUse" id="clipPath21"
      ><path d="M-57 -15 L114 -15 L114 30 L-57 30 L-57 -15 Z"
      /></clipPath
    ></defs
    ><g fill="white" text-rendering="geometricPrecision" fill-opacity="1" stroke-opacity="1" stroke="white"
    ><rect x="0" width="466" height="151" y="0" stroke="none"
    /></g
    ><g font-size="11" transform="translate(332,2)" fill-opacity="1" fill="url(#linearGradient1)" text-rendering="geometricPrecision" font-family="sans-serif" stroke="url(#linearGradient1)" font-weight="bold" stroke-opacity="1"
    ><rect x="0" width="130" height="100" y="0" clip-path="url(#clipPath1)" stroke="none"
    /></g
    ><g font-size="11" stroke-linecap="butt" transform="translate(332,2)" fill-opacity="1" fill="black" text-rendering="geometricPrecision" font-family="sans-serif" stroke-linejoin="round" stroke="black" font-weight="bold" stroke-opacity="1" stroke-miterlimit="0"
    ><rect fill="none" x="0" width="130" height="100" y="0" clip-path="url(#clipPath1)"
      /><line y2="15" fill="none" x1="0" clip-path="url(#clipPath1)" x2="130" y1="15"
    /></g
    ><g font-size="11" transform="matrix(1,0,0,1,332,17)" fill-opacity="1" fill="black" text-rendering="geometricPrecision" font-family="sans-serif" stroke="black" stroke-opacity="1"
    ><text x="2" xml:space="preserve" y="14" clip-path="url(#clipPath2)" stroke="none"
      > :name : xsd:string</text
    ></g
    ><g font-size="11" transform="matrix(1,0,0,1,332,17)" fill-opacity="1" fill="black" text-rendering="geometricPrecision" font-family="sans-serif" stroke="black" stroke-opacity="1"
    >
<text x="2" xml:space="preserve" y="29" clip-path="url(#clipPath2)" stroke="none"
      > :givenName : xsd:string</text
      ><text x="2" xml:space="preserve" y="44" clip-path="url(#clipPath2)" stroke="none"
      > :familyName : xsd:string</text
      >
<text x="2" xml:space="preserve" y="59" clip-path="url(#clipPath2)" stroke="none"
      > :mbox : AnyURI</text
    ></g
    ><g font-size="11" transform="translate(332,2)" fill-opacity="1" fill="black" text-rendering="geometricPrecision" font-family="sans-serif" stroke="black" font-weight="bold" stroke-opacity="1"
    ><text x="50" xml:space="preserve" y="12" clip-path="url(#clipPath3)" stroke="none"
      >:User</text
    ></g
    ><g font-size="11" transform="translate(42,2)" fill-opacity="1" fill="url(#linearGradient2)" text-rendering="geometricPrecision" font-family="sans-serif" stroke="url(#linearGradient2)" font-weight="bold" stroke-opacity="1"
    ><rect x="0" width="170" height="100" y="0" clip-path="url(#clipPath4)" stroke="none"
    /></g
    ><g font-size="11" stroke-linecap="butt" transform="translate(42,2)" fill-opacity="1" fill="black" text-rendering="geometricPrecision" font-family="sans-serif" stroke-linejoin="round" stroke="black" font-weight="bold" stroke-opacity="1" stroke-miterlimit="0"
    ><rect fill="none" x="0" width="170" height="100" y="0" clip-path="url(#clipPath4)"
      /><line y2="15" fill="none" x1="0" clip-path="url(#clipPath4)" x2="170" y1="15"
    /></g
    ><g font-size="11" transform="matrix(1,0,0,1,42,17)" fill-opacity="1" fill="black" text-rendering="geometricPrecision" font-family="sans-serif" stroke="black" stroke-opacity="1"
    ><text x="2" xml:space="preserve" y="14" clip-path="url(#clipPath5)" stroke="none"
      > :status = Assigned|Unassigned</text
    ></g
    ><g font-size="11" transform="matrix(1,0,0,1,42,17)" fill-opacity="1" fill="black" text-rendering="geometricPrecision" font-family="sans-serif" stroke="black" stroke-opacity="1"
    ><text x="2" xml:space="preserve" y="29" clip-path="url(#clipPath5)" stroke="none"
      > :reportedOn : xsd:dateTime</text
      >
<text x="2" xml:space="preserve" y="44" clip-path="url(#clipPath5)" stroke="none"
      > :reproducedOn : xsd:dateTime?</text
    >
</g
    ><g font-size="11" transform="translate(42,2)" fill-opacity="1" fill="black" text-rendering="geometricPrecision" font-family="sans-serif" stroke="black" font-weight="bold" stroke-opacity="1"
    ><text x="69" xml:space="preserve" y="12" clip-path="url(#clipPath6)" stroke="none"
      >:Issue</text
    ></g
    ><g font-size="11" transform="translate(212,62)" fill-opacity="1" fill="black" text-rendering="geometricPrecision" font-family="sans-serif" stroke="black" stroke-opacity="1"
    ><text x="10" xml:space="preserve" y="12" clip-path="url(#clipPath8)" stroke="none"
      >0..*</text
    ></g
    ><g font-size="11" transform="translate(302,62)" fill-opacity="1" fill="black" text-rendering="geometricPrecision" font-family="sans-serif" stroke="black" stroke-opacity="1"
    ><text x="10" xml:space="preserve" y="12" clip-path="url(#clipPath10)" stroke="none"
      >0..1</text
    ></g
    ><g font-size="11" transform="translate(312,22)" fill-opacity="1" fill="black" text-rendering="geometricPrecision" font-family="sans-serif" stroke="black" stroke-opacity="1"
    ><text x="10" xml:space="preserve" y="12" clip-path="url(#clipPath12)" stroke="none"
      >1</text
    ></g
    ><g font-size="11" transform="translate(212,22)" fill-opacity="1" fill="black" text-rendering="geometricPrecision" font-family="sans-serif" stroke="black" stroke-opacity="1"
    ><text x="10" xml:space="preserve" y="12" clip-path="url(#clipPath8)" stroke="none"
      >0..*</text
    ></g
    ><g font-size="11" transform="translate(122,102)" fill-opacity="1" fill="black" text-rendering="geometricPrecision" font-family="sans-serif" stroke="black" stroke-opacity="1"
    ><text x="9" xml:space="preserve" y="12" clip-path="url(#clipPath14)" stroke="none"
      >0..*</text
    ></g
    ><g font-size="11" transform="translate(2,52)" fill-opacity="1" fill="black" text-rendering="geometricPrecision" font-family="sans-serif" stroke="black" stroke-opacity="1"
    ><text x="10" xml:space="preserve" y="12" clip-path="url(#clipPath16)" stroke="none"
      >0..1</text
    ></g
    ><g font-size="11" stroke-linecap="butt" transform="translate(188,18)" fill-opacity="1" fill="black" text-rendering="geometricPrecision" font-family="sans-serif" stroke-linejoin="round" stroke="black" stroke-opacity="1"
    ><line y2="24" fill="none" x1="143" clip-path="url(#clipPath17)" x2="24" y1="24"
    /></g
    ><g font-size="11" stroke-linecap="butt" transform="translate(189,58)" fill-opacity="1" fill="black" text-rendering="geometricPrecision" font-family="sans-serif" stroke-linejoin="round" stroke="black" stroke-opacity="1"
    ><line y2="24" fill="none" x1="24" clip-path="url(#clipPath17)" x2="143" y1="24"
    /></g
    ><g font-size="11" stroke-linecap="butt" transform="translate(-12,48)" fill-opacity="1" fill="black" text-rendering="geometricPrecision" font-family="sans-serif" stroke-linejoin="round" stroke="black" stroke-opacity="1"
    ><line y2="84" fill="none" x1="134" clip-path="url(#clipPath18)" x2="134" y1="55"
      /><line y2="84" fill="none" x1="134" clip-path="url(#clipPath18)" x2="24" y1="84"
      /><line y2="24" fill="none" x1="24" clip-path="url(#clipPath18)" x2="24" y1="84"
      /><line y2="24" fill="none" x1="24" clip-path="url(#clipPath18)" x2="53" y1="24"
    /></g
    ><g font-size="11" transform="translate(232,42)" fill-opacity="1" fill="black" text-rendering="geometricPrecision" font-family="sans-serif" stroke="black" stroke-opacity="1"
    ><text x="10" xml:space="preserve" y="12" clip-path="url(#clipPath19)" stroke="none"
      >:reportedBy</text
    ></g
    ><g font-size="11" transform="translate(222,82)" fill-opacity="1" fill="black" text-rendering="geometricPrecision" font-family="sans-serif" stroke="black" stroke-opacity="1"
    ><text x="10" xml:space="preserve" y="12" clip-path="url(#clipPath20)" stroke="none"
      >:reproducedBy</text
    ></g
    ><g font-size="11" transform="translate(22,132)" fill-opacity="1" fill="black" text-rendering="geometricPrecision" font-family="sans-serif" stroke="black" stroke-opacity="1"
    ><text x="10" xml:space="preserve" y="12" clip-path="url(#clipPath21)" stroke="none"
      >:related</text
    ></g
    ><g fill="rgb(120,120,120)" text-rendering="geometricPrecision" fill-opacity="1" font-size="10" stroke-opacity="1" stroke="rgb(120,120,120)"
    ></g
  ></g
></svg
-->
        <div class="namespace">
        <p>
          In this example, a user has:
        </p>
        <ul>
          <li><span class="eitherOr   lowlight2 top bot">either a simple name:</span>
            <ul>
              <li class="name lowlight1 top bot">a <span class="type">foaf:</span><span class="constant">name</span> property,</li>
            </ul>
          </li>
          <li><span class="eitherOr   lowlight2 top bot">or a composite name:</span>
            <ul>
              <li class="gname lowlight1 top bot">one or more <span class="type">foaf:</span><span class="constant">givenName</span>s</li>
              <li class="fname lowlight1 top bot">a <span class="type">foaf:</span><span class="constant">familyName</span></li>
            </ul>
          </li>
        </ul>
        <p class="mbox lowlight1 top bot">The user must have exactly one <span class="type">foaf:</span><span class="constant">mbox</span>.</p>

        <div class="example wrapper">
          <!-- ShExC example -->
          <pre class="schema shexc" style="float:left;"><span class="comment"># schema (ShExC)</span>
<span class="shape-name">my:UserShape</span> {
  <span class="eitherOr   lowlight2 top">(                              </span>
     <span class="name       lowlight1 top bot"><span class="predicate">foaf:name</span> <span class="value-constraint">xsd:string</span></span>
  <span class="eitherOr   lowlight2 bot">                               </span>
  <span class="eitherOr   lowlight2 top">  |                            </span>
      <span class="gname      lowlight1 top bot"><span class="predicate">foaf:givenName</span> <span class="value-constraint">xsd:string</span>+</span>;
      <span class="fname      lowlight1 top bot"><span class="predicate">foaf:familyName</span> <span class="value-constraint">xsd:string</span></span>
  <span class="eitherOr   lowlight2 bot">);                             </span>
  <span class="mbox       lowlight1 top bot"><span class="predicate">foaf:mbox</span> <span class="value-constraint">IRI</span></span>
}</pre>

          <!-- JSON example -->
          <pre class="schema json" style="float:left;"><span class="comment">// schema (JSON)</span>
{ <span class="shape-name">"my:UserShape"</span>: { "type": "Shape",
    "expression": { "type": "group",
      "expressions": [
        { "type": "OneOf",
          "expressions": [
            <span class="eitherOr   lowlight2 top">                                                                  </span>
            <span class="name       lowlight1 top">{ "type": "TripleConstraint", <span class="predicate">"predicate": "foaf:name"</span>,        </span>
            <span class="name       lowlight1 bot">  <span class="value-constraint">"value": { "type": "NodeConstraint", "datatype": "xsd:string" }</span> }</span>,
            <span class="eitherOr   lowlight2 bot">                                                                  </span>
            <span class="eitherOr   lowlight2 top">                                                                  </span>
            { "type": "group",
              "expressions": [
                <span class="gname      lowlight1 top">{ "type": "TripleConstraint", <span class="predicate">"predicate": "foaf:givenName"</span>,  </span>
                <span class="gname      lowlight1    ">  <span class="value-constraint">"value": { "type": "NodeConstraint", "datatype": "xsd:string" }</span>,</span>
                <span class="gname      lowlight1 bot">  "min": 1, "max": "*" },                                     </span>
                <span class="fname      lowlight1 top">{ "type": "TripleConstraint", <span class="predicate">"predicate": "foaf:familyName"</span>,  </span>
                <span class="fname      lowlight1 bot">  <span class="value-constraint">"value": { "type": "NodeConstraint", "datatype": "xsd:string" }</span> }</span>
              ]
            }
            <span class="eitherOr   lowlight2 bot">                                                                  </span>
          ]
        },
        <span class="mbox       lowlight1 top">{ "type": "TripleConstraint", <span class="predicate">"predicate": "foaf:mbox"</span>, </span>
        <span class="mbox       lowlight1 bot">  <span class="value-constraint">"value": { "type": "NodeConstraint", "datatype": "IRI" }</span> }</span>
      ]
    }
  }
}</pre>
          <div class="verticalDivider"><!-- acts as a divider --></div>
          <div style="float:left;">
          <pre class="instance turtle"><span class="comment"># passing data</span>
<span class="function-name">inst:User1</span> <span class="keyword">a</span> <span class="type">foaf:</span><span class="constant">Person</span> ;
    <span class="name lowlight1 top bot"><span class="type">foaf:</span><span class="constant">name</span>       <span class="string top bot">"Alice Walker"</span></span> ;
    <span class="mbox lowlight1 top bot"><span class="type">foaf:</span><span class="constant">mbox</span>       <span class="fullURL">&lt;mailto:awalker@example.org&gt;</span><span class="keyword"></span></span> .

<span class="function-name">inst:User2</span> <span class="keyword">a</span> <span class="type">foaf:</span><span class="constant">Person</span> ;
    <span class="gname lowlight1 top"><span class="type">foaf:</span><span class="constant">givenName</span>  <span class="string top bot">"Robert"</span></span> ;
    <span class="gname lowlight1 bot"><span class="type">foaf:</span><span class="constant">givenName</span>  <span class="string top bot">"Paris"</span> </span>;
    <span class="fname lowlight1 top bot"><span class="type">foaf:</span><span class="constant">familyName</span> <span class="string top bot">"Moses"</span></span> ;
    <span class="mbox lowlight1 top bot"><span class="type">foaf:</span><span class="constant">mbox</span>       <span class="fullURL">&lt;mailto:rpmoses@example.org&gt;</span><span class="keyword"></span></span> .</pre>
          <pre class="instance turtle fail"><span class="comment"># failing data</span>
<span class="function-name">inst:User3</span> <span class="keyword">a</span> <span class="type">foaf:</span><span class="constant">Person</span> ;
    <span class="gname lowlight1 top bot"><span class="type">foaf:</span><span class="constant">givenName</span>  <span class="string top bot">"Smith"</span></span> ;
    <span class="errorSite"> # error: no familyName</span>
    <span class="mbox lowlight1 top bot"><span class="type">foaf:</span><span class="constant">mbox</span>       <span class="fullURL">&lt;mailto:bobs@example.org&gt;</span><span class="keyword"></span></span> .

<span class="function-name">inst:User4</span> <span class="keyword">a</span> <span class="type">foaf:</span><span class="constant">Person</span> ;
    <span class="name lowlight1 top bot"><span class="type">foaf:</span><span class="constant">name</span>       <span class="string top bot">"A"</span></span> ;
    <span class="errorSite"> # error: both name and given/family name</span>
    <span class="gname lowlight1 top bot"><span class="type">foaf:</span><span class="constant">givenName</span>  <span class="string top bot">"B"</span></span> ;
    <span class="fname lowlight1 top bot"><span class="type">foaf:</span><span class="constant">familyName</span> <span class="string top bot">"C"</span></span> ;
    <span class="mbox lowlight1 top bot"><span class="type">foaf:</span><span class="constant">mbox</span>       <span class="fullURL">&lt;mailto:bobs@example.org&gt;</span><span class="keyword"></span></span> .</pre>
          </div>

          <div style="clear:both;"></div>
      </div>
      <script type="text/javascript">
      <!--
prepareHighlight(['oneOrMore', 'eitherOr'], "highlight2", "lowlight2");
prepareHighlight(['name', 'gname', 'fname', 'mbox'], "highlight1", "lowlight1");
      -->
      </script>
      </div>
    </section>

    
      <section id="value-sets">
        <h2>Value Sets</h2>
        <p>
          As described <a href="#vocab-value-set">above in Vocabulary</a>, <code>value sets</code> in a <code>value constraint</code> enumerate permissible values for some property.
        </p>
        <pre class="schema shexc shh">my:IssueShape {
  ex:state <span class="value-constraint new">[ex:unassigned ex:assigned]</span>
}</pre>
        <pre class="schema json shh">
{ "my:IssueShape": { "type": "Shape",
  "expression": { "type": "TripleConstraint", "predicate": "ex:status",
    "value": { "type": "NodeConstraint", "values": <span class="value-constraint new">[ "ex:unassigned", "ex:assigned" ]</span> } } } }</pre>
        <p style="margin: 0;">
          The above examples could also be literals, e.g.
        </p>
        <pre class="schema shexc shh">my:IssueShape {
  ex:state <span class="value-constraint new">["unassigned" "assigned"]</span>
}</pre>
        <pre class="schema json shh">
{ "my:IssueShape": { "type": "Shape",
  "expression": { "type": "TripleConstraint", "predicate": "ex:status",
    "value": { "type": "NodeConstraint", "values": <span class="value-constraint new">[ "\"unassigned\'", "\"assigned\"" ]</span> } } } }</pre>
        <p>
          Fixed values are represented as value sets with one member.
          For example, a required type triple can be expressed like:
        </p>
        <pre class="schema shexc shh">my:UserShape {
  rdf:type <span class="value-constraint new">[foaf:Person]</span>
}</pre>
        <pre class="schema json shh">{ "my:IssueShape": { "type": "Shape",
  "expression": { "type": "TripleConstraint", "predicate": "rdf:type",
    "value": { "type": "NodeConstraint", "values": [ <span class="value-constraint new">"foaf:Person"</span> ] } } } }</pre>
        <p style="margin: 0;">
          or using the keyword <code class="keyword">a</code>:
        </p>
        <pre class="schema shexc shh">my:UserShape {
  <span class="keyword">a</span> <span class="value-constraint new">[foaf:Person]</span>
}</pre>
        <pre class="schema json shh">{ "my:IssueShape": { "type": "Shape",
  "expression": { "type": "TripleConstraint", "predicate": "a",
    "value": { "type": "NodeConstraint", "values": [ <span class="value-constraint new">"foaf:Person"</span> ] } } } }</pre>

        <section id="sec-iri-range">
          <h3>IRI Range</h3>
          <div class="example wrapper">
            <p>
              A value set can also contain <code id="iri-range">IRI ranges</code>.
              A range can be an IRI (in any valid IRI form) followed by "<code>~</code>", which indicates that the range includes all IRIs starting with that IRI:
            </p>

            <!-- ShExC example -->
            <pre class="schema shexc" style="float:left;"><span class="comment"># schema (ShExC)</span>
<span class="keyword">PREFIX</span> <span class="type">ex:</span> <span class="function-name">&lt;http://a.example/#&gt;</span>
<span class="keyword">PREFIX</span> <span class="type">excodes:</span> <span class="function-name">&lt;http://a.example/codes#&gt;</span>
<span class="keyword">PREFIX</span> <span class="type">exmisc:</span> <span class="function-name">&lt;http://aux.example/misc#&gt;</span>

<span class="shape-name">my:UserShape</span> {
  <span class="predicate">ex:status</span> <span class="value-constraint">[
      excodes:~ auxterms:~
  ]</span>
}</pre>

            <!-- JSON example -->
            <pre class="schema json" style="float:left;"><span class="comment">// schema (JSON)</span>
{ <span class="Shape-status">"my:UserShape"</span>: { "type": "Shape",
  "expression": {
    "type": "TripleConstraint", <span class="predicate">"predicate": "ex:status"</span>,
    <span class="value-constraint">"value": {
      "type": "NodeConstraint", "values": [ "excodes:unassigned", "excodes:assigned" ] }</span> } } }</pre>
            <div class="verticalDivider"><!-- acts as a divider --></div>
            <div style="float:left;">
              <pre class="instance turtle"><span class="comment"># passing data</span>
<span class="status lowlight1 top bot"><span class="user lowlight2 top bot"><span class="function-name">inst:Shape2</span></span> <span class="type">ex:</span><span class="constant">status</span>  <span class="string top bot">excodes:resolved</span></span> .</pre>
              <pre class="instance turtle fail"><span class="comment"># failing data - ex:done not in any range</span>
<span class="status lowlight1 top bot"><span class="user lowlight2 top bot"><span class="function-name">inst:Shape5</span></span> <span class="type">ex:</span><span class="constant">status</span>  <span class="min lowlight2 top bot"><span class="string top bot errorSite">ex:done</span></span></span>.</pre>
  </div>
            <div style="clear:both;"></div>
          </div>
        </section>

        <section id="sec-iri-range-exclusion">
          <h3>IRI Range Exclusions</h3>
          <div class="example wrapper">
            <p>
              Since an <a class="ref" href="#iri-range">IRI range</a> matched multiple IRIs, one may wish to exclude contained IRIs or IRI ranges.
              For example we may wish to include <code id="iri-exclusion">IRI exclusion</code> 
              A value set can also contain <code>IRI ranges</code>.
              A range can be an IRI (in any valid IRI form) followed by "<code>~</code>", which indicates that the range includes all IRIs starting with that IRI:
            </p>

            <!-- ShExC example -->
            <pre class="schema shexc" style="float:left;"><span class="comment"># schema (ShExC)</span>
<span class="keyword">PREFIX</span> <span class="type">ex:</span> <span class="function-name">&lt;http://a.example/#&gt;</span>
<span class="keyword">PREFIX</span> <span class="type">excodes:</span> <span class="function-name">&lt;http://a.example/codes#&gt;</span>
<span class="keyword">PREFIX</span> <span class="type">auxterms:</span> <span class="function-name">&lt;http://aux.example/terms#&gt;</span>

<span class="shape-name">my:UserShape</span> {
  <span class="predicate">ex:status</span> <span class="value-constraint">[
      excodes:~ - excodes:unassigned - excodes:assigned
      auxterms:~ - &lt;http://aux.example/terms#med_&gt;~
  ]</span>
}</pre>

            <!-- JSON example -->
            <pre class="schema json" style="float:left;"><span class="comment">// schema (JSON)</span>
{ <span class="Shape-status">"my:UserShape"</span>: { "type": "Shape",
  "expression": {
    "type": "TripleConstraint", <span class="predicate">"predicate": "ex:status"</span>,
    <span class="value-constraint">"value": {
      "type": "NodeConstraint", "values": [ "excodes:unassigned", "excodes:assigned" ] }</span> } } }</pre>
            <div class="verticalDivider"><!-- acts as a divider --></div>
            <div style="float:left;">
              <pre class="instance turtle"><span class="comment"># passing data</span>
<span class="status lowlight1 top bot"><span class="user lowlight2 top bot"><span class="function-name">inst:Shape2</span></span> <span class="type">ex:</span><span class="constant">status</span>  <span class="string top bot">excodes:resolved</span></span> .</pre>
              <pre class="instance turtle fail"><span class="comment"># failing data - excodes:assigned prohibited</span>
<span class="status lowlight1 top bot"><span class="user lowlight2 top bot"><span class="function-name">inst:Shape3</span></span> <span class="type">ex:</span><span class="constant">status</span>  <span class="min lowlight2 top bot"><span class="string top bot errorSite">excodes:assigned</span></span></span>.</pre>
              <pre class="instance turtle fail"><span class="comment"># failing data - auxterms:med_… prohibited</span>
<span class="status lowlight1 top bot"><span class="user lowlight2 top bot"><span class="function-name">inst:Shape4</span></span> <span class="type">ex:</span><span class="constant">status</span>  <span class="min lowlight2 top bot"><span class="string top bot errorSite">auxterms:med_sniffles</span></span></span>.</pre>
              <pre class="instance turtle fail"><span class="comment"># failing data - ex:done not in any range</span>
<span class="status lowlight1 top bot"><span class="user lowlight2 top bot"><span class="function-name">inst:Shape5</span></span> <span class="type">ex:</span><span class="constant">status</span>  <span class="min lowlight2 top bot"><span class="string top bot errorSite">ex:done</span></span></span>.</pre>
  </div>
            <div style="clear:both;"></div>
          </div>
          <div class="example wrapper">
            <p>
              You can also use a "<code>.</code>" with some <code> IRI exclusions</code> in order to say that anything is permitted except those exclusions.
            </p>

            <!-- ShExC example -->
            <pre class="schema shexc" style="float:left;"><span class="comment"># schema (ShExC)</span>

<span class="shape-name">my:UserShape</span> {
  <span class="predicate">ex:status</span> <span class="value-constraint">[
      . - excodes:unassigned - excodes:assigned
  ]</span>
}</pre>

            <!-- JSON example -->
            <pre class="schema json" style="float:left;"><span class="comment">// schema (JSON)</span>
{ <span class="Shape-status">"my:UserShape"</span>: { "type": "Shape",
  "expression": {
    "type": "TripleConstraint", <span class="predicate">"predicate": "ex:status"</span>,
    <span class="value-constraint">"value": {
      "type": "NodeConstraint", "values": [ "excodes:unassigned", "excodes:assigned" ] }</span> } } }</pre>
            <div class="verticalDivider"><!-- acts as a divider --></div>
            <div style="float:left;">
              <pre class="instance turtle"><span class="comment"># passing data</span>
<span class="status lowlight1 top bot"><span class="user lowlight2 top bot"><span class="function-name">inst:Shape2</span></span> <span class="type">ex:</span><span class="constant">status</span>  <span class="string top bot">ex:random</span></span> .</pre>
              <pre class="instance turtle fail"><span class="comment"># failing data - excodes:assigned prohibited</span>
<span class="status lowlight1 top bot"><span class="user lowlight2 top bot"><span class="function-name">inst:Shape3</span></span> <span class="type">ex:</span><span class="constant">status</span>  <span class="min lowlight2 top bot"><span class="string top bot errorSite">excodes:assigned</span></span></span>.</pre>
  </div>
            <div style="clear:both;"></div>
          </div>
        </section>
      </section>
      
		<section id="properties">
			<h2>Other Triple Constraints</h2>
    	<p>
				<code>Triple constraints</code> can be inverse.
        They can also have a cardinality of zero which effectively makes them <a href="#negated-properties">negated</a>.
        Multiple triple constraints on the same property are interpreted as <a href="#additive-properties">additive</a>; each triple constraint is independently fulfilled by different triples in the instance data.
      </p>
      <section id="inverse-properties">
        <h3>Inverse Triple Constraints</h3>
        <div class="namespace">
          <p>
            Here we change the first example so that instead of an issue having an <span class="reportedBy lowlight1 top bot"><span class="type">ex:</span><span class="constant">reportedBy</span> identifying a node corresponding to <span class="function-name">my:UserShape</span></span>, the user node has a <span class="reportedIssue lowlight1 top bot">predicate <span class="type">ex:</span><span class="constant">reportedIssue</span> which identifies the issue</span>.
            We don't want to assert that every node matching <span class="shape-name">my:UserShape</span> has reported an issue; we simply want to make sure that for every issue, there is some user who reported it.
          </p>
          <p>
            The direction of the arc is changed by prefixing the <code>triple constraint</code> with a "<span class="inversePredicate top bot keyword lowlight2">^</span>" in ShExC or <span class="inversePredicate top bot keyword lowlight2">"inverse": true</span> in JSON:
          </p>

          <div class="example wrapper">
            <!-- ShExC example -->
            <pre class="schema shexc" style="float:left;"><span class="comment"># schema (ShExC)</span>
<span class="shape-name">my:IssueShape</span> {
  <span class="predicate">ex:state</span> [<span class="value-constraint">ex:unassigned ex:assigned</span>];
 <span class="inversePredicate top bot keyword lowlight2">^</span><span class="reportedIssue lowlight1 top bot"><span class="predicate">ex:reportedIssue</span> <span class="value-constraint">@</span><span class="shape-name">my:UserShape</span></span>
}

<span class="shape-name">my:UserShape</span> {
  <span class="predicate">foaf:name</span> <span class="constraint">xsd:string</span>;
  <span class="predicate">foaf:mbox</span> <span class="value-constraint">IRI</span>+
}</pre>

            <!-- JSON example -->
            <pre class="schema json" style="float:left;"><span class="comment">// schema (JSON)</span>
{ "type": "Schema",
  "shapes": {
    <span class="shape-name">"my:IssueShape"</span>: { "type": "Shape",
      "expression": { "type": "group",
        "expressions": [
          { "type": "TripleConstraint",                   
            <span class="predicate">"predicate": "ex:state"</span>,                      
            <span class="value-constraint">"value": { "type": "NodeConstraint",              </span>
            <span class="value-constraint">  "values": [ "ex:unassigned", "ex:assigned" ]</span>
            <span class="value-constraint">}                                             </span>
          },                                              
          <span class="reportedIssue lowlight1 top">{ "type": "TripleConstraint",                      </span>
          <span class="reportedIssue lowlight1    ">  <span class="predicate">"predicate": "ex:reportedIssue"</span>, <span class="inversePredicate top bot keyword lowlight2">"inverse": true</span>,</span>
          <span class="reportedIssue lowlight1    ">  <span class="value-constraint">"value": { "type": "ShapeRef",</span>                 </span>
          <span class="reportedIssue lowlight1    ">  <span class="value-constraint">  "reference": <span class="shape-name">"my:IssueShape"</span></span>                   </span>
          <span class="reportedIssue lowlight1    ">  <span class="value-constraint">}              </span>                                  </span>
          <span class="reportedIssue lowlight1 bot">}                                                  </span>
        ]
      }
    },
    <span class="shape-name">"my:UserShape"</span>: { "type": "Shape",
      "expression": { "type": "group",
        "expressions": [
          { "type": "TripleConstraint",                   
            <span class="predicate">"predicate": "foaf:name"</span>,                     
            <span class="value-constraint">"value": {                </span>
            <span class="value-constraint">  "type": "NodeConstraint",   </span>
            <span class="value-constraint">  "datatype": "xsd:string"</span>
            <span class="value-constraint">}                         </span>
          },                                              
          { "type": "TripleConstraint",                   
            <span class="predicate">"predicate": "foaf:mbox"</span>,                     
            <span class="value-constraint">"value": { "type": "NodeConstraint",</span>              
            <span class="value-constraint">  "nodeKind": "iri"             </span>              
            <span class="value-constraint">},                              </span>
            <span class="value-constraint">"min": 1, "max": "*"            </span>
          }                                               
        ]
      }
    }
  }
}</pre>
            <div class="verticalDivider"><!-- acts as a divider --></div>
            <div style="float:left;">
            <pre class="instance turtle"><span class="comment"># passing data</span>
<span class="function-name">inst:Issue1</span> <span class="keyword">a</span> <span class="type">ex:</span><span class="constant">Issue</span> ;
    <span class="state lowlight1 top bot"><span class="type">ex:</span><span class="constant">state</span>        <span class="type">ex:</span><span class="constant">unassigned</span></span> .

<span class="user lowlight2 top bot"><span class="function-name">inst:User2</span></span> <span class="keyword">a</span> <span class="type">foaf:</span><span class="constant">Person</span> ;
    <span class="name lowlight1 top bot"><span class="type">foaf:</span><span class="constant">name</span>       <span class="string top bot">"Bob Smith"</span></span> ;
    <span class="reportedIssue lowlight1 top bot new">ex:reportedIssue <span class="function-name">inst:Issue1</span></span> ;
    <span class="mbox lowlight1 top"><span class="type">foaf:</span><span class="constant">mbox</span>       <span class="fullURL">&lt;mailto:bob@example.org&gt;</span><span class="keyword"></span></span> ;
    <span class="mbox lowlight1 bot"><span class="type">foaf:</span><span class="constant">mbox</span>       <span class="fullURL">&lt;mailto:rs@example.org&gt;</span> <span class="keyword"></span></span>.</pre>
            <pre class="instance turtle fail"><span class="comment"># failing data</span>
<span class="function-name">inst:Issue2</span> <span class="keyword">a</span> <span class="type">ex:</span><span class="constant">Issue</span> ;
    <span class="state lowlight1 top bot"><span class="type">ex:</span><span class="constant">state</span>         <span class="type">ex:</span><span class="constant">unassigned</span></span> ;
    <span class="reportedIssueInv lowlight1 top bot errorSite">ex:reportedIssue <span class="function-name">inst:User4</span></span> .

<span class="user lowlight2 top bot"><span class="function-name">inst:User4</span></span> <span class="keyword">a</span> <span class="type">foaf:</span><span class="constant">Person</span> ;
    <span class="name lowlight1 top bot"><span class="type">foaf:</span><span class="constant">name</span>        <span class="string top bot">"Bob Smith"</span></span> ;
    <span class="mbox lowlight1 top"><span class="type">foaf:</span><span class="constant">mbox</span>        <span class="fullURL">&lt;mailto:bob@example.org&gt;</span><span class="keyword"></span></span> ;
    <span class="mbox lowlight1 bot"><span class="type">foaf:</span><span class="constant">mbox</span>        <span class="fullURL">&lt;mailto:rs@example.org&gt;</span> <span class="keyword"></span></span>.</pre>
            <pre class="instance turtle fail"><span class="comment"># failing data</span>
<span class="function-name">inst:Issue3</span> <span class="keyword">a</span> <span class="type">ex:</span><span class="constant">Issue</span> ;
    <span class="state lowlight1 top bot"><span class="type">ex:</span><span class="constant">state</span>         <span class="type">ex:</span><span class="constant">unassigned</span></span> ;
    <span class="reportedBy lowlight1 top bot"><span class="type">ex:</span><span class="constant">reportedBy</span>    <span class="function-name">inst:User5</span></span> .
    <span class="comment errorSite"># missing ex:reportedIssue with object inst:Issue3</span>
<span class="user lowlight2 top bot"><span class="function-name">inst:User5</span></span> <span class="keyword">a</span> <span class="type">foaf:</span><span class="constant">Person</span> ;
    <span class="name lowlight1 top bot"><span class="type">foaf:</span><span class="constant">name</span>        <span class="string top bot">"Bob Smith"</span></span> ;
    <span class="mbox lowlight1 top"><span class="type">foaf:</span><span class="constant">mbox</span>        <span class="fullURL">&lt;mailto:bob@example.org&gt;</span><span class="keyword"></span></span> ;
    <span class="mbox lowlight1 bot"><span class="type">foaf:</span><span class="constant">mbox</span>        <span class="fullURL">&lt;mailto:rs@example.org&gt;</span> <span class="keyword"></span></span>.</pre>
  </div>
            <div style="clear:both;"></div>
            <p style="margin-bottom: 0;">
              Note that the passing data contains the triple:
            </p>
            <pre class="instance turtle" style="margin: 0 1em;"><span class="reportedIssue lowlight1 top bot new" style="background-color: #fcfaee;"><span class="function-name">inst:User2</span> ex:reportedIssue <span class="function-name">inst:Issue1</span></span></pre>
            <p style="margin: 0;">
              while the failing data contains the triple:
            </p>
            <pre class="instance turtle fail" style="margin: 0 1em;"><span class="reportedIssueInv lowlight1 top bot new" style="background-color: #fceefa;"><span class="function-name">inst:Issue1</span> <span class="errorSite">ex:reportedIssue</span> <span class="function-name">inst:User2</span></span></pre>
          </div>
          <script type="text/javascript">
          <!--
prepareHighlight(["inversePredicate"], "highlight2", "lowlight2");
prepareHighlight(["state999", "reportedBy", "reportedIssue", "reportedIssueInv", "name999", "mbox999"], "highlight1", "lowlight1");
              -->
            </script>
          </div>

        <div class="namespace">
          <p>
            Note that  placing a regular <code>triple constraint</code> on <span class="shape-name">my:UserShape</span> would require that all users have reported an issue, and is thus different from using the inverse property on <span class="shape-name">my:IssueShape</span>.
            In this example, <span class="function-name inst-User6 lowlight2 top bot">inst:User6</span> would fail to match <span class="shape-name">my:UserShape</span>:
          </p>

          <div class="example wrapper">
            <!-- ShExC example -->
            <pre class="schema shexc" style="float:left;"><span class="comment"># schema (ShExC)</span>
<span class="shape-name">my:IssueShape</span> {
  <span class="predicate">ex:state</span> [<span class="value-constraint">ex:unassigned ex:assigned</span>]
}

<span class="shape-name">my:UserShape</span> {
  <span class="predicate">foaf:name</span> <span class="constraint">xsd:string</span>;
  <span class="predicate">foaf:mbox</span> <span class="value-constraint">IRI</span>+;
  <span class="reportedIssue lowlight1 top bot"><span class="predicate">ex:reportedIssue</span> <span class="value-constraint">@</span><span class="shape-name">my:UserShape</span></span>
}</pre>

            <!-- JSON example -->
            <pre class="schema json" style="float:left;"><span class="comment">// schema (JSON)</span>
{ "type": "Schema",
  "shapes": {
    <span class="shape-name">"my:IssueShape"</span>: { "type": "Shape",
      "expression": { "type": "group",
        "expressions": [
          { "type": "TripleConstraint",                   
            <span class="predicate">"predicate": "ex:state"</span>,                      
            <span class="value-constraint">"value": { "type": "NodeConstraint",              </span>
            <span class="value-constraint">  "values": [ "ex:unassigned", "ex:assigned" ]</span>
            <span class="value-constraint">}                                             </span>
          }
        ]
      }
    },
    <span class="shape-name">"my:UserShape"</span>: { "type": "Shape",
      "expression": { "type": "group",
        "expressions": [
          { "type": "TripleConstraint",                   
            <span class="predicate">"predicate": "foaf:name"</span>,                     
            <span class="value-constraint">"value": {                </span>
            <span class="value-constraint">  "type": "NodeConstraint",   </span>
            <span class="value-constraint">  "datatype": "xsd:string"</span>
            <span class="value-constraint">}                         </span>
          },                                              
          { "type": "TripleConstraint",                   
            <span class="predicate">"predicate": "foaf:mbox"</span>,                     
            <span class="value-constraint">"value": { "type": "NodeConstraint",</span>              
            <span class="value-constraint">  "nodeKind": "iri"             </span>              
            <span class="value-constraint">},                              </span>
            "min": 1, "max": "*"
          },                                              
          <span class="reportedIssue lowlight1 top">{ "type": "TripleConstraint",                      </span>
          <span class="reportedIssue lowlight1    ">  <span class="predicate">"predicate": "ex:reportedIssue"</span>, <span class="inversePredicate top bot keyword lowlight2">"inverse": false</span>,</span>
          <span class="reportedIssue lowlight1    ">  <span class="value-constraint">"value": { "type": "ShapeRef",</span>                 </span>
          <span class="reportedIssue lowlight1    ">  <span class="value-constraint">  "reference": <span class="shape-name">"my:IssueShape"</span></span>                   </span>
          <span class="reportedIssue lowlight1    ">  <span class="value-constraint">}              </span>                                  </span>
          <span class="reportedIssue lowlight1 bot">}                                                  </span>
        ]
      }
    }
  }
}</pre>
            <div class="verticalDivider"><!-- acts as a divider --></div>
            <div style="float:left;">
            <pre class="instance turtle"><span class="comment"># passing and failing data</span>
<span class="function-name">inst:Issue4</span> <span class="keyword">a</span> <span class="type">ex:</span><span class="constant">Issue</span> ;
    <span class="state lowlight1 top bot"><span class="type">ex:</span><span class="constant">state</span>        <span class="type">ex:</span><span class="constant">unassigned</span></span> .

<span class="fail inst-User6 lowlight2 top"><span class="function-name">inst:User6</span> <span class="keyword">a</span> <span class="type">foaf:</span><span class="constant">Person</span> ; <span class="comment"># fails my:UserShape</span></span>
<span class="fail inst-User6 lowlight2    ">    <span class="name lowlight1 top bot"><span class="type">foaf:</span><span class="constant">name</span>       <span class="string top bot">"Bob Smith"</span></span> ;              </span>
<span class="fail inst-User6 lowlight2    ">    <span class="mbox lowlight1 top"><span class="type">foaf:</span><span class="constant">mbox</span>       <span class="fullURL">&lt;mailto:bob@example.org&gt;</span><span class="keyword"></span></span> ; </span>
<span class="fail inst-User6 lowlight2 bot">    <span class="mbox lowlight1 bot"><span class="type">foaf:</span><span class="constant">mbox</span>       <span class="fullURL">&lt;mailto:rs@example.org&gt;</span> <span class="keyword"></span></span>.  </span>

<span class="function-name">inst:User7</span> <span class="keyword">a</span> <span class="type">foaf:</span><span class="constant">Person</span> ;
    <span class="name lowlight1 top bot"><span class="type">foaf:</span><span class="constant">name</span>       <span class="string top bot">"Bob Smith"</span></span> ;
    <span class="reportedIssue lowlight1 top bot new">ex:reportedIssue <span class="function-name">inst:Issue4</span></span> ;
    <span class="mbox lowlight1 top"><span class="type">foaf:</span><span class="constant">mbox</span>       <span class="fullURL">&lt;mailto:bob@example.org&gt;</span><span class="keyword"></span></span> ;
    <span class="mbox lowlight1 bot"><span class="type">foaf:</span><span class="constant">mbox</span>       <span class="fullURL">&lt;mailto:rs@example.org&gt;</span> <span class="keyword"></span></span>.</pre>
  </div>
            <div style="clear:both;"></div>
          </div>
          <script type="text/javascript">
          <!--
prepareHighlight(["inst-User6"], "highlight2", "lowlight2");
prepareHighlight(["state999", "reportedBy", "reportedIssue", "name999", "mbox999"], "highlight1", "lowlight1");
              -->
            </script>
          </div>

        </section>

        <section id="negated-properties">
          <h3>Negating Property Declarations</h3>
          <div class="namespace">
            <p>
              Sometimes we want to say what's <em>not</em> in a schema as well as what's in it.
              Setting the cardinality to zero asserts that they must not appear in 
              For instance, we may want to say that a SolitaryIssueShape is <span class="hilight-invComponent top bot lowlight2">not a component of anything else</span>, nor does it <span class="hilight-component top bot lowlight2">have components</span>:
            </p>
  
            <div class="example wrapper">
              <!-- ShExC example -->
              <pre class="schema shexc" style="float:left;"><span class="comment"># schema (ShExC)</span>
<span class="shape-name">my:SolitaryIssueShape</span> {
  <span class="predicate">ex:state</span> [<span class="value-constraint">ex:unassigned ex:assigned</span>];
 <span class="hilight-invComponent top bot keyword lowlight2">^<span class="predicate">ex:component</span> . <span class="new" style="color: black; ">{0}</span></span>;
  <span class="hilight-component top bot keyword lowlight2"><span class="predicate">ex:component</span> . <span class="new" style="color: black; ">{0}</span></span>
}</pre>

              <!-- JSON example -->
              <pre class="schema json" style="float:left;"><span class="comment">// schema (JSON)</span>
TODO</pre>
              <div class="verticalDivider"><!-- acts as a divider --></div>
              <div style="float:left;">
              <pre class="instance turtle"><span class="comment"># passing and failing data</span>
<span class="function-name">inst:Issue1</span> <span class="keyword">a</span> <span class="type">ex:</span><span class="constant">Issue</span> ;
    <span class="other lowlight1 top bot"><span class="type">rdfs:</span><span class="constant">label</span>      <span class="string">"smokes too much"</span></span> ;
    <span class="type">ex:</span><span class="constant">state</span>        <span class="type">ex:</span><span class="constant">unassigned</span> .

<span class="fail hilight-Issue2-block lowlight1 top"><span class="comment"># inst:Issue2 fails my:SolitaryIssueShape</span></span>
<span class="fail hilight-Issue2-block lowlight1    "><span class="function-name">inst:Issue2</span> <span class="keyword">a</span> <span class="type">ex:</span><span class="constant">Issue</span> ;                 </span>
<span class="fail hilight-Issue2-block lowlight1    ">    <span class="other lowlight1 top bot"><span class="type">dc:</span><span class="constant">creator</span>      <span class="string">"Alice"</span></span> ;            </span>
<span class="fail hilight-Issue2-block lowlight1    ">    <span class="type">ex:</span><span class="constant">state</span>        <span class="type">ex:</span><span class="constant">unassigned</span> ;      </span>
<span class="fail hilight-Issue2-block lowlight1 bot">    </span><span class="hilight-component hilight-invComponent lowlight1 top bot errorSite">ex:component</span> <span class="fail hilight-Issue2-block lowlight1 bot">   <span class="function-name">inst:Issue3</span> .        </span>

<span class="fail hilight-Issue3-block lowlight1 top"><span class="comment"># inst:Issue3 fails my:SolitaryIssueShape</span></span>
<span class="fail hilight-Issue3-block lowlight1    "><span class="function-name">inst:Issue3</span> <span class="keyword">a</span> <span class="type">ex:</span><span class="constant">Issue</span> ;                 </span>
<span class="fail hilight-Issue3-block lowlight1    ">    <span class="other lowlight1 top bot"><span class="type">rdfs:</span><span class="constant">label</span>      <span class="string">"smokes too much"</span></span> ;  </span>
<span class="fail hilight-Issue3-block lowlight1 bot">    <span class="state lowlight1 top bot"><span class="type">ex:</span><span class="constant">state</span>        <span class="type">ex:</span><span class="constant">unassigned</span></span> .      </span></pre>
</div>
              <div style="clear:both;"></div>
              <p style="margin-bottom: 0;">
                <span class="fail hilight-Issue2-block lowlight1 top bot">inst:Issue2</span> fails because it has an "outgoing" component triple
              </p>
              <pre class="instance turtle" style="margin: 0 1em;"><span class="hilight-component999 hilight-invComponent999 lowlight1 top bot errorSite" style="background-color: #fcfaee;"><span class="function-name">inst:Issue2</span> ex:component <span class="function-name">inst:Issue3</span> .</span></pre>
              <p style="margin: 0;">
                which violates this constraint:
              </p>
              <pre class="schema shexc"><span class="hilight-component top bot keyword lowlight2"><span class="predicate">ex:component</span> . <span style="color: black; ">{0}</span></span></pre>
              <p style="margin: 0;">
                and <span class="fail hilight-Issue3-block lowlight1 top bot">inst:Issue3</span> fails because the same triple is an "incoming" component triple, violating this constraint:
              </p>
              <pre class="schema shexc"><span class="hilight-invComponent top bot keyword lowlight2">^<span class="predicate">ex:component</span> . <span style="color: black; ">{0}</span></span></pre>
            </div>
            <script type="text/javascript">
            <!--
prepareHighlight(["hilight-component", "hilight-invComponent", "hilight-Issue2-block", "hilight-Issue3-block"], "highlight2", "lowlight2");
            -->
            </script>
          </div>
        </section>

          <section id="closed-shapes">
            <h4>Closing Shapes</h4>
          <p>
            Services backed by an RDF triple store may accept and ignore triples which are not mentioned in the schema (presuming the schema identifies the triples that the service understands and manipulates).
            Likewise, some SPARQL endpoints may be best described as providing data in a particular schema, but also likely to have additional data not mentioned in the schema.
            On the other end of the spectrum may be services or databases which accept or emit only the structures described in the schema.
            ShEx can describe these constraints.
          </p>

        <div class="namespace">
            <p>
              Shapes can close not only the predicates listed in their expressions, but all other predicates as well with the keyword "CLOSED":
            </p>
        <div id="closed-shapes-example-1" class="example wrapper">
          <!-- ShExC example -->
          <pre class="schema shexc" style="float:left;"><span class="comment"># schema (ShExC)</span>
<span class="user lowlight2 top bot shape-name">my:UserShape</span> {
  <span class="name       lowlight1 top bot"><span class="predicate">foaf:name</span> <span class="value-constraint">xsd:string</span></span>;
  <span class="mbox       lowlight1 top bot"><span class="predicate">foaf:mbox</span> <span class="value-constraint">IRI</span><span class="keyword">+</span></span>
}</pre>

          <!-- JSON example -->
          <pre class="schema json" style="float:left;"><span class="comment">// schema (JSON)</span>
{ "type": "Schema",
  "shapes": {
    <span class="user lowlight2 top bot">"my:UserShape"</span>: { "type": "Shape",
      "expression": { "type": "group",
        "expressions": [
          <span class="name       lowlight1 top">{ "type": "TripleConstraint",                   </span>
          <span class="name       lowlight1    ">  <span class="predicate">"predicate": "foaf:name"</span>,                     </span>
          <span class="name       lowlight1    ">  <span class="value-constraint">"value": {             </span>                       </span>
          <span class="name       lowlight1    ">  <span class="value-constraint">  "type": "NodeConstraint",</span>                       </span>
          <span class="name       lowlight1    ">  <span class="value-constraint">  "datatype": <span class="string lowlight2 top bot">"xsd:string"</span></span>                    </span>
          <span class="name       lowlight1    ">  <span class="value-constraint">}                      </span>                       </span>
          <span class="name       lowlight1 bot">},                                              </span>
          <span class="mbox       lowlight1 top">{ "type": "TripleConstraint",                   </span>
          <span class="mbox       lowlight1    ">  <span class="predicate">"predicate": "foaf:mbox"</span>,                     </span>
          <span class="mbox       lowlight1    ">  <span class="value-constraint">"value": { "type": "NodeConstraint",</span>              </span>
          <span class="mbox       lowlight1    ">  <span class="value-constraint">  "nodeKind": <span class="IRI lowlight2 top bot">"iri"</span>             </span>              </span>
          <span class="mbox       lowlight1    ">  <span class="value-constraint">},                                            </span></span>
          <span class="mbox       lowlight1    ">  <span class="value-constraint oneOrMore lowlight2 top bot">"min": 1, "max": "*"</span>                          </span>
          <span class="mbox       lowlight1 bot">}                                               </span>
        ]
      }
    }
  }
}</pre>
          <div class="verticalDivider"><!-- acts as a divider --></div>
          <div style="float:left;">
          <pre class="instance turtle"><span class="comment"># passing data</span>
<span class="user lowlight2 top bot"><span class="function-name">inst:User4</span></span> <span class="type">foaf:</span><span class="constant">knows</span> <span class="function-name">inst:User2</span> .

<span class="user lowlight2 top bot"><span class="function-name">inst:User2</span></span> <span class="keyword">a</span> <span class="type">foaf:</span><span class="constant">Person</span> ;
    <span class="label lowlight1 top bot"><span class="type">rdfs:</span><span class="constant">label</span>      <span class="string top bot">"Robert Smith's person record"</span></span> ;
    <span class="name lowlight1 top bot"><span class="type">foaf:</span><span class="constant">name</span>       <span class="string top bot">"Bob Smith"</span></span> ;
    <span class="mbox lowlight1 top"><span class="type">foaf:</span><span class="constant">mbox</span>       <span class="fullURL">&lt;mailto:bob@example.org&gt;</span><span class="keyword"></span></span> ;
    <span class="mbox lowlight1 bot"><span class="type">foaf:</span><span class="constant">mbox</span>       <span class="fullURL">&lt;mailto:rs@example.org&gt;</span> <span class="keyword"></span></span>.</pre>
  </div>
          <div style="clear:both;"></div>
      </div>
      <script type="text/javascript">
      <!--
prepareHighlight(["oneOrMore", "IRI", "stateValue", "user"], "highlight2", "lowlight2");
prepareHighlight(["state", "reportedBy", "name", "mbox"], "highlight1", "lowlight1");
      -->
      </script>
      </div>

        <div class="namespace">
        <div id="closed-shapes-example-2" class="example wrapper">
          <!-- ShExC example -->
          <pre class="schema shexc" style="float:left;"><span class="comment"># schema (ShExC)</span>
<span class="user lowlight2 top bot shape-name">my:UserShape</span> <span class="keyword closed">CLOSED</span> {
  <span class="name       lowlight1 top bot"><span class="predicate">foaf:name</span> <span class="value-constraint">xsd:string</span></span>;
  <span class="mbox       lowlight1 top bot"><span class="predicate">foaf:mbox</span> <span class="value-constraint">IRI</span><span class="keyword">+</span></span>
}</pre>

          <!-- JSON example -->
          <pre class="schema json" style="float:left;"><span class="comment">// schema (JSON)</span>
{ "type": "Schema",
  "shapes": {
    <span class="user lowlight2 top bot">"my:UserShape"</span>: { "type": "Shape",
      "expression": { "type": "group",
        "expressions": [
          <span class="name       lowlight1 top">{ "type": "TripleConstraint",                   </span>
          <span class="name       lowlight1    ">  <span class="predicate">"predicate": "foaf:name"</span>,                     </span>
          <span class="name       lowlight1    ">  <span class="value-constraint">"value": {             </span>                       </span>
          <span class="name       lowlight1    ">  <span class="value-constraint">  "type": "NodeConstraint",</span>                       </span>
          <span class="name       lowlight1    ">  <span class="value-constraint">  "datatype": <span class="string lowlight2 top bot">"xsd:string"</span></span>                    </span>
          <span class="name       lowlight1    ">  <span class="value-constraint">}                      </span>                       </span>
          <span class="name       lowlight1 bot">},                                              </span>
          <span class="mbox       lowlight1 top">{ "type": "TripleConstraint",                   </span>
          <span class="mbox       lowlight1    ">  <span class="predicate">"predicate": "foaf:mbox"</span>,                     </span>
          <span class="mbox       lowlight1    ">  <span class="value-constraint">"value": { "type": "NodeConstraint",</span>              </span>
          <span class="mbox       lowlight1    ">  <span class="value-constraint">  "nodeKind": <span class="IRI lowlight2 top bot">"iri"</span>             </span>              </span>
          <span class="mbox       lowlight1    ">  <span class="value-constraint">},                                            </span></span>
          <span class="mbox       lowlight1    ">  <span class="value-constraint oneOrMore lowlight2 top bot">"min": 1, "max": "*"</span>                          </span>
          <span class="mbox       lowlight1 bot">}                                               </span>
        ]
      }
    }
  }
}</pre>
          <div class="verticalDivider"><!-- acts as a divider --></div>
          <div style="float:left;">
          <pre class="instance turtle fail" style="float:left;"><span class="comment"># failing data</span>
<span class="user lowlight2 top bot"><span class="function-name">inst:User4</span></span> <span class="type">foaf:</span><span class="constant">knows</span> <span class="function-name">inst:User2</span> .

<span class="user lowlight2 top bot"><span class="function-name">inst:User2</span></span> <span class="errorSite">a foaf:Person</span> ;
    <span class="label lowlight1 top bot errorSite">rdfs:label      "Robert Smith's person record"</span> ;
    <span class="name lowlight1 top bot"><span class="type">foaf:</span><span class="constant">name</span>       <span class="string">"Bob Smith"</span></span> ;
    <span class="mbox lowlight1 top"><span class="type">foaf:</span><span class="constant">mbox</span>       <span class="fullURL">&lt;mailto:bob@example.org&gt;</span><span class="keyword"></span></span> ;
    <span class="mbox lowlight1 bot"><span class="type">foaf:</span><span class="constant">mbox</span>       <span class="fullURL">&lt;mailto:rs@example.org&gt;</span> <span class="keyword"></span></span>.</pre>
  </div>
          <div style="clear:both;"></div>
      </div>
      <script type="text/javascript">
      <!--
prepareHighlight(["oneOrMore", "IRI", "stateValue", "user"], "highlight2", "lowlight2");
prepareHighlight(["state", "reportedBy", "name", "mbox"], "highlight1", "lowlight1");
      -->
      </script>
      </div>
      <p>
        Only triples with the <code>focus node</code> as a subject are subject to the constraints of <code>closed shapes</code>.
      </p>
        <div class="namespace">
        <div id="closed-shapes-example-3" class="example wrapper">
          <!-- ShExC example -->
          <pre class="schema shexc" style="float:left;"><span class="comment"># schema (ShExC)</span>
<span class="user lowlight2 top bot shape-name">my:UserShape</span> <span class="keyword closed">CLOSED</span> {
  <span class="name       lowlight1 top bot"><span class="predicate">foaf:name</span> <span class="value-constraint">xsd:string</span></span>;
  <span class="mbox       lowlight1 top bot"><span class="predicate">foaf:mbox</span> <span class="value-constraint">IRI</span><span class="keyword">+</span></span>
}</pre>

          <!-- JSON example -->
          <pre class="schema json" style="float:left;"><span class="comment">// schema (JSON)</span>
{ "type": "Schema",
  "shapes": {
    <span class="user lowlight2 top bot">"my:UserShape"</span>: { "type": "Shape",
      "expression": { "type": "group",
        "expressions": [
          <span class="name       lowlight1 top">{ "type": "TripleConstraint",                   </span>
          <span class="name       lowlight1    ">  <span class="predicate">"predicate": "foaf:name"</span>,                     </span>
          <span class="name       lowlight1    ">  <span class="value-constraint">"value": {             </span>                       </span>
          <span class="name       lowlight1    ">  <span class="value-constraint">  "type": "NodeConstraint",</span>                       </span>
          <span class="name       lowlight1    ">  <span class="value-constraint">  "datatype": <span class="string lowlight2 top bot">"xsd:string"</span></span>                    </span>
          <span class="name       lowlight1    ">  <span class="value-constraint">}                      </span>                       </span>
          <span class="name       lowlight1 bot">},                                              </span>
          <span class="mbox       lowlight1 top">{ "type": "TripleConstraint",                   </span>
          <span class="mbox       lowlight1    ">  <span class="predicate">"predicate": "foaf:mbox"</span>,                     </span>
          <span class="mbox       lowlight1    ">  <span class="value-constraint">"value": { "type": "NodeConstraint",</span>              </span>
          <span class="mbox       lowlight1    ">  <span class="value-constraint">  "nodeKind": <span class="IRI lowlight2 top bot">"iri"</span>             </span>              </span>
          <span class="mbox       lowlight1    ">  <span class="value-constraint">},                                            </span></span>
          <span class="mbox       lowlight1    ">  <span class="value-constraint oneOrMore lowlight2 top bot">"min": 1, "max": "*"</span>                          </span>
          <span class="mbox       lowlight1 bot">}                                               </span>
        ]
      }
    }
  }
}</pre>
          <div class="verticalDivider"><!-- acts as a divider --></div>
          <div style="float:left;">
          <pre class="instance turtle" style="float:left;"><span class="comment"># passing data</span>
<span class="user lowlight2 top bot"><span class="function-name">inst:User4</span></span> <span class="type">foaf:</span><span class="constant">knows</span> <span class="function-name">inst:User2</span> .

<span class="user lowlight2 top bot"><span class="function-name">inst:User2</span></span> <span class="errorSite">a foaf:Person</span> ;
    <span class="label lowlight1 top bot errorSite">rdfs:label      "Robert Smith's person record"</span> ;
    <span class="name lowlight1 top bot"><span class="type">foaf:</span><span class="constant">name</span>       <span class="string">"Bob Smith"</span></span> ;
    <span class="mbox lowlight1 top"><span class="type">foaf:</span><span class="constant">mbox</span>       <span class="fullURL">&lt;mailto:bob@example.org&gt;</span><span class="keyword"></span></span> ;
    <span class="mbox lowlight1 bot"><span class="type">foaf:</span><span class="constant">mbox</span>       <span class="fullURL">&lt;mailto:rs@example.org&gt;</span> <span class="keyword"></span></span>.</pre>
  </div>
          <div style="clear:both;"></div>
      </div>
      <script type="text/javascript">
      <!--
prepareHighlight(["oneOrMore", "IRI", "stateValue", "user"], "highlight2", "lowlight2");
prepareHighlight(["state", "reportedBy", "name", "mbox"], "highlight1", "lowlight1");
      -->
      </script>
      </div>
          </section>

          <section id="extra-properties">
            <h4>Allowing Repeated Properties</h4>
            <p>
              As described above in <a href="#additive-properties">Additive Property Declarations</a>, <code>triple constraint</code> constrain all triples with the given predicate to match one of the <code>triple constraints</code>.
              This is called "closing a property".
              It is often useful to open a property to permit instances of it which are not included in the schema.
              Here is a predicate that is closed by some mention of it in an expression:
            </p>
        <div id="extra-properties-example-1" class="example wrapper">
          <!-- ShExC example -->
          <pre class="schema shexc" style="float:left;"><span class="comment"># schema (ShExC)</span>
<span class="shape-name hilight-shapeName lowlight2 top bot">my:IssueShape</span> {
  <span class="state      lowlight1 top bot"><span class="predicate">a</span> [<span class="stateValue lowlight2 top bot value-constraint">ex:Employee</span>]</span>;
  <span class="reportedBy lowlight1 top bot"><span class="predicate">a</span> [<span class="stateValue lowlight2 top bot value-constraint">foaf:Person</span>]</span>
}</pre>

          <!-- JSON example -->
          <pre class="schema json" style="float:left;"><span class="comment">// schema (JSON)</span>
{ "type": "Schema",
  "shapes": {
    <span class="shape-name hilight-shapeName lowlight2 top bot">"my:IssueShape"</span>: { "type": "Shape",
      "expression": { "type": "group",
        "expressions": [
          <span class="state      lowlight1 top">{ "type": "TripleConstraint",                   </span>
          <span class="state      lowlight1    ">  <span class="predicate">"predicate": "rdf:type"</span>,                      </span>
          <span class="state      lowlight1    ">  <span class="value-constraint">"value": { "type": "NodeConstraint",              </span></span>
          <span class="state      lowlight1    ">  <span class="value-constraint">  "values": [ <span class="stateValue lowlight2 top bot value-constraint">"ex:Employee"</span> ]</span></span>
          <span class="state      lowlight1    ">  <span class="value-constraint">}                                             </span></span>
          <span class="state      lowlight1 bot">},                                              </span>
          <span class="reportedBy lowlight1 top">{ "type": "TripleConstraint",                   </span>
          <span class="reportedBy lowlight1    ">  <span class="predicate">"predicate": "ex:reportedBy"</span>,                 </span>
          <span class="reportedBy lowlight1    ">  <span class="value-constraint">"value": { "type": "NodeConstraint",</span>              </span>
          <span class="reportedBy lowlight1    ">  <span class="value-constraint">  "values": [ <span class="stateValue lowlight2 top bot value-constraint">"foaf:Person"</span> ]</span></span>
          <span class="reportedBy lowlight1    ">  <span class="value-constraint">}              </span>                               </span>
          <span class="reportedBy lowlight1 bot">}                                               </span>
        ]
      }
    }
  }
}</pre>
          <div class="verticalDivider"><!-- acts as a divider --></div>
          <div style="float:left;">
          <pre class="instance turtle fail" style="float:left;"><span class="comment"># failing data</span>
<span class="user lowlight2 top bot"><span class="function-name">inst:User4</span></span> <span class="keyword">a</span> <span class="type">foaf:</span><span class="constant">Person</span>, <span class="type">ex:</span><span class="constant">Employee</span>, <span class="errorSite">ex:Manager</span>.</pre>
          </div>
          <div style="clear:both;"></div>
      </div>
            <p style="margin-bottom: 0;">
              The data with the extra
            </p>
            <pre class="instance turtle fail" style="margin: 0 1em;"><span class="user lowlight2 top bot"><span class="function-name">inst:User4</span></span> <span class="keyword">a</span> <span class="errorSite">ex:Manager</span> .</pre>
            <p style="margin-top: 0;">
              arc can accepted by adding rdf:type (or <code class="keyword">a</code>) as an "EXTRA" predicate, permitting any number of additional arcs with that predicate:
            </p>
        <div id="extra-properties-example-2" class="example wrapper">
          <!-- ShExC example -->
          <pre class="schema shexc" style="float:left;"><span class="comment"># schema (ShExC)</span>
<span class="shape-name hilight-shapeName lowlight2 top bot">my:IssueShape</span> EXTRA <span class="keyword">a</span> {
  <span class="state      lowlight1 top bot"><span class="predicate">a</span> [<span class="stateValue lowlight2 top bot value-constraint">ex:Employee</span>]</span>;
  <span class="reportedBy lowlight1 top bot"><span class="predicate">a</span> [<span class="stateValue lowlight2 top bot value-constraint">foaf:Person</span>]</span>
}</pre>

          <!-- JSON example -->
          <pre class="schema json" style="float:left;"><span class="comment">// schema (JSON)</span>
{ "type": "Schema",
  "shapes": {
    <span class="shape-name hilight-shapeName lowlight2 top bot">"my:IssueShape"</span>: { "type": "Shape",
      "expression": { "type": "group",
        "expressions": [
          <span class="state      lowlight1 top">{ "type": "TripleConstraint",                   </span>
          <span class="state      lowlight1    ">  <span class="predicate">"predicate": "rdf:type"</span>,                      </span>
          <span class="state      lowlight1    ">  <span class="value-constraint">"value": { "type": "NodeConstraint",              </span></span>
          <span class="state      lowlight1    ">  <span class="value-constraint">  "values": [ <span class="stateValue lowlight2 top bot value-constraint">"ex:Employee"</span> ]</span></span>
          <span class="state      lowlight1    ">  <span class="value-constraint">}                                             </span></span>
          <span class="state      lowlight1 bot">},                                              </span>
          <span class="reportedBy lowlight1 top">{ "type": "TripleConstraint",                   </span>
          <span class="reportedBy lowlight1    ">  <span class="predicate">"predicate": "ex:reportedBy"</span>,                 </span>
          <span class="reportedBy lowlight1    ">  <span class="value-constraint">"value": { "type": "NodeConstraint",</span>              </span>
          <span class="reportedBy lowlight1    ">  <span class="value-constraint">  "values": [ <span class="stateValue lowlight2 top bot value-constraint">"foaf:Person"</span> ]</span></span>
          <span class="reportedBy lowlight1    ">  <span class="value-constraint">}              </span>                               </span>
          <span class="reportedBy lowlight1 bot">}                                               </span>
        ]
      }
    }
  }
}</pre>
          <div class="verticalDivider"><!-- acts as a divider --></div>
          <div style="float:left;">
          <pre class="instance turtle" style="float:left;"><span class="comment"># passing data</span>
<span class="user lowlight2 top bot"><span class="function-name">inst:User4</span></span> <span class="keyword">a</span> <span class="type">foaf:</span><span class="constant">Person</span>, <span class="type">ex:</span><span class="constant">Employee</span>, <span class="type">ex:</span><span class="constant">Manager</span>.</pre>
          </div>
      </div>
          </section>

      </section>
      
    <section id="structure">
      <h2>ShExC Structure</h2>
      <p>
        We've seen several examples of ShExC.
        Here we'll describe more completely the structure of a ShExC schema.
      </p>
      <section id="Comments">
        <h3>Comments</h3>
        <p>
          As in Turtle, Trig and SPARQL, comments in ShExC are prefixed by a <code class="comment">#</code> character.
          There are <a href="http://stackoverflow.com/questions/244777/can-i-use-comments-inside-a-json-file">no comments in JSON</a>, though there are some <a href="http://stackoverflow.com/questions/244777/can-i-use-comments-inside-a-json-file#answer-18018493">diabolical workarounds leveraging overwritten object keys</a>.
        </p>
        <div class="example wrapper">
        <pre class="schema shexc"><span class="comment"># schema (ShExC)</span>
<span class="shape-name">my:UserShape</span> {                   <span class="comment"># a user has</span>
  (                              <span class="comment">#   either</span>
     <span class="predicate">foaf:name</span> <span class="value-constraint">xsd:string</span>        <span class="comment">#     a full name</span>
    |                            <span class="comment">#   or</span>
      <span class="predicate">foaf:givenName</span> <span class="value-constraint">xsd:string</span><span class="keyword">+</span>;<span class="comment">#     one or more given names</span>
      <span class="predicate">foaf:familyName</span> <span class="value-constraint">xsd:string</span> <span class="comment">#     and a family name</span>
  );                             
  <span class="predicate">foaf:mbox</span> <span class="value-constraint">IRI</span>                  <span class="comment"># and always an mbox.</span>
}</pre>
        <pre class="schema json"><span class="comment"># schema (JSON)</span>
{ <span class="shape-name">"my:UserShape"</span>: {                     <span class="comment">"type": "a user has"</span>,
  "type": "Shape",
    "expression": { "type": "group",
      "expressions": [
        {                               <span class="comment">"type": "  either"</span>
          "type": "OneOf",
          "expressions": [
            {                           <span class="comment">"type": "    a full name"</span>
              "type": "TripleConstraint", <span class="predicate">"predicate": "foaf:name"</span>,        
              <span class="predicate">"value": { "type": "NodeConstraint", "datatype": "xsd:string" }</span>
             },
            {                           <span class="comment">"type": "  or"</span>
              "type": "group",
              "expressions": [
                {                       <span class="comment">"type": "    one or more given names"</span>
                  "type": "TripleConstraint", <span class="predicate">"predicate": "foaf:givenName"</span>,  
                  <span class="predicate">"value": { "type": "NodeConstraint", "datatype": "xsd:string" }</span>,
                  "min": 1, "max": "*"
                },                                     
                {                       <span class="comment">"type": "    and a family name"</span>
                  "type": "TripleConstraint", <span class="predicate">"predicate": "foaf:familyName"</span>,  
                  <span class="predicate">"value": { "type": "NodeConstraint", "datatype": "xsd:string" }</span>
                }
              ]
            }
          ]
        },
        {                               <span class="comment">"type": "and always an mbox."</span>
          "type": "TripleConstraint", <span class="predicate">"predicate": "foaf:mbox"</span>, 
          <span class="predicate">"value": { "type": "NodeConstraint", "datatype": "IRI" }</span>
        }
      ]
    }
  }
}</pre>
        </div>
      </section>

      <section id="RDF-terms">
        <h3>RDF Terms</h3>
        <p>
          The terms ("terminals", to a language geek) in ShEx are the same as <a href="http://www.w3.org/TR/turtle/#h3_sec-parsing-terms">those in Turtle</a>.
          The following list summarizes which terminals are allows where in the <a href="http://www.w3.org/2005/01/yacker/uploads/ShEx3?lang=perl&amp;markup=html#productions">ShEx grammar</a>:
        </p>
        <ul>
          <li><code>Shape labels</code> (seen in <a class="ref" href="#shape-declaration">shape declaration</a> and <a class="ref" href="#value-shape">value shapes</a>) are IRIs or blank nodes.</li>
          <li><code>Constraint labels</code> (see <a class="ref" href="#value-class-definition">value class definitions</a> and <a class="ref" href="#value-class-reference">value class references</a> described below in <a href="#labeled-constraints">Labeled Constraints</a>) are also IRIs or blank nodes.</li>
          <li>Predicates are IRIs (reflecting a restriction in RDF that predicates are IRIs).
          As in other RDF languages, the keyword <code class="keyword">a</code> is shorthand for <code>rdf:type</code>.
          </li>
          <li><code>Literal datatypes</code> are IRIs.</li>
        </ul>
        <p>
          IRIs are parsed as they are in Turtle, respecting the current <a href="http://www.w3.org/TR/turtle/#prefixed-name">namespace prefix mapping</a> and <a href="http://www.w3.org/TR/turtle/#relative-iri">base</a> directives.
        </p>
        <p class="note">An additional non-RDF term called a <code>stem</code> appears in <a class="ref" href="#value-sets">value sets</a>.</p>
      </section>

      <section id="labeled-constraints">
        <h3>Labeled Constraints</h3>
        <div class="namespace">
          <p>
            It may be convenient to factor out the value constraints for instance if they are referenced more than once.
            ShExC's <code id="value-class-definition">value class definitions</code> permit one to write a definition and reference it in <code id="value-class-reference">value class references</code>.
            Here, both <span class="hilight-reproducedBy lowlight2 top bot"><span class="type">ex:</span><span class="constant">reproducedBy</span></span> and <span class="hilight-assignedTo lowlight2 top bot"><span class="type">ex:</span><span class="constant">assignedTo</span></span> are value class references to <span class="constraint-name hilight-employeeConstraint lowlight2 top bot">$my:EmployeeConstraint</span>, which asserts that the object is an IRI matching a specific pattern, and which matches <span class="shape-name hilight-EmployeeShape lowlight2 top bot">my:EmployeeShape</span>.
          </p>

          <div class="example wrapper">
            <!-- ShExC example -->
            <pre class="schema shexc" style="float:left;"><span class="comment"># schema (ShExC)</span>
<span class="hilight-employeeConstraint lowlight2 top"><span class="value-constraint"><span class="constraint-name">$my:EmployeeConstraint</span> =</span>                </span>
<span class="hilight-employeeConstraint lowlight2    ">  IRI </span><span class="shape-name hilight-EmployeeShape lowlight2 top bot">@my:EmployeeShape</span><span class="hilight-employeeConstraint lowlight2    ">                 </span>
<span class="hilight-employeeConstraint lowlight2 bot">  /<span class="string">^http://hr.example/id#[0-9]+</span>/</span>

<span class="shape-name">my:IssueShape</span> {
  <span class="predicate">ex:state</span> [<span class="value-constraint">ex:accepted ex:resolved</span>];
  <span class="hilight-reproducedBy lowlight2 top bot new"><span class="predicate">ex:reproducedBy</span></span> <span class="constraint-name hilight-employeeConstraint hilight-reproducedBy lowlight2 top bot">$my:EmployeeConstraint</span>;
  <span class="hilight-assignedTo lowlight2 top bot new"><span class="predicate">ex:assignedTo</span></span> <span class="constraint-name hilight-employeeConstraint hilight-assignedTo lowlight2 top bot">$my:EmployeeConstraint</span>
}

<span class="hilight-EmployeeShape lowlight2 top"><span class="shape-name">my:EmployeeShape</span> {                        </span>
<span class="hilight-EmployeeShape lowlight2    ">  <span class="predicate">foaf:name</span> <span class="value-constraint">xsd:string</span>;                   </span>
<span class="hilight-EmployeeShape lowlight2    ">  <span class="predicate">ex:department</span> [<span class="value-constraint">ex:ProgrammingDepartment</span>]</span>
<span class="hilight-EmployeeShape lowlight2 bot">}                                         </span>
</pre>

            <!-- JSON example -->
            <pre class="schema json" style="float:left;"><span class="comment">// schema (JSON)</span>
{
  "my:IssueShape": { "type": "Shape",
    "expression": { "type": "group",
      "expressions": [
        { "type": "TripleConstraint", <span class="predicate">"predicate": "ex:state"</span>,
          <span class="value-constraint">"value": { "type": "NodeConstraint", "values": [ "ex:accepted", "ex:resolved" ]</span> }
        },
        { "type": "TripleConstraint", <span class="predicate">"predicate": "ex:reproducedBy"</span>,
          <span class="value-constraint">"value": { "type": "ShapeRef", <span class="hilight-reproducedBy lowlight2 top bot">"reference": "my:TesterShape"</span></span> }
        },
        { "type": "TripleConstraint", <span class="predicate">"predicate": "ex:assignedTo"</span>,
          <span class="value-constraint">"value": { "type": "ShapeRef", <span class="hilight-assignedTo lowlight2 top bot">"reference": "my:EmployeeShape"</span></span> }
        }
      ]
    }
  },
  <span class="hilight-reproducedBy hilight-assignedTo lowlight2 top">"my:EmployeeShape": { "type": "Shape",                                   </span>
  <span class="hilight-reproducedBy hilight-assignedTo lowlight2    ">  "expression": { "type": "group",                                       </span>
  <span class="hilight-reproducedBy hilight-assignedTo lowlight2    ">    "expressions": [                                                     </span>
  <span class="hilight-reproducedBy hilight-assignedTo lowlight2    ">      { "type": "TripleConstraint", <span class="predicate">"predicate": "foaf:name"</span>,            </span>
  <span class="hilight-reproducedBy hilight-assignedTo lowlight2    ">        <span class="value-constraint">"value": { "type": "NodeConstraint", "datatype": "xsd:string" }</span>      </span>
  <span class="hilight-reproducedBy hilight-assignedTo lowlight2    ">      },                                                                 </span>
  <span class="hilight-reproducedBy hilight-assignedTo lowlight2    ">      { "type": "TripleConstraint", <span class="predicate">"predicate": "ex:department"</span>,        </span>
  <span class="hilight-reproducedBy hilight-assignedTo lowlight2    ">        <span class="value-constraint">"value": { "type": "NodeConstraint", "values": [ "ex:Programming" ] }</span></span>
  <span class="hilight-reproducedBy hilight-assignedTo lowlight2    ">      }                                                                  </span>
  <span class="hilight-reproducedBy hilight-assignedTo lowlight2    ">    ]                                                                    </span>
  <span class="hilight-reproducedBy hilight-assignedTo lowlight2    ">  }                                                                      </span>
  <span class="hilight-reproducedBy hilight-assignedTo lowlight2 bot">}                                                                        </span>
}</pre>
            <div class="verticalDivider"><!-- acts as a divider --></div>
            <div style="float:left;">
              <pre class="instance turtle"><span class="comment"># passing data</span>
<span class="type">inst:</span><span class="constant">Issue1</span>
  <span class="type">ex:</span><span class="constant">state</span> <span class="type">ex:</span><span class="constant">accepted</span> ;
  <span class="type">ex:</span><span class="constant">reproducedBy</span> <span class="hilight-reproducedBy lowlight2 top bot"><span class="function-name">http://hr.example/id#123</span></span> ;
  <span class="type">ex:</span><span class="constant">assignedTo</span> <span class="hilight-assignedTo lowlight2 top bot"><span class="function-name">http://hr.example/id#456</span></span> .

<span class="hilight-reproducedBy lowlight2 top"><span class="function-name">http://hr.example/id#123</span>                  </span>
<span class="hilight-reproducedBy lowlight2    ">  <span class="type">foaf:</span><span class="constant">name</span> <span class="type">xsd:</span><span class="constant">string</span> ;                  </span>
<span class="hilight-reproducedBy lowlight2 bot">  <span class="type">ex:</span><span class="constant">department</span> <span class="type">ex:</span><span class="constant">ProgrammingDepartment</span> .</span>

<span class="hilight-assignedTo lowlight2 top"><span class="function-name">http://hr.example/id#456</span>                  </span>
<span class="hilight-assignedTo lowlight2    ">  <span class="type">foaf:</span><span class="constant">name</span> <span class="type">xsd:</span><span class="constant">string</span> ;                  </span>
<span class="hilight-assignedTo lowlight2 bot">  <span class="type">ex:</span><span class="constant">department</span> <span class="type">ex:</span><span class="constant">ProgrammingDepartment</span> .</span></pre>
              <div></div>
              <pre class="instance turtle fail"><span class="comment"># failing data</span>
<span class="type">inst:</span><span class="constant">Issue1</span>
  <span class="type">ex:</span><span class="constant">state</span> <span class="type">ex:</span><span class="constant">accepted</span> ;
  <span class="type">ex:</span><span class="constant">reproducedBy</span> <span class="hilight-reproducedBy lowlight2 top bot"><span class="function-name">http://hr.example/id#123</span></span> ;
  <span class="type">ex:</span><span class="constant">assignedTo</span> <span class="hilight-assignedTo lowlight2 top bot"><span class="function-name">http://hr.example/id#<span class="errorSite">abc</span></span></span> .

<span class="hilight-reproducedBy lowlight2 top"><span class="function-name">http://hr.example/id#123</span>                  </span>
<span class="hilight-reproducedBy lowlight2    ">  <span class="type">foaf:</span><span class="constant">name</span> <span class="type">xsd:</span><span class="constant">string</span> ;                  </span>
<span class="hilight-reproducedBy lowlight2 bot">  <span class="type">ex:</span><span class="constant">department</span> <span class="type">ex:</span><span class="constant">ProgrammingDepartment</span> .</span>

<span class="hilight-assignedTo lowlight2 top"><span class="function-name">http://hr.example/id#abc</span>         </span>
<span class="hilight-assignedTo lowlight2    ">  <span class="type">foaf:</span><span class="constant">name</span> <span class="type">xsd:</span><span class="constant">string</span> ;         </span>
<span class="hilight-assignedTo lowlight2 bot">  <span class="type">ex:</span><span class="constant">department</span> <span class="errorSite">ex:HRDepartment</span> .</span></pre>
            </div>

            <script type="text/javascript">
            <!--
prepareHighlight(["hilight-reproducedBy", "hilight-assignedTo", "hilight-employeeConstraint", "hilight-EmployeeShape"], "highlight2", "lowlight2");
            -->
            </script>
          </div>
        </div>
      </section>
    </section>

        <section id="additive-properties">
          <h3>Additive Property Declarations</h3>
          <div class="namespace">
            <p>
              The use of generic predicates sometimes leads to their being used multiple times in the same shape.
              In this example, we want to make sure that an issue that is <span class="type">ex:</span><span class="constant">accepted</span> or <span class="type">ex:</span><span class="constant">resolved</span> has been reproduced by a <span class="hilight-tester lowlight2 top bot">tester</span> and a <span class="hilight-programmer lowlight2 top bot">programmer</span>:
            </p>

            <div class="example wrapper">
              <!-- ShExC example -->
              <pre class="schema shexc" style="float:left;"><span class="comment"># schema (ShExC)</span>
<span class="shape-name">my:IssueShape</span> {
  <span class="predicate">ex:state</span> [<span class="value-constraint">ex:accepted ex:resolved</span>];
  <span class="predicate">ex:reproducedBy</span> <span class="hilight-tester lowlight2 top bot new"><span class="value-constraint">@<span class="shape-name">my:TesterShape</span></span></span>;    <span class="comment"># Make sure it's checked by testing</span>
  <span class="predicate">ex:reproducedBy</span> <span class="hilight-programmer lowlight2 top bot new"><span class="value-constraint">@<span class="shape-name">my:ProgrammerShape</span></span></span> <span class="comment"># and by a programmer.</span>
}

<span class="hilight-tester lowlight2 top"><span class="shape-name">my:TesterShape</span> {          </span>
<span class="hilight-tester lowlight2    ">  <span class="predicate">foaf:name</span> <span class="value-constraint">xsd:string</span>;   </span>
<span class="hilight-tester lowlight2    ">  <span class="predicate">ex:role</span> [<span class="value-constraint">ex:testingRole</span>]</span>
<span class="hilight-tester lowlight2 bot">}                         </span>

<span class="hilight-programmer lowlight2 top"><span class="shape-name">my:ProgrammerShape</span> {                      </span>
<span class="hilight-programmer lowlight2    ">  <span class="predicate">foaf:name</span> <span class="value-constraint">xsd:string</span>;                   </span>
<span class="hilight-programmer lowlight2    ">  <span class="predicate">ex:department</span> [<span class="value-constraint">ex:ProgrammingDepartment</span>]</span>
<span class="hilight-programmer lowlight2 bot">}                                         </span>
</pre>

              <!-- JSON example -->
              <pre class="schema json" style="float:left;"><span class="comment">// schema (JSON)</span>
{
  "my:IssueShape": { "type": "Shape",
    "expression": { "type": "group",
      "expressions": [
        { "type": "TripleConstraint", <span class="predicate">"predicate": "ex:state"</span>,
          <span class="value-constraint">"value": { "type": "NodeConstraint", "values": [ "ex:accepted", "ex:resolved" ]</span> }
        },
        { "type": "TripleConstraint", <span class="predicate">"predicate": "ex:reproducedBy"</span>,
          <span class="value-constraint">"value": { "type": "ShapeRef", <span class="hilight-tester lowlight2 top bot">"reference": "my:TesterShape"</span></span> }
        },
        { "type": "TripleConstraint", <span class="predicate">"predicate": "ex:reproducedBy"</span>,
          <span class="value-constraint">"value": { "type": "ShapeRef", <span class="hilight-programmer lowlight2 top bot">"reference": "my:ProgrammerShape"</span></span> }
        }
      ]
    }
  },
  <span class="hilight-tester lowlight2 top">"my:TesterShape": { "type": "Shape",                                     </span>
  <span class="hilight-tester lowlight2    ">  "expression": { "type": "group",                                       </span>
  <span class="hilight-tester lowlight2    ">    "expressions": [                                                     </span>
  <span class="hilight-tester lowlight2    ">      { "type": "TripleConstraint", <span class="predicate">"predicate": "foaf:name"</span>,            </span>
  <span class="hilight-tester lowlight2    ">        <span class="value-constraint">"value": { "type": "NodeConstraint", "datatype": "xsd:string" }</span>      </span>
  <span class="hilight-tester lowlight2    ">      },                                                                 </span>
  <span class="hilight-tester lowlight2    ">      { "type": "TripleConstraint", <span class="predicate">"predicate": "ex:role"</span>,              </span>
  <span class="hilight-tester lowlight2    ">        <span class="value-constraint">"value": { "type": "NodeConstraint", "values": [ "ex:testingRole" ] }</span></span>
  <span class="hilight-tester lowlight2    ">      }                                                                  </span>
  <span class="hilight-tester lowlight2    ">    ]                                                                    </span>
  <span class="hilight-tester lowlight2    ">  }                                                                      </span>
  <span class="hilight-tester lowlight2 bot">},                                                                       </span>
  <span class="hilight-programmer lowlight2 top">"my:ProgrammerShape": { "type": "Shape",                                 </span>
  <span class="hilight-programmer lowlight2    ">  "expression": { "type": "group",                                       </span>
  <span class="hilight-programmer lowlight2    ">    "expressions": [                                                     </span>
  <span class="hilight-programmer lowlight2    ">      { "type": "TripleConstraint", <span class="predicate">"predicate": "foaf:name"</span>,            </span>
  <span class="hilight-programmer lowlight2    ">        <span class="value-constraint">"value": { "type": "NodeConstraint", "datatype": "xsd:string" }</span>      </span>
  <span class="hilight-programmer lowlight2    ">      },                                                                 </span>
  <span class="hilight-programmer lowlight2    ">      { "type": "TripleConstraint", <span class="predicate">"predicate": "ex:department"</span>,        </span>
  <span class="hilight-programmer lowlight2    ">        <span class="value-constraint">"value": { "type": "NodeConstraint", "values": [ "ex:Programming" ] }</span></span>
  <span class="hilight-programmer lowlight2    ">      }                                                                  </span>
  <span class="hilight-programmer lowlight2    ">    ]                                                                    </span>
  <span class="hilight-programmer lowlight2    ">  }                                                                      </span>
  <span class="hilight-programmer lowlight2 bot">}                                                                        </span>
}</pre>
              <div class="verticalDivider"><!-- acts as a divider --></div>
              <div style="float:left;">
              <pre class="instance turtle"><span class="comment"># passing data</span>
<span class="type">inst:</span><span class="constant">Issue1</span>
  <span class="type">ex:</span><span class="constant">state</span> <span class="type">ex:</span><span class="constant">accepted</span> ;
  <span class="type">ex:</span><span class="constant">reproducedBy</span> <span class="hilight-tester lowlight2 top bot"><span class="type">inst:</span><span class="constant">Tester2</span></span> ;
  <span class="type">ex:</span><span class="constant">reproducedBy</span> <span class="hilight-programmer lowlight2 top bot"><span class="type">inst:</span><span class="constant">Programmer3</span></span> .

<span class="hilight-tester lowlight2 top"><span class="type">inst:</span><span class="constant">Tester2</span>              </span>
<span class="hilight-tester lowlight2    ">  <span class="type">foaf:</span><span class="constant">name</span> <span class="type">xsd:</span><span class="constant">string</span> ;  </span>
<span class="hilight-tester lowlight2 bot">  <span class="type">ex:</span><span class="constant">role</span> <span class="type">ex:</span><span class="constant">testingRole</span> .</span>

<span class="hilight-programmer lowlight2 top"><span class="type">inst:</span><span class="constant">Programmer3</span>                          </span>
<span class="hilight-programmer lowlight2    ">  <span class="type">foaf:</span><span class="constant">name</span> <span class="type">xsd:</span><span class="constant">string</span> ;                  </span>
<span class="hilight-programmer lowlight2 bot">  <span class="type">ex:</span><span class="constant">department</span> <span class="type">ex:</span><span class="constant">ProgrammingDepartment</span> .</span></pre>
              <div></div>
              <pre class="instance turtle fail"><span class="comment"># failing data</span>
<span class="type">inst:</span><span class="constant">Issue1</span>
  <span class="type">ex:</span><span class="constant">state</span> <span class="type">ex:</span><span class="constant">accepted</span> ;
  <span class="type">ex:</span><span class="constant">reproducedBy</span> <span class="hilight-tester lowlight2 top"><span class="type">inst:</span><span class="constant">Tester2</span></span> ;
  <span class="type">ex:</span><span class="constant">reproducedBy</span> <span class="hilight-tester lowlight2 bot"><span class="type">inst:</span><span class="constant">Tester4</span></span> .

<span class="hilight-tester lowlight2 top"><span class="type">inst:</span><span class="constant">Tester2</span>              </span>
<span class="hilight-tester lowlight2    ">  <span class="type">foaf:</span><span class="constant">name</span> <span class="type">xsd:</span><span class="constant">string</span> ;  </span>
<span class="hilight-tester lowlight2 bot">  <span class="type">ex:</span><span class="constant">role</span> <span class="type">ex:</span><span class="constant">testingRole</span> .</span>

<span class="hilight-tester lowlight2 top"><span class="type">inst:</span><span class="constant">Tester4</span>              </span>
<span class="hilight-tester lowlight2    ">  <span class="type">foaf:</span><span class="constant">name</span> <span class="type">xsd:</span><span class="constant">string</span> ;  </span>
<span class="hilight-tester lowlight2 bot">  <span class="type">ex:</span><span class="constant">role</span> <span class="type">ex:</span><span class="constant">testingRole</span> .</span></pre>
              </div>

            <script type="text/javascript">
            <!--
prepareHighlight(["hilight-tester", "hilight-programmer"], "highlight2", "lowlight2");
            -->
            </script>
          </div>

  		    <section id="partition-complexity">
  			    <h4>Partition Complexity</h4>
            <p>
              ShEx uses a partitioning strategy to find a solution whereby triples in the data are assigned to triple constraints in the schema.
              It is possible to construct schemas for which it is quite expensive to find a mapping from triple to triple constraint which satisfies the schema.
              In practical schemas, this is rarely a concearn as the search space is quite small, however, certain mistakes in a schema can create a large search space.
            </p>
            <ul>
              <li>
                Accidentally duplicating many triple constraints in a shape causes the search space to explode.
                If you notice a validation process taking a long time or a lot of memory, look for duplicated chunks of the schema.
              </li>
              <li>
                For shapes with multiple triple constraints for the same predicate, try to minimize the overlap between the value expressions.
                For instance, if three types of inspection are necessary on a manufacturing checklist, use three different constraints for each of the inspection proprerties rather than requiring three different inspection properties with a value expression which is a union of all three types.
                This will make the validation process more efficient as well as capturing more of the business logic in the schema.
              </li>
            </ul>
          </section>
          <p>
          </p>
          <div class="namespace">

              <div class="issue" style="clear:both;">
              <p>
                There are two proposed strategies for validation:
              </p>
              <ul>
                <li>
                  <code>partition</code> - no triple can be used to satisfy more than one constraint.
                </li>
                <li>
                  <code>conjunction</code> - triples are allowed to satisfy more than one constraint.
                </li>
              </ul>
              <p>
                These two strategies are equivalent when no triple satisfies more than one constraint.
    In the example above, depending on the strategy being used, someone acting as <span class="hilight-testgrammer lowlight2 top bot">both a programmer and a tester</span> might or might not allow to satisfy the schema.
              </p>

              <p>
                Below are three variants of the example above.
                These each fail when evaluated by one of the strategies.
                Below each example is a workaround which works for the failing validation strategy.
              </p>
              <div style="float:left; max-width: 32%">
                <p>One individual acting as both tester and programmer.</p>
              <pre class="instance turtle">
<span class="type">inst:</span><span class="constant">Issue1</span>
  <span class="type">ex:</span><span class="constant">state</span> <span class="type">ex:</span><span class="constant">accepted</span> ;
  <span class="type">ex:</span><span class="constant">reproducedBy</span> <span class="hilight-testgrammer lowlight2 top bot"><span class="type">inst:</span><span class="constant">Testgrammer23</span></span> .

<span class="hilight-testgrammer lowlight2 top"><span class="type">inst:</span><span class="constant">Testgrammer23</span>                        </span>
<span class="hilight-testgrammer lowlight2    ">  <span class="type">foaf:</span><span class="constant">name</span> <span class="type">xsd:</span><span class="constant">string</span> ;                  </span>
<span class="hilight-testgrammer lowlight2    ">  <span class="type">ex:</span><span class="constant">role</span> <span class="type">ex:</span><span class="constant">testingRole</span> ;                </span>
<span class="hilight-testgrammer lowlight2 bot">  <span class="type">ex:</span><span class="constant">department</span> <span class="type">ex:</span><span class="constant">ProgrammingDepartment</span> .</span></pre>
              <p>fails <code>partition</code>, <span class="hilight-workaround1 lowlight2 top bot">workaround</span> is:</p>
              <pre class="schema shexc"><span class="comment"># schema (ShExC)</span>
<span class="shape-name">my:IssueShape</span> {
  <span class="predicate">ex:state</span> [<span class="value-constraint">ex:accepted ex:resolved</span>];
  ( <span class="predicate">ex:reproducedBy</span> <span class="value-constraint">@<span class="shape-name">my:TesterShape</span></span>;
    <span class="predicate">ex:reproducedBy</span> <span class="value-constraint">@<span class="shape-name">my:ProgrammerShape</span></span>
  <span class="hilight-workaround1 lowlight2 top new">| <span class="predicate">ex:reproducedBy</span> <span class="value-constraint">@<span class="shape-name">my:TesterShape</span>    </span></span>
  <span class="hilight-workaround1 lowlight2 bot new">              <span class="value-constraint">AND @<span class="shape-name">my:ProgrammerShape</span></span></span>
  )
}
</pre>
              <!-- JSON example -->
              <pre class="schema json todo">TODO</pre>
              </div>
              <div style="float:left; max-width: 32%">
                <p>
                  One individual acts can be both a tester and a programmer, another is only a tester.
                </p>
              <pre class="instance turtle"><span class="comment"># one tester and one combination </span>
<span class="type">inst:</span><span class="constant">Issue1</span>
  <span class="type">ex:</span><span class="constant">state</span> <span class="type">ex:</span><span class="constant">accepted</span> ;
  <span class="type">ex:</span><span class="constant">reproducedBy</span> <span class="type">inst:</span><span class="constant">Tester2</span> ;
  <span class="type">ex:</span><span class="constant">reproducedBy</span> <span class="hilight-testgrammer lowlight2 top bot"><span class="type">inst:</span><span class="constant">Testgrammer23</span></span> .

<span class="type">inst:</span><span class="constant">Tester2</span>              
  <span class="type">foaf:</span><span class="constant">name</span> <span class="type">xsd:</span><span class="constant">string</span> ;  
  <span class="type">ex:</span><span class="constant">role</span> <span class="type">ex:</span><span class="constant">testingRole</span> .

<span class="hilight-testgrammer lowlight2 top"><span class="type">inst:</span><span class="constant">Testgrammer23</span>                        </span>
<span class="hilight-testgrammer lowlight2    ">  <span class="type">foaf:</span><span class="constant">name</span> <span class="type">xsd:</span><span class="constant">string</span> ;                  </span>
<span class="hilight-testgrammer lowlight2    ">  <span class="type">ex:</span><span class="constant">role</span> <span class="type">ex:</span><span class="constant">testingRole</span> ;                </span>
<span class="hilight-testgrammer lowlight2 bot">  <span class="type">ex:</span><span class="constant">department</span> <span class="type">ex:</span><span class="constant">ProgrammingDepartment</span> .</span></pre>
              <p>fails <code>conjunction</code>, <span class="hilight-workaround2 lowlight2 top bot">workaround</span> is:</p>
              <pre class="schema shexc"><span class="comment"># schema (ShExC)</span>
<span class="shape-name">my:IssueShape</span> {
  <span class="predicate">ex:state</span> [<span class="value-constraint">ex:accepted ex:resolved</span>];
  ( <span class="predicate">ex:reproducedBy</span> <span class="value-constraint">@<span class="shape-name">my:TesterShape</span></span>;
    <span class="predicate">ex:reproducedBy</span> <span class="value-constraint">@<span class="shape-name">my:ProgrammerShape</span></span>
  <span class="hilight-workaround2 lowlight2 top new">| <span class="predicate">ex:reproducedBy</span> <span class="value-constraint">@<span class="shape-name">my:TesterShape</span></span>    </span>
  <span class="hilight-workaround2 lowlight2     new">          <span class="value-constraint">AND NOT @<span class="shape-name">my:ProgrammerShape</span></span></span>
  <span class="hilight-workaround2 lowlight2     new">  <span class="predicate">ex:reproducedBy</span> @<span class="shape-name">my:TesterShape</span>    </span>
  <span class="hilight-workaround2 lowlight2     new">              <span class="value-constraint">AND @<span class="shape-name">my:ProgrammerShape</span></span></span>
  <span class="hilight-workaround2 lowlight2     new">| <span class="predicate">ex:reproducedBy</span> <span class="value-constraint">@<span class="shape-name">my:ProgrammerShape</span></span></span>
  <span class="hilight-workaround2 lowlight2     new">          <span class="value-constraint">AND NOT @<span class="shape-name">my:TesterShape</span></span>    </span>
  <span class="hilight-workaround2 lowlight2     new">  <span class="predicate">ex:reproducedBy</span> @<span class="shape-name">my:ProgrammerShape</span></span>
  <span class="hilight-workaround2 lowlight2 bot new">              <span class="value-constraint">AND @<span class="shape-name">my:TesterShape</span></span>    </span>
  )
}
</pre>
              <!-- JSON example -->
              <pre class="schema json todo">TODO</pre>
              </div>
              <div style="float:left; max-width: 32%">
                <p>
                  Two individuals can act as both a tester and a programmer.
                </p>
              <pre class="instance turtle"><span class="comment"># two combinations</span>
<span class="type">inst:</span><span class="constant">Issue1</span>
  <span class="type">ex:</span><span class="constant">state</span> <span class="type">ex:</span><span class="constant">accepted</span> ;
  <span class="type">ex:</span><span class="constant">reproducedBy</span> <span class="hilight-testgrammer lowlight2 top"><span class="type">inst:</span><span class="constant">Testgrammer23</span></span> ;
  <span class="type">ex:</span><span class="constant">reproducedBy</span> <span class="hilight-testgrammer lowlight2 bot"><span class="type">inst:</span><span class="constant">Testgrammer45</span></span> .

<span class="type">inst:</span><span class="constant">Testgrammer23</span>                        
  <span class="type">foaf:</span><span class="constant">name</span> <span class="type">xsd:</span><span class="constant">string</span> ;                  
  <span class="type">ex:</span><span class="constant">role</span> <span class="type">ex:</span><span class="constant">testingRole</span> ;                
  <span class="type">ex:</span><span class="constant">department</span> <span class="type">ex:</span><span class="constant">ProgrammingDepartment</span> .

<span class="hilight-testgrammer lowlight2 top"><span class="type">inst:</span><span class="constant">Testgrammer45</span>                        </span>
<span class="hilight-testgrammer lowlight2    ">  <span class="type">foaf:</span><span class="constant">name</span> <span class="type">xsd:</span><span class="constant">string</span> ;                  </span>
<span class="hilight-testgrammer lowlight2    ">  <span class="type">ex:</span><span class="constant">role</span> <span class="type">ex:</span><span class="constant">testingRole</span> ;                </span>
<span class="hilight-testgrammer lowlight2 bot">  <span class="type">ex:</span><span class="constant">department</span> <span class="type">ex:</span><span class="constant">ProgrammingDepartment</span> .</span></pre>
              <p>fails <code>conjunction</code>, <span class="hilight-workaround3 lowlight2 top bot">workaround</span> is:</p>
              <pre class="schema shexc"><span class="comment"># schema (ShExC)</span>
<span class="shape-name">my:IssueShape</span> {
  <span class="predicate">ex:state</span> [<span class="value-constraint">ex:accepted ex:resolved</span>];
  ( <span class="predicate">ex:reproducedBy</span> <span class="value-constraint">@<span class="shape-name">my:TesterShape</span></span>;
    <span class="predicate">ex:reproducedBy</span> <span class="value-constraint">@<span class="shape-name">my:ProgrammerShape</span></span>
  <span class="hilight-workaround3 lowlight2 top new">| <span class="predicate">ex:reproducedBy</span> <span class="value-constraint">@<span class="shape-name">my:TesterShape</span></span>       </span>
  <span class="hilight-workaround3 lowlight2 bot new">              <span class="value-constraint">AND @<span class="shape-name">my:ProgrammerShape</span>{2}</span></span>
  )
}
</pre>
              </div>

              <p style="clear:both;" class="TODO">
                The behavior in these cases currently uses the <code>partition</code> strategy. 
                Please send feedback to <a href="mailto:public-shex@w3.org">public-shex@w3.org</a> with advice and use cases, if the <code>conjunction</code> strategy is better suited for your use cases.
              </p>
            </div>

            </div>
            <script type="text/javascript">
            <!--
prepareHighlight(["hilight-tester", "hilight-programmer", "hilight-testgrammer", "hilight-workaround1", "hilight-workaround2", "hilight-workaround3"], "highlight2", "lowlight2");
            -->
            </script>
          </div>
        </section>

    <section id="semact">
      <h2>Semantic Actions</h2>
      <p>
        <code>Semantic actions</code> are pieces of arbitrary code attached to expressions in a shape.
        They can be used to signal a validation failure or perform operations with side effects.
        (The name "semantic action" comes from their serving a same role as semantic actions in parsers like Antlr or Yacc.)
        Below is an example from a standard extension called "<a href="http://shex.io/extensions/Test/">Test</a>" which can only <code class="code">print(msg)</code> or <code class="code">fail(msg)</code>:
      </p>
        <div id="simple-expressions-example-1" class="example wrapper">
          <!-- ShExC example -->
          <pre class="schema shexc" style="float:left;"><span class="comment"># schema (ShExC)</span>
<span class="shape-name hilight-shapeName lowlight2 top bot">my:IssueShape</span> {
  <span class="state      lowlight1 top bot"><span class="predicate">ex:state</span> [<span class="stateValue lowlight2 top bot value-constraint">ex:unassigned ex:assigned</span>]</span>;
  <span class="reportedBy lowlight1 top bot"><span class="predicate">ex:reportedBy</span> <span class="value-constraint">@</span><span class="user lowlight2 top bot shape-name">my:UserShape</span></span>
}

<span class="shape-name">my:UserShape</span> {
  <span class="eitherOr   lowlight2 top">(                              </span>
     <span class="name       lowlight1 top bot"><span class="predicate">foaf:name</span> <span class="value-constraint">xsd:string</span></span> <span class="code">%test:{ print(o) %}</span>
  <span class="eitherOr   lowlight2 bot">                               </span>
  <span class="eitherOr   lowlight2 top">  |                            </span>
      <span class="gname      lowlight1 top bot"><span class="predicate">foaf:givenName</span> <span class="value-constraint">xsd:string</span>+</span>;
      <span class="fname      lowlight1 top bot"><span class="predicate">foaf:familyName</span> <span class="value-constraint">xsd:string</span></span> <span class="code">%test:{ fail("doomed") %}</span>
  <span class="eitherOr   lowlight2 bot">);                             </span>
  <span class="mbox       lowlight1 top bot"><span class="predicate">foaf:mbox</span> <span class="value-constraint">IRI</span></span>
}</pre>

          <!-- JSON example -->
          <pre class="schema json" style="float:left;"><span class="comment">// schema (JSON)</span>
{ "type": "Schema",
  "shapes": {
    <span class="shape-name hilight-shapeName lowlight2 top bot">"my:IssueShape"</span>: { "type": "Shape",
      "expression": { "type": "group",
        "expressions": [
          <span class="state      lowlight1 top">{ "type": "TripleConstraint", <span class="predicate">"predicate": "ex:state"</span>,</span>
          <span class="state      lowlight1    ">  <span class="value-constraint">"value": { "type": "NodeConstraint",              </span></span>
          <span class="state      lowlight1    ">  <span class="value-constraint">  "values": [ <span class="stateValue lowlight2 top bot value-constraint">"ex:unassigned", "ex:assigned"</span> ]</span></span>
          <span class="state      lowlight1    ">  <span class="value-constraint">}                                             </span></span>
          <span class="state      lowlight1 bot">},                                              </span>
          <span class="reportedBy lowlight1 top">{ "type": "TripleConstraint", <span class="predicate">"predicate": "ex:reportedBy"</span>,</span>
          <span class="reportedBy lowlight1    ">  <span class="value-constraint">"value": { "type": "ShapeRef",</span> <span class="value-constraint">"reference": <span class="user lowlight2 top bot">"my:UserShape"</span></span> }</span>
          <span class="reportedBy lowlight1 bot">}                                               </span>
        ]
      }
    },
    <span class="shape-name">"my:UserShape"</span>: { "type": "Shape",
      "expression": { "type": "group",
        "expressions": [
          { "type": "OneOf",
            "expressions": [
              <span class="eitherOr   lowlight2 top">                                                                  </span>
              <span class="name       lowlight1 top">{ "type": "TripleConstraint", <span class="predicate">"predicate": "foaf:name"</span>,        </span>
              <span class="name       lowlight1 bot">  <span class="value-constraint">"value": { "type": "NodeConstraint", "datatype": "xsd:string" }</span>,
                "semActs": [
                  { "type": "SemAct", "name": "test:", "code": " print(o) " }
                ] }</span>,
              <span class="eitherOr   lowlight2 bot">                                                                  </span>
              <span class="eitherOr   lowlight2 top">                                                                  </span>
              { "type": "group",
                "expressions": [
                  <span class="gname      lowlight1 top">{ "type": "TripleConstraint", <span class="predicate">"predicate": "foaf:givenName"</span>,  </span>
                  <span class="gname      lowlight1    ">  <span class="value-constraint">"value": { "type": "NodeConstraint", "datatype": "xsd:string" }</span>,</span>
                  <span class="gname      lowlight1 bot">  "min": 1, "max": "*" },                                     </span>
                  <span class="fname      lowlight1 top">{ "type": "TripleConstraint", <span class="predicate">"predicate": "foaf:familyName"</span>,  </span>
                  <span class="fname      lowlight1 bot">  <span class="value-constraint">"value": { "type": "NodeConstraint", "datatype": "xsd:string" }</span>,
                    "semActs": [ { "type": "SemAct", "name": "test:",
                        "code": " fail(\"doomed\") "
                      }
                    ] }</span>
                ]
              }
              <span class="eitherOr   lowlight2 bot">                                                                  </span>
            ]
          },
          <span class="mbox       lowlight1 top">{ "type": "TripleConstraint", <span class="predicate">"predicate": "foaf:mbox"</span>, </span>
          <span class="mbox       lowlight1 bot">  <span class="value-constraint">"value": { "type": "NodeConstraint", "nodeKind": "iri" }</span> }</span>
        ]
      }
    }
  }
}</pre>
          <div class="verticalDivider"><!-- acts as a divider --></div>
          <div style="float:left;">
          <pre class="instance turtle"><span class="comment"># passing data</span>
<span class="keyword">PREFIX</span> <span class="type">ex:</span> <span class="function-name">http://ex.example/#</span><span class="comment">
</span><span class="keyword">PREFIX</span> <span class="type">foaf:</span> <span class="function-name">http://xmlns.com/foaf/</span>
<span class="keyword">PREFIX</span> <span class="type">xsd:</span> <span class="function-name">http://www.w3.org/2001/XMLSchema#</span><span class="comment">
</span>
<span class="function-name">inst:Issue1</span> <span class="keyword">a</span> <span class="type">ex:</span><span class="constant">Issue</span> ;
    <span class="state lowlight1 top bot"><span class="type">ex:</span><span class="constant">state</span>        <span class="stateValue lowlight2 top bot"><span class="type">ex:</span><span class="constant">unassigned</span></span></span> ;
    <span class="reportedBy lowlight1 top bot"><span class="type">ex:</span><span class="constant">reportedBy</span>   <span class="user lowlight2 top bot"><span class="function-name">inst:User2</span></span></span> .

<span class="user lowlight2 top bot"><span class="function-name">inst:User2</span></span> <span class="keyword">a</span> <span class="type">foaf:</span><span class="constant">Person</span> ;
    <span class="name lowlight1 top bot"><span class="type">foaf:</span><span class="constant">name</span>       <span class="string top bot">"Bob Smith"</span></span> ;
    <span class="mbox lowlight1 top"><span class="oneOrMore lowlight2 top"><span class="type">foaf:</span><span class="constant">mbox</span></span>       <span class="IRI lowlight2 top"><span class="fullURL">&lt;mailto:bob@example.org&gt;</span><span class="keyword"></span></span></span> ;
    <span class="mbox lowlight1 bot"><span class="oneOrMore lowlight2 bot"><span class="type">foaf:</span><span class="constant">mbox</span></span>       <span class="IRI lowlight2 bot"><span class="fullURL">&lt;mailto:rs@example.org&gt;</span> <span class="keyword"></span></span></span>.</pre>
          <pre class="instance turtle fail"><span class="comment"># failing data</span>
<span class="keyword">PREFIX</span> <span class="type">ex:</span> <span class="function-name">http://ex.example/#</span><span class="comment">
</span><span class="keyword">PREFIX</span> <span class="type">foaf:</span> <span class="function-name">http://xmlns.com/foaf/</span>
<span class="keyword">PREFIX</span> <span class="type">xsd:</span> <span class="function-name">http://www.w3.org/2001/XMLSchema#</span><span class="comment">
</span>
<span class="function-name">inst:Issue3</span> <span class="keyword">a</span> <span class="type">ex:</span><span class="constant">Issue</span> ;
    <span class="state lowlight1 top bot"><span class="type">ex:</span><span class="constant">state</span>        <span class="stateValue lowlight2 top bot"><span class="type">ex:</span><span class="constant errorSite">unsinged</span></span></span> ;
    <span class="reportedBy lowlight1 top bot"><span class="type">ex:</span><span class="constant">reportedBy</span>   <span class="user lowlight2 top bot"><span class="function-name">inst:User4</span></span></span> .

<span class="user lowlight2 top bot"><span class="function-name">inst:User4</span></span> <span class="keyword">a</span> <span class="type">foaf:</span><span class="constant">Person</span> ;
    <span class="name lowlight1 top bot"><span class="type">foaf:</span><span class="constant">name</span>       <span class="string top bot">"Bob Smith"</span>, <span class="string top bot errorSite">"Robert Smith"</span></span> ;
    <span class="mbox lowlight1 top"><span class="oneOrMore lowlight2 top"><span class="type">foaf:</span><span class="constant">mbox</span></span>       <span class="IRI lowlight2 top"><span class="fullURL">&lt;mailto:bob@example.org&gt;</span><span class="keyword"></span></span></span> ;
    <span class="mbox lowlight1 bot"><span class="oneOrMore lowlight2 bot"><span class="type">foaf:</span><span class="constant">mbox</span></span>       <span class="IRI lowlight2 bot"><span class="fullURL">&lt;mailto:rs@example.org&gt;</span> <span class="keyword"></span></span></span>.</pre>
  </div>
          <div style="clear:both;"></div>
      </div>
      <script type="text/javascript">
      <!--
prepareHighlight(["oneOrMore", "IRI", "stateValue", "user", "string"], "highlight2", "lowlight2");
prepareHighlight(["state", "reportedBy", "name", "mbox"], "highlight1", "lowlight1");
      -->
      </script>
    </section>

      <section id="rel-to-shacl">
        <h2>Relationship to SHACL</h2>
        <p>
          It is current unclear to what extend ShEx can be represented in SHACL.
          Some of the obvious differences are captured as issues:
        </p>
        <ul>
          <li><a href="https://www.w3.org/2014/data-shapes/track/issues/92">Should repeated properties be interpreted as additive or conjunctive?</a></li>
          <li><a href="https://www.w3.org/2014/data-shapes/track/issues/22">Treatment of recursive shape definitions</a> - closed without a definition of recursion or stratification.</li>
          <li><a href="https://www.w3.org/2014/data-shapes/track/issues/52">Define an Abstract Syntax for SHACL</a> - in progress.</li>
          <li><a href="https://www.w3.org/2014/data-shapes/track/issues/57">Cardinalities on expressions or groups of triple constraints</a> - closed without a way to express e.g. optional groups.</li>
          <li><a href="https://www.w3.org/2014/data-shapes/track/issues/80">Constraint to limit IRIs against scheme/namespace, possibly with dereferencing</a> - this issue was closed but lexical restrictions like PATTERN and stems capture some of this.</li>
        </ul>
      </section>

      <section id="examples">
        <h2>Additional Examples</h2>
        <section id="xsd:length">
          <h3>xsd:length</h3>
        <div class="namespace">
        <p>
          Constrain the length of a foaf:name to be <span class="min lowlight2 top bot">&gt;= 3</span> and <span class="max lowlight2 top bot">&lt;= 255</span>:
        </p>

        <div class="example wrapper">
          <!-- ShExC example -->
          <pre class="schema shexc" style="float:left;"><span class="comment"># schema (ShExC)</span>
<span class="shape-name">my:UserShape</span> {
  <span class="predicate">foaf:name</span> <span class="value-constraint">xsd:string
        <span class="min lowlight2 top bot new">MinLength 3</span>
        <span class="max lowlight2 top bot new">MaxLength 255</span></span>
}</pre>

          <!-- JSON example -->
          <pre class="schema json" style="float:left;"><span class="comment">// schema (JSON)</span>
{ <span class="shape-name">"my:UserShape"</span>: { "type": "Shape",
  "expression": {
    "type": "TripleConstraint", <span class="predicate">"predicate": "foaf:name"</span>,
    <span class="value-constraint">"value": {
      "type": "NodeConstraint", "datatype": "xsd:string",
      <span class="min lowlight2 top bot new">"minlength": 3</span>, <span class="max lowlight2 top bot new">"maxlength": 255</span> }</span> } } }</pre>
          <div class="verticalDivider"><!-- acts as a divider --></div>
          <div style="float:left;">
          <pre class="instance turtle"><span class="comment"># passing data</span>
<span class="name lowlight1 top bot"><span class="user lowlight2 top bot"><span class="function-name">inst:User2</span></span> <span class="type">foaf:</span><span class="constant">name</span>       <span class="string top bot">"Bob Smith"</span></span> .</pre>
          <pre class="instance turtle fail" style="float:left;"><span class="comment"># failing data</span>
<span class="name lowlight1 top bot"><span class="user lowlight2 top bot"><span class="function-name">inst:User9</span></span> <span class="type">foaf:</span><span class="constant">name</span>       <span class="min lowlight2 top bot"><span class="string top bot errorSite">"BS"</span></span></span>.</pre>
  </div>
          <div style="clear:both;"></div>
      </div>
      <script type="text/javascript">
      <!--
prepareHighlight(['min', 'max'], "highlight2", "lowlight2");
prepareHighlight(['name999'], "highlight1", "lowlight1");
      -->
      </script>

      </div>
      </section>
    </section>

		<section id="security" class="appendix informative">
			<h2>Security and Privacy Considerations</h2>
      <p>
        RDF, like any general-purpose data language, can convey confidential information.
        Trust in the information in RDF should be commensurate to the trust in the origin data.
        Applying schema validation can somewhat reduce the need for defensive coding in applications consuming untrusted data but it is still important to consider what forms of data a malicious attacker my produce and how an application will respond to that data.
      </p>
		</section>

      <section id="namespaces" class="appendix">
        <h2>Namespaces in this Document</h2>

          <p>
            The following namespace prefixes are frequently used in this document:
          </p>
          <table style="border-collapse: collapse; border-color: #000000" border="1" cellpadding="5">
            <tr>
              <th>Prefix</th>
              <th>Namespace</th>
            </tr>
            <!-- tr>
              <td>sh:</td>
              <td>http://www.w3.org/ns/shacl#</td>
            </tr -->
            <tr>
              <td>rdf:</td>
              <td>http://www.w3.org/1999/02/22-rdf-syntax-ns#</td>
            </tr>
            <tr>
              <td>xsd:</td>
              <td>http://www.w3.org/2001/XMLSchema#</td>
            </tr>
            <tr>
              <th colspan="2">Example namespaces</th>
              <th>Used in</th>
            </tr>
            <tr>
              <td>foaf:</td>
              <td>http://xmlns.com/foaf/0.1/</td>
              <td>Friend Of A Friend vocabulary</td>
            </tr>
            <tr>
              <td>ex:</td>
              <td>http://ex.example/ns#</td>
              <td>random application ontology</td>
            </tr>
            <tr>
              <td>my:</td>
              <td>http://my.example/ns#</td>
              <td>shape declarations</td>
            </tr>
            <tr>
              <td>inst:</td>
              <td>http://inst.example/ns#</td>
              <td>instance data</td>
            </tr>
            <tr>
              <td>test:</td>
              <td>http://shex.io/extensions/Test/</td>
              <td>Test language for semantic actions</td>
            </tr>
          </table>

        <p>
          This schemas in this Primer are available in <a href="https://github.com/shexSpec/grammar/blob/master/ShExDoc.g4">Shape Expressions Compact Syntax (ShExC)</a> and <a href="http://www.w3.org/TR/json-ld/">JSON</a>.
        </p>
        <form id="langOptions" action="">View as: <input type="radio" name="presLang" value="shexc" checked="checked">ShExC (press 'c')</input> <input type="radio" name="presLang" value="json">JSON (press 'j')</input> .</form>
      </section>

      <p class="note">[for editors] current switches:<br/>
      (<code>j</code>)son vs. shex(<code>c</code>).
      </p>

        <script type="application/javascript">
  var bodyKeypressCallbacks = {};

  /* a form like
        <form id="langOptions" action="">View as: <input type="radio" name="presLang" value="turtle" checked="checked">ShExC (press 'c')</input> <input type="radio" name="presLang" value="json">JSON (press 'j')</input> .</form>
  controls display of sections like 
  <pre class="schema shexc">...</pre>
  <pre class="schema json">...</pre>
   */
  [
    { lookIn: ".schema", form: "#langOptions", radioName: "presLang", keys:
      { 74: "json", 106: "json", 67: "shexc", 99: "shexc" }
    }
  ].forEach(function (x) {

    /* In lookIn, reveal classes selected by radioName; hide others.
     */
    function revealClass (lookIn, form, radioName) {
            $(lookIn+"."+$(form+" input[name="+radioName+"]").not(":checked").val()).hide();
            $(lookIn+"."+$(form+" input[name="+radioName+"]" +    ":checked").val()).show();
          }
    /* Look in all lookIn containers for the height different of from and to targets.
     */
          function adjustHeight (lookIn, from, to) {
            var visibleTop = $(window).scrollTop();
            var all = $(lookIn+"."+from); // all containers of from (and presumably, to)
            var adj = 0;
            for (var i = 0; i < all.length; ++i) {
              var elt = all.slice(i, i+1);
              if (elt.offset().top >= visibleTop) // stop when we pass the current scroll top.
    break;
              adj += elt.siblings("."+to).height() - elt.height();
            }
            $(window).scrollTop($(window).scrollTop() + adj); // move the scroll top.
          }

          var inputs = $(x.form + " input[name="+x.radioName+"]");
    // Listen for checkbox changes.
          inputs.change(function() {revealClass(x.lookIn, x.form, x.radioName);})
    // Show only the currently selected class.
          revealClass(x.lookIn, x.form, x.radioName);
    // Assign callbacks the the associated keycodes.
    Object.keys(x.keys).forEach(function (k) {
      bodyKeypressCallbacks[k] = function () {
        // If the corresponding radio button isn't already selected,
              if(!inputs.filter("[value="+x.keys[k]+"]").is(":checked")) {
    // adjust the height from the current class to the new class;
    adjustHeight(x.lookIn, $("input[name="+x.radioName+"]:checked", x.form).val(), ""+x.keys[k]+"");
    // set it as "checked";
    inputs.filter("[value="+x.keys[k]+"]").prop("checked", true); // .change() did nothing
    // swap which is displayed.
    revealClass(x.lookIn, x.form, x.radioName);
              }
        return false;
      };
    });
  });
        $("html > body").keypress(function (evt) {
          if (evt.ctrlKey)
            return true; // don't interfere with browser control keys.
    if (evt.which in bodyKeypressCallbacks)
      return bodyKeypressCallbacks[evt.which]();
    return true;
        });
        </script>
    </body>
</html>
